<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Incremental Trade ULTIMATE</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background: #0a0a0a;
      color: #eee;
      padding: 1rem;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
    }

    h1 {
      color: #0af;
      text-align: center;
      margin: 1rem 0;
      font-size: 2.2rem;
    }

    h3, h4 {
      color: #0af;
      margin: 0.5rem 0;
    }

    p {
      text-align: center;
      color: #aaa;
      margin-bottom: 1rem;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }

    .stat {
      background: #1a1a1a;
      padding: 1rem;
      border-radius: 6px;
      border: 1px solid #0af;
      text-align: center;
    }

    .stat-val {
      font-size: 1.4rem;
      color: #0f0;
      font-weight: bold;
    }

    .tabs {
      display: flex;
      gap: 0.3rem;
      margin: 1rem 0;
      flex-wrap: wrap;
      background: #111;
      padding: 0.5rem;
      border-radius: 6px;
    }

    .tab-btn {
      padding: 0.6rem 1rem;
      background: #222;
      color: #aaa;
      border: 1px solid #333;
      cursor: pointer;
      border-radius: 4px;
      transition: 0.3s;
    }

    .tab-btn:hover {
      background: #333;
    }

    .tab-btn.active {
      background: #0af;
      color: #000;
      border-color: #0af;
    }

    .content {
      display: none;
    }

    .content.active {
      display: block;
    }

    .card {
      background: #1a1a1a;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 6px;
      border: 1px solid #333;
    }

    .btn {
      padding: 0.6rem 1rem;
      background: #0af;
      color: #000;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
      margin: 0.3rem 0.3rem 0.3rem 0;
      transition: 0.2s;
    }

    .btn:hover:not(:disabled) {
      transform: scale(1.05);
    }

    .btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .danger-btn {
      background: #f00;
      color: #fff;
    }

    .danger-btn:hover:not(:disabled) {
      background: #c00;
    }

    .item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.6rem;
      background: #0a0a0a;
      margin: 0.4rem 0;
      border-left: 3px solid #0af;
    }

    .big-btn {
      width: 100%;
      max-width: 280px;
      padding: 1.2rem;
      font-size: 1.1rem;
      margin: 1rem auto;
      display: block;
    }

    .log {
      background: #000;
      border-left: 3px solid #0af;
      padding: 0.8rem;
      max-height: 120px;
      overflow-y: auto;
      margin: 1rem 0;
      font-size: 0.85rem;
    }

    canvas {
      border: 1px solid #0af;
      background: #111;
      max-width: 100%;
      margin: 1rem 0;
    }

    .trade-card {
      background: #1a1a2a;
      border: 2px solid #0af;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 6px;
    }

    .trade-card.min {
      border-color: #0f0;
    }

    .trade-card.mid {
      border-color: #fa0;
    }

    .trade-card.high {
      border-color: #f00;
    }

    .trade-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .trade-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 0.5rem;
      margin: 0.5rem 0;
    }

    .trade-stat {
      background: #0a0a1a;
      padding: 0.5rem;
      border-radius: 4px;
      font-size: 0.9rem;
      border-left: 2px solid #0af;
    }

    .trade-stat-val {
      font-weight: bold;
      color: #0f0;
      font-size: 1.1rem;
    }

    .trade-input-group {
      display: flex;
      gap: 0.5rem;
      margin: 0.5rem 0;
      flex-wrap: wrap;
    }

    .trade-input {
      flex: 1;
      min-width: 100px;
      padding: 0.5rem;
      background: #0a0a0a;
      border: 1px solid #333;
      color: #0f0;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .trade-log-event {
      padding: 0.5rem;
      margin: 0.3rem 0;
      background: #000;
      border-left: 2px solid #0af;
      font-size: 0.85rem;
    }

    .trade-log-event.gain {
      border-left-color: #0f0;
      color: #0f0;
    }

    .trade-log-event.loss {
      border-left-color: #f00;
      color: #f00;
    }

    #tutorialModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.98);
      z-index: 9999;
      padding: 1rem;
      overflow-y: auto;
      display: none;
    }

    .tut-box {
      max-width: 700px;
      margin: 0 auto;
      background: #1a1a1a;
      padding: 1.5rem;
      border: 2px solid #0af;
      border-radius: 6px;
    }

    .tut-box h1 {
      margin-top: 0;
    }

    .tut-btns {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      margin: 1.5rem 0;
    }

    @media(max-width: 600px) {
      .tabs {
        font-size: 0.9rem;
      }

      .stat {
        padding: 0.6rem;
      }

      .btn {
        padding: 0.4rem 0.8rem;
        font-size: 0.85rem;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <h1>ğŸ’ INCREMENTAL TRADE ULTIMATE ğŸ’</h1>
  <p>Le jeu inactif addictif!</p>
  <div style="display: flex; gap: 1rem; justify-content: center; margin-bottom: 1rem; flex-wrap: wrap;">
    <button class="btn" onclick="showTutorial()" style="display:block">ğŸ“– TUTORIEL</button>
    <div class="log" id="log" style="flex: 1; min-width: 200px; max-width: 400px; margin: 0;"></div>
  </div>

  <!-- STATS AFFICHAGE -->
  <div class="stats">
    <div class="stat">
      <div>ğŸ’° PiÃ¨ces</div>
      <div class="stat-val" id="coins">0</div>
    </div>
    <div class="stat">
      <div>âš¡ /sec</div>
      <div class="stat-val" id="cps">0</div>
    </div>
    <div class="stat">
      <div>â­ Ã‰toiles</div>
      <div class="stat-val" id="stars">0</div>
    </div>
    <div class="stat">
      <div>ğŸŒ€ Galaxies</div>
      <div class="stat-val" id="galaxies">0</div>
    </div>
    <div class="stat">
      <div>ğŸŒ™ Dark Matter</div>
      <div class="stat-val" id="dm">0</div>
    </div>
    <div class="stat">
      <div>ğŸ’¸ Trade BloquÃ©</div>
      <div class="stat-val" id="tradeBlocked">0</div>
    </div>
    <div class="stat">
      <div>ğŸš€ Ascension</div>
      <div class="stat-val" id="ascension">0</div>
    </div>
    <div class="stat">
      <div>ğŸ† Achievements</div>
      <div class="stat-val" id="achievementCount">0</div>
    </div>
    <div class="stat">
      <div>ğŸ¦ Banque</div>
      <div class="stat-val" id="bankAmount">0</div>
    </div>
  </div>

  <!-- TABS NAVIGATION -->
  <div class="tabs">
    <button class="tab-btn active" data-tab="main">ğŸ® JEU</button>
    <button class="tab-btn" data-tab="gens">ğŸ¤– GÃ‰NÃ‰RATEURS</button>
    <button class="tab-btn" data-tab="ups">âš¡ UPGRADES</button>
    <button class="tab-btn" data-tab="trade">ğŸ’¸ TRADING</button>
    <button class="tab-btn" data-tab="bank">ğŸ¦ BANQUE</button>
    <button class="tab-btn" data-tab="lottery">ğŸ° LOTTERIE</button>
    <button class="tab-btn" data-tab="ascensionTab">ğŸš€ ASCENSION</button>
    <button class="tab-btn" data-tab="achievements">ğŸ† ACHIEVEMENTS</button>
    <button class="tab-btn" data-tab="feat">âœ¨ FEATURES</button>
    <button class="tab-btn" data-tab="stats">ğŸ“Š STATS</button>
    <button class="tab-btn" data-tab="params">âš™ï¸ PARAMÃˆTRES</button>
  </div>

  <!-- TAB: MAIN GAME -->
  <div id="main" class="content active">
    <div class="card" style="text-align:center">
      <button class="btn big-btn" id="clickBtn">ğŸ–±ï¸ CLIQUER</button>
      <p>Gain: <span id="clickVal">0</span> par clic</p>
    </div>

    <div class="card">
      <h3>â±ï¸ PRESTIGE</h3>
      <p>CoÃ»t: <span id="prestigeCost">50000</span> ğŸ’°</p>
      <p>Progression: <span id="prestProg">0</span></p>
      <p style="color: #0f0; font-size: 1.1rem;"><strong>Possible: <span id="prestigeCount">0</span>Ã—</strong></p>
      <button class="btn" id="prestigeBtn">âš¡ PRESTIGE (+10% par prestige)</button>
    </div>

    <div class="card">
      <h3>ğŸŒ€ GALAXIES</h3>
      <p>CoÃ»t: <span id="galaxyCost">500</span> â­</p>
      <button class="btn" id="galaxyBtn">ğŸŒ€ SUPER PRESTIGE (Ã—1.6)</button>
    </div>
  </div>

  <!-- TAB: GENERATORS -->
  <div id="gens" class="content">
    <div class="card">
      <h3>ğŸ¤– GÃ‰NÃ‰RATEURS AUTOMATIQUES</h3>
      <div id="gensList"></div>
    </div>
  </div>

  <!-- TAB: UPGRADES -->
  <div id="ups" class="content">
    <div class="card">
      <h3>âš¡ AMÃ‰LIORATIONS</h3>
      <div id="upsList"></div>
    </div>
  </div>

  <!-- TAB: TRADING -->
  <div id="trade" class="content">
    <div class="card">
      <h3>ğŸ’¸ SYSTÃˆME DE TRADING</h3>
      <p style="color: #aaa; margin-bottom: 1rem;">Plus tu dÃ©poses, plus tu gagnes/perds! L'argent est BLOQUÃ‰ jusqu'au retrait.</p>

      <!-- RISQUE MINIMUM -->
      <div class="trade-card min">
        <div class="trade-header">
          <div>
            <h4>âœ… RISQUE MINIMUM</h4>
            <p style="color: #0f0; font-size: 0.9rem;">+3% par seconde | -2% risque (0.5% chance)</p>
          </div>
        </div>
        
        <div class="trade-stats">
          <div class="trade-stat">
            <div>ğŸ’° Investi</div>
            <div class="trade-stat-val" id="minAmount">0</div>
          </div>
          <div class="trade-stat">
            <div>âš¡ +/sec</div>
            <div class="trade-stat-val" id="minGain">0</div>
          </div>
          <div class="trade-stat">
            <div>ğŸ“‰ Risque</div>
            <div class="trade-stat-val" id="minLoss">0</div>
          </div>
        </div>

        <div class="trade-input-group">
          <input type="number" class="trade-input" id="minInput" placeholder="Montant Ã  dÃ©poser" min="0">
          <button class="btn" onclick="investTrade('min')">ğŸ“¤ DÃ‰POSER</button>
          <button class="btn danger-btn" onclick="withdrawTrade('min')">ğŸ“¥ RETIRER</button>
        </div>
      </div>

      <!-- RISQUE MOYEN -->
      <div class="trade-card mid">
        <div class="trade-header">
          <div>
            <h4>âš ï¸ RISQUE MOYEN</h4>
            <p style="color: #fa0; font-size: 0.9rem;">+10% par seconde | -5% risque (3% chance)</p>
          </div>
        </div>
        
        <div class="trade-stats">
          <div class="trade-stat">
            <div>ğŸ’° Investi</div>
            <div class="trade-stat-val" id="midAmount">0</div>
          </div>
          <div class="trade-stat">
            <div>âš¡ +/sec</div>
            <div class="trade-stat-val" id="midGain">0</div>
          </div>
          <div class="trade-stat">
            <div>ğŸ“‰ Risque</div>
            <div class="trade-stat-val" id="midLoss">0</div>
          </div>
        </div>

        <div class="trade-input-group">
          <input type="number" class="trade-input" id="midInput" placeholder="Montant Ã  dÃ©poser" min="0">
          <button class="btn" onclick="investTrade('mid')">ğŸ“¤ DÃ‰POSER</button>
          <button class="btn danger-btn" onclick="withdrawTrade('mid')">ğŸ“¥ RETIRER</button>
        </div>
      </div>

      <!-- GROS RISQUE -->
      <div class="trade-card high">
        <div class="trade-header">
          <div>
            <h4>ğŸ”¥ GROS RISQUE</h4>
            <p style="color: #f00; font-size: 0.9rem;">+30% par seconde | -15% risque (8% chance) | TOUT PERDRE (0.1% chance)</p>
          </div>
        </div>
        
        <div class="trade-stats">
          <div class="trade-stat">
            <div>ğŸ’° Investi</div>
            <div class="trade-stat-val" id="highAmount">0</div>
          </div>
          <div class="trade-stat">
            <div>âš¡ +/sec</div>
            <div class="trade-stat-val" id="highGain">0</div>
          </div>
          <div class="trade-stat">
            <div>ğŸ“‰ Risque</div>
            <div class="trade-stat-val" id="highLoss">0</div>
          </div>
        </div>

        <div class="trade-input-group">
          <input type="number" class="trade-input" id="highInput" placeholder="Montant Ã  dÃ©poser" min="0">
          <button class="btn" onclick="investTrade('high')">ğŸ“¤ DÃ‰POSER</button>
          <button class="btn danger-btn" onclick="withdrawTrade('high')">ğŸ“¥ RETIRER</button>
        </div>
      </div>

      <!-- TRADE LOG -->
      <div class="card">
        <h4>ğŸ“Š LOG TRADING</h4>
        <div id="tradeLog" style="max-height: 200px; overflow-y: auto;">
          <div class="trade-log-event">En attente...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- TAB: BANQUE -->
  <div id="bank" class="content">
    <div class="card">
      <h3>ğŸ¦ BANQUE - INVESTISSEMENTS</h3>
      <p style="color: #0f0; margin-bottom: 1rem;">DÃ©pose des piÃ¨ces pour +0.1% par sec!</p>
      
      <div class="trade-stats">
        <div class="trade-stat">
          <div>ğŸ’° Investi</div>
          <div class="trade-stat-val" id="bankInvested">0</div>
        </div>
        <div class="trade-stat">
          <div>âš¡ +/sec</div>
          <div class="trade-stat-val" id="bankGains">0</div>
        </div>
      </div>

      <div class="trade-input-group">
        <input type="number" class="trade-input" id="bankInput" placeholder="Montant Ã  dÃ©poser" min="0">
        <button class="btn" onclick="depositBank()">ğŸ“¤ DÃ‰POSER</button>
        <button class="btn danger-btn" onclick="withdrawBank()">ğŸ“¥ RETIRER</button>
      </div>

      <div class="card" style="background:#0a0a0a;margin-top:1rem">
        <h4>ğŸ“Š Info Banque</h4>
        <p style="color:#aaa;font-size:0.9rem">
          Total gÃ©nÃ©rÃ©: <span id="bankGenerated">0</span> ğŸ’°
        </p>
      </div>
    </div>
  </div>

  <!-- TAB: LOTTERIE -->
  <div id="lottery" class="content">
    <div class="card">
      <h3>ğŸ° LOTTERIE - TENTEZ VOTRE CHANCE!</h3>
      <p style="color: #aaa; margin-bottom: 1rem;">Achetez des tickets et tentez votre chance!</p>
      
      <div class="trade-stats">
        <div class="trade-stat">
          <div>ğŸŸï¸ Tickets</div>
          <div class="trade-stat-val" id="lotteryTickets">0</div>
        </div>
        <div class="trade-stat">
          <div>ğŸ’° CoÃ»t</div>
          <div class="trade-stat-val">100</div>
        </div>
      </div>

      <div class="trade-input-group">
        <button class="btn" onclick="buyLotteryTicket(1)">ğŸŸï¸ 1 Ticket (100)</button>
        <button class="btn" onclick="buyLotteryTicket(10)">ğŸŸï¸ 10 Tickets (1K)</button>
        <button class="btn" onclick="buyLotteryTicket(100)">ğŸŸï¸ 100 Tickets (10K)</button>
      </div>

      <div style="margin-top: 1rem;">
        <button class="btn big-btn" onclick="playLottery()" style="max-width: 100%; width: 100%;">ğŸ° JOUER!</button>
      </div>

      <div class="card" style="background:#0a0a0a;margin-top:1rem">
        <h4>ğŸ² RÃ©sultats</h4>
        <div id="lotteryLog" style="max-height: 200px; overflow-y: auto;">
          <div style="color:#aaa;font-size:0.9rem">En attente...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- TAB: ASCENSION -->
  <div id="ascensionTab" class="content">
    <div class="card">
      <h3>ğŸš€ ASCENSION - META PRESTIGE</h3>
      <p style="color: #fa0; margin-bottom: 1rem;">RÃ©initialise TOUT mais donne des bonus permanents Ã©normes!</p>
      
      <div class="trade-stats">
        <div class="trade-stat">
          <div>ğŸš€ Points</div>
          <div class="trade-stat-val" id="ascensionPoints">0</div>
        </div>
        <div class="trade-stat">
          <div>âš¡ Bonus</div>
          <div class="trade-stat-val">+<span id="ascensionBonus">0</span>%</div>
        </div>
        <div class="trade-stat">
          <div>ğŸŒ€ CoÃ»t</div>
          <div class="trade-stat-val" id="ascensionCost">100</div>
        </div>
      </div>

      <div style="background:#0a0a1a;padding:1rem;margin:1rem 0;border-left:3px solid #fa0;border-radius:4px;">
        <p style="color:#fa0;margin:0.5rem 0"><strong>âš ï¸ ATTENTION!</strong></p>
        <p style="color:#aaa;font-size:0.9rem;margin:0.5rem 0">L'Ascension va:</p>
        <p style="color:#aaa;font-size:0.9rem;margin:0.5rem 0">âŒ RÃ©initialiser TOUS les gÃ©nÃ©rateurs</p>
        <p style="color:#aaa;font-size:0.9rem;margin:0.5rem 0">âŒ RÃ©initialiser TOUS les upgrades</p>
        <p style="color:#aaa;font-size:0.9rem;margin:0.5rem 0">âŒ RÃ©initialiser les Ã©toiles et prestige</p>
        <p style="color:#aaa;font-size:0.9rem;margin:0.5rem 0">âœ… Garder les Galaxies</p>
        <p style="color:#aaa;font-size:0.9rem;margin:0.5rem 0">âœ… Garder les points d'Ascension</p>
      </div>

      <button class="btn big-btn danger-btn" onclick="doAscension()" style="max-width: 100%; width: 100%;">ğŸš€ ASCENSIONNER!</button>

      <div class="card" style="background:#0a0a0a;margin-top:1rem">
        <h4>ğŸ“Š Info Ascension</h4>
        <p style="color:#aaa;font-size:0.9rem">
          Galaxies nÃ©cessaires: <span id="ascensionRequired">100</span><br>
          Galaxies actuelles: <span id="ascensionCurrent">0</span>
        </p>
      </div>
    </div>
  </div>

  <!-- TAB: ACHIEVEMENTS -->
  <div id="achievements" class="content">
    <div class="card">
      <h3>ğŸ† ACHIEVEMENTS & BADGES</h3>
      <p style="color: #0f0; margin-bottom: 1rem;">DÃ©bloque des badges et gagne des rÃ©compenses!</p>
      
      <div id="achievementsList" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <!-- Les achievements s'affichent ici -->
      </div>
    </div>
  </div>

  <!-- TAB: FEATURES -->
  <div id="feat" class="content">
    <div class="card">
      <h3>ğŸŒ™ DARK MATTER</h3>
      <div class="item">
        <div>
          <strong>Dark Matter: <span id="dmCount">0</span></strong><br>
          <span style="color:#aaa;font-size:0.9rem">+5% Ã  TOUS les gains par Dark Matter</span>
        </div>
      </div>
      <div id="dmInfo" style="color:#aaa;font-size:0.9rem;margin-top:0.5rem"></div>
    </div>

    <div class="card">
      <h3>ğŸ¯ QUÃŠTES</h3>
      <div id="questsList"></div>
    </div>

    <div class="card">
      <h3>â° BOOSTS</h3>
      <button class="btn" id="boostProd">Prod Ã—2 (50K)</button>
      <button class="btn" id="boostClick">Click Ã—2 (30K)</button>
      <div id="activeBoosts" style="margin-top:0.5rem"></div>
    </div>

    <div class="card">
      <h3>âš™ï¸ SYNERGIES</h3>
      <div id="synergies"></div>
    </div>

    <div class="card">
      <h3>ğŸ“Š GRAPHIQUE</h3>
      <canvas id="graph" width="600" height="200"></canvas>
    </div>
  </div>

  <!-- TAB: STATS -->
  <div id="stats" class="content">
    <div class="card">
      <h3>ğŸ“ˆ STATISTIQUES</h3>
      <div class="item">
        <span>Total PiÃ¨ces</span>
        <span id="totalCoins">0</span>
      </div>
      <div class="item">
        <span>Total Clics</span>
        <span id="totalClicks">0</span>
      </div>
      <div class="item">
        <span>Temps Jeu</span>
        <span id="playTime">0s</span>
      </div>
      <div class="item">
        <span>Prestige</span>
        <span id="presCount">0</span>
      </div>
    </div>
  </div>

  <!-- TAB: PARAMETRES -->
  <div id="params" class="content">
    <div class="card">
      <h3>âš™ï¸ PARAMÃˆTRES</h3>
      <p style="color:#aaa;margin-bottom:1rem">GÃ¨re ta partie ici</p>

      <div class="item" style="border-left:3px solid #0f0;padding:1rem">
        <div>
          <strong>ğŸ’¾ Sauvegarder</strong><br>
          <span style="color:#aaa;font-size:0.9rem">TÃ©lÃ©charge une copie de ta progression</span>
        </div>
        <button class="btn" id="downloadBtn">ğŸ“¥ TÃ‰LÃ‰CHARGER</button>
      </div>

      <div class="item" style="border-left:3px solid #0af;padding:1rem">
        <div>
          <strong>ğŸ“‚ Charger</strong><br>
          <span style="color:#aaa;font-size:0.9rem">Importe une sauvegarde</span>
        </div>
        <button class="btn" id="uploadBtn">ğŸ“¤ IMPORTER</button>
      </div>

      <div class="item" style="border-left:3px solid #fa0;padding:1rem">
        <div>
          <strong>ğŸ—‘ï¸ RÃ©initialiser</strong><br>
          <span style="color:#aaa;font-size:0.9rem">Recommence Ã  zÃ©ro (attention!)</span>
        </div>
        <button class="btn danger-btn" id="resetBtn">ğŸ”„ RESET</button>
      </div>

      <div class="card" style="background:#0a0a0a;margin-top:1rem">
        <h4>ğŸ“ Info Sauvegarde</h4>
        <p style="text-align:left;color:#aaa;font-size:0.9rem">
          <strong>DerniÃ¨re sauvegarde:</strong> <span id="lastSave">Jamais</span><br>
          <strong>Taille:</strong> <span id="saveSize">0 KB</span>
        </p>
      </div>
    </div>
  </div>
</div>

<!-- FILE INPUT HIDDEN -->
<input type="file" id="fileInput" style="display:none" accept=".json">

<!-- TUTORIAL MODAL -->
<div id="tutorialModal">
  <div class="tut-box">
    <h1>ğŸ“– TUTORIEL COMPLET</h1>
    <div id="tutText" style="min-height:300px;line-height:1.8;margin:1rem 0"></div>
    <div class="tut-btns">
      <button class="btn" id="prevBtn">â† PRÃ‰CÃ‰DENT</button>
      <button class="btn" onclick="document.getElementById('tutorialModal').style.display='none'">FERMER</button>
      <button class="btn" id="nextBtn">SUIVANT â†’</button>
    </div>
    <p style="text-align:center;color:#aaa;font-size:0.85rem">Page <span id="tutPage">1</span>/16</p>
  </div>
</div>

<!-- ============================================================ -->
<!-- SCRIPT -->
<!-- ============================================================ -->

<script>
// =========== CONSTANTES ===========
const FPS = 10;
const SAVE_KEY = "incremental_v3";
let tutPage = 0;
let graphData = [];
let skipQuestCheck = false;

// =========== TUTORIEL 16 PAGES ===========
const TUTORIAL = [
  `<h2 style="color: #0af; font-size: 1.8rem; margin-bottom: 1rem;">ğŸ® INTRODUCTION - BIENVENUE!</h2>
    <p style="margin: 0.5rem 0; color: #aaa;">Le jeu inactif ULTIME avec TRADING, ASCENSION, et ACHIEVEMENTS!</p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0af; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;">âœ… Tu cliques pour gagner des piÃ¨ces</p>
      <p style="margin: 0.5rem 0;">âœ… Tu achÃ¨tes des gÃ©nÃ©rateurs (robots, usines, etc)</p>
      <p style="margin: 0.5rem 0;">âœ… Ils gagnent de l'argent AUTOMATIQUEMENT 24/7!</p>
      <p style="margin: 0.5rem 0;">âœ… Tu fais des prestige pour dÃ©bloquer du contenu</p>
      <p style="margin: 0.5rem 0;">âœ… C'est INFINI! Continue jusqu'Ã  l'infini! â™¾ï¸</p>
    </div>
    <p style="color: #fa0; margin-top: 1rem;"><strong>ğŸ’¡ Le but = avoir le plus de multiplicateurs possible!</strong></p>`,

  `<h2 style="color: #fa0; font-size: 1.8rem; margin-bottom: 1rem;">ğŸ–±ï¸ Ã‰TAPE 1: LE CLIC - TES PREMIERS GAINS</h2>
    <p style="margin: 0.5rem 0; color: #0f0;"><strong>Commence ici!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>EXEMPLE:</strong></p>
      <p style="margin: 0.5rem 0;">â€¢ Tu cliques 1 fois â†’ +1 piÃ¨ce (au dÃ©part)</p>
      <p style="margin: 0.5rem 0;">â€¢ Tu cliques 100 fois â†’ +100 piÃ¨ces</p>
      <p style="margin: 0.5rem 0;">â€¢ Avec des upgrades? +500 piÃ¨ces par clic!</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>ğŸ’¡ TIP IMPORTANT:</strong></p>
      <p style="margin: 0.5rem 0;">Ne clique que jusqu'Ã  avoir 50 piÃ¨ces!</p>
      <p style="margin: 0.5rem 0;">AprÃ¨s, c'est plus rentable d'acheter un gÃ©nÃ©rateur!</p>
    </div>`,

  `<h2 style="color: #0f0; font-size: 1.8rem; margin-bottom: 1rem;">ğŸ¤– Ã‰TAPE 2: LES GÃ‰NÃ‰RATEURS - L'ARGENT PASSIF</h2>
    <p style="margin: 0.5rem 0; color: #0f0;"><strong>L'Ã‚ME DU JEU!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0af; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>ğŸ¤– Robot</strong> â†’ 1 piÃ¨ce/sec | CoÃ»t: 50 | DÃ©bloquÃ©: direct</p>
      <p style="margin: 0.5rem 0;"><strong>ğŸ­ Usine</strong> â†’ 1.5 piÃ¨ces/sec | CoÃ»t: 500 | DÃ©bloquÃ©: Prestige 1</p>
      <p style="margin: 0.5rem 0;"><strong>â›´ï¸ Port</strong> â†’ 4 piÃ¨ces/sec | CoÃ»t: 5K | DÃ©bloquÃ©: 5 Ã©toiles</p>
      <p style="margin: 0.5rem 0;"><strong>ğŸ”¬ Labo</strong> â†’ 15 piÃ¨ces/sec | CoÃ»t: 50K | DÃ©bloquÃ©: Prestige 3</p>
      <p style="margin: 0.5rem 0;"><strong>ğŸ›°ï¸ Satellite</strong> â†’ 100 piÃ¨ces/sec | CoÃ»t: 500K | DÃ©bloquÃ©: 1 Galaxie</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0;"><strong>EXEMPLE CONCRET:</strong></p>
      <p style="margin: 0.5rem 0;">Tu achÃ¨tes 10 Robots (coÃ»t: 500 coins)</p>
      <p style="margin: 0.5rem 0;">â†’ Tu gagnes 10 piÃ¨ces/sec AUTOMATIQUEMENT</p>
      <p style="margin: 0.5rem 0;">â†’ En 1 minute = 600 piÃ¨ces sans rien faire!</p>
      <p style="margin: 0.5rem 0;">â†’ En 1 heure = 36,000 piÃ¨ces!! ğŸ’°</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>ğŸ’¡ TIPS:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… HOLD le bouton +1 pour acheter rapidement!</p>
      <p style="margin: 0.5rem 0;">âœ… Utilise le bouton MAX pour acheter le maximum!</p>
      <p style="margin: 0.5rem 0;">âœ… Les gÃ©nÃ©rateurs deviennent plus chers Ã  chaque achat!</p>
      <p style="margin: 0.5rem 0;">âœ… JAMAIS tu n'acheteras "trop" - achÃ¨te toujours au MAX!</p>
    </div>`,

  `<h2 style="color: #fa0; font-size: 1.8rem; margin-bottom: 1rem;">âš¡ Ã‰TAPE 3: LES UPGRADES - LES MULTIPLICATEURS</h2>
    <p style="margin: 0.5rem 0; color: #fa0;"><strong>Les turbos!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>Types d'upgrades:</strong></p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ <strong>Clic +50%</strong> â†’ +50% Ã  ton clic! (RÃ©pÃ©table!)</p>
      <p style="margin: 0.5rem 0;">ğŸ“ˆ <strong>Robot Ã—2, Robot Ã—3</strong> â†’ Les Robots produisent 2Ã— ou 3Ã— plus!</p>
      <p style="margin: 0.5rem 0;">ğŸ“ˆ <strong>Usine Ã—2, Port Ã—2, Labo Ã—2</strong> â†’ Idem pour chaque gÃ©nÃ©rateur</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>EXEMPLE:</strong></p>
      <p style="margin: 0.5rem 0;">Tu as 10 Robots (10 piÃ¨ces/sec)</p>
      <p style="margin: 0.5rem 0;">Tu achÃ¨tes l'upgrade "Robot Ã—2"</p>
      <p style="margin: 0.5rem 0;">â†’ Les 10 Robots deviennent 20 piÃ¨ces/sec! ğŸš€</p>
      <p style="margin: 0.5rem 0;">Tu achÃ¨tes "Robot Ã—2" ENCORE UNE FOIS</p>
      <p style="margin: 0.5rem 0;">â†’ Les 10 Robots deviennent 40 piÃ¨ces/sec!! ğŸ’¥</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #f00; border-radius: 4px; text-align: left;">
      <p style="color: #f00;"><strong>âš ï¸ ATTENTION:</strong></p>
      <p style="margin: 0.5rem 0;">Les upgrades deviennent TRÃˆS chers!</p>
      <p style="margin: 0.5rem 0;">Focus sur les GÃ‰NÃ‰RATEURS d'abord!</p>
      <p style="margin: 0.5rem 0;">Les upgrades sont bonus mais pas prioritaires!</p>
    </div>`,

  `<h2 style="color: #0af; font-size: 1.8rem; margin-bottom: 1rem;">â­ Ã‰TAPE 4: LE PRESTIGE - LA PREMIÃˆRE ASCENSION</h2>
    <p style="margin: 0.5rem 0; color: #0f0;"><strong>Change la donne!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0af; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>Qu'est-ce que c'est?</strong></p>
      <p style="margin: 0.5rem 0;">âœ… Quand tu as 50,000 piÃ¨ces, tu peux faire 1 PRESTIGE</p>
      <p style="margin: 0.5rem 0;">âœ… Ã‡a te donne 1 Ã©toile (â­)</p>
      <p style="margin: 0.5rem 0;">âœ… TOUT se rÃ©initialise (piÃ¨ces, gÃ©nÃ©rateurs, upgrades)</p>
      <p style="margin: 0.5rem 0;">âœ… MAIS les Galaxies restent! (plus tard)</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>EXEMPLE:</strong></p>
      <p style="margin: 0.5rem 0;">Prestige 1: 50,000 coins â†’ gagne 1 Ã©toile</p>
      <p style="margin: 0.5rem 0;">Prestige 2: 75,000 coins â†’ gagne 1 Ã©toile (coÃ»t augmente!)</p>
      <p style="margin: 0.5rem 0;">Prestige 3: 112,500 coins â†’ gagne 1 Ã©toile</p>
      <p style="margin: 0.5rem 0;">Ã€ chaque Ã©toile, tu gagnes Ã—1.03 multiplicateur!</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0;"><strong>ğŸ’¡ TIPS PRESTIGE:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… Les Ã©toiles donnent un multiplicateur PERMANENT!</p>
      <p style="margin: 0.5rem 0;">âœ… 10 Ã©toiles = Ã—1.34 (trÃ¨s puissant!)</p>
      <p style="margin: 0.5rem 0;">âœ… Le coÃ»t augmente de 50% Ã  chaque fois (1.5Ã—)</p>
      <p style="margin: 0.5rem 0;">âœ… Fais prestige RÃ‰GULIÃˆREMENT pour avancer plus vite!</p>
    </div>`,

  `<h2 style="color: #0f0; font-size: 1.8rem; margin-bottom: 1rem;">ğŸŒ€ Ã‰TAPE 5: LES GALAXIES - LE VRAI ENDGAME</h2>
    <p style="margin: 0.5rem 0; color: #0f0;"><strong>Ta VRAIE progression!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>Qu'est-ce que c'est?</strong></p>
      <p style="margin: 0.5rem 0;">âœ… Quand tu as 500 Ã©toiles (â­), tu peux acheter 1 Galaxie</p>
      <p style="margin: 0.5rem 0;">âœ… Ã‡a coÃ»te: 500â­, 550â­, 600â­, 650â­, etc...</p>
      <p style="margin: 0.5rem 0;">âœ… Chaque Galaxie = Ã—1.01 multiplicateur PERMANENT</p>
      <p style="margin: 0.5rem 0;">âœ… LES GALAXIES RESTENT MÃŠME AU PRESTIGE!</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>EXEMPLE:</strong></p>
      <p style="margin: 0.5rem 0;">Tu accumules 500 Ã©toiles (faut faire ~13 prestige)</p>
      <p style="margin: 0.5rem 0;">Tu achÃ¨tes la Galaxie 1 â†’ multiplicateur Ã—1.01</p>
      <p style="margin: 0.5rem 0;">Tu continues et accumules 550 Ã©toiles</p>
      <p style="margin: 0.5rem 0;">Tu achÃ¨tes la Galaxie 2 â†’ multiplicateur Ã—1.01</p>
      <p style="margin: 0.5rem 0;">AprÃ¨s 100 Galaxies? Tu as Ã—2.7 de multiplicateur!</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0;"><strong>ğŸ’¡ C'EST IMPORTANT:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… Les Galaxies = ta VRAIE progression!</p>
      <p style="margin: 0.5rem 0;">âœ… Elles s'accumulent pour TOUJOURS!</p>
      <p style="margin: 0.5rem 0;">âœ… C'est exponentiellement puissant Ã  long terme!</p>
      <p style="margin: 0.5rem 0;">âœ… C'est ce qui te rend OP avec le temps!</p>
    </div>`,

  `<h2 style="color: #fa0; font-size: 1.8rem; margin-bottom: 1rem;">ğŸ’¸ Ã‰TAPE 6: LE TRADING - GAINS PASSIFS RISQUÃ‰S</h2>
    <p style="margin: 0.5rem 0; color: #fa0;"><strong>Multiplie ton argent (ou le perds!)</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0af; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>3 niveaux de risque:</strong></p>
      <p style="margin: 0.5rem 0;"><span style="color: #0f0;">ğŸŸ¢ MINIMUM: +3%/sec</span> | -2% risque (0.5% chance) | SÃ›RE</p>
      <p style="margin: 0.5rem 0;"><span style="color: #fa0;">ğŸŸ¡ MOYEN: +10%/sec</span> | -5% risque (3% chance) | MODÃ‰RÃ‰</p>
      <p style="margin: 0.5rem 0;"><span style="color: #f00;">ğŸ”´ AGRESSIF: +30%/sec</span> | -15% risque (8% chance) | RISQUÃ‰!</p>
      <p style="margin: 0.5rem 0; color: #f00;">âš¡ AGRESSIF BONUS: 0.1% chance de TOUT PERDRE!</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>EXEMPLE TRADING:</strong></p>
      <p style="margin: 0.5rem 0;">Tu dÃ©poses 1000 coins en MINIMUM (sÃ»r)</p>
      <p style="margin: 0.5rem 0;">â†’ +3% par seconde = +30 coins/sec</p>
      <p style="margin: 0.5rem 0;">â†’ En 1 minute = +1800 coins! (total: 2800)</p>
      <p style="margin: 0.5rem 0;">Tu dÃ©poses 1000 coins en AGRESSIF (risquÃ©)</p>
      <p style="margin: 0.5rem 0;">â†’ +30% par seconde = +300 coins/sec (WOW!)</p>
      <p style="margin: 0.5rem 0;">â†’ Mais 8% chance de perdre 150 coins/sec...</p>
      <p style="margin: 0.5rem 0;">â†’ Et 0.1% chance de perdre les 1000 coins! ğŸ˜±</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #f00; border-radius: 4px; text-align: left;">
      <p style="color: #f00;"><strong>âš ï¸ IMPORTANT:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… L'argent en TRADING est BLOQUÃ‰!</p>
      <p style="margin: 0.5rem 0;">âœ… Au PRESTIGE, tout se rÃ©initialise (tu perds tout!)</p>
      <p style="margin: 0.5rem 0;">âœ… Donc RETIRE ton trading AVANT de prestige!</p>
      <p style="margin: 0.5rem 0;">âœ… La stratÃ©gie = MINIMUM est plus rentable Ã  long terme!</p>
    </div>`,

  `<h2 style="color: #0af; font-size: 1.8rem; margin-bottom: 1rem;">ğŸ¦ Ã‰TAPE 7: LA BANQUE - SAFE & FACILE</h2>
    <p style="margin: 0.5rem 0; color: #0f0;"><strong>L'investissement SANS RISQUE!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0af; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>Comment Ã§a marche?</strong></p>
      <p style="margin: 0.5rem 0;">âœ… Tu dÃ©poses X coins Ã  la banque</p>
      <p style="margin: 0.5rem 0;">âœ… La banque te donne +0.1% par seconde</p>
      <p style="margin: 0.5rem 0;">âœ… C'est automatique et SANS RISQUE!</p>
      <p style="margin: 0.5rem 0;">âœ… Tu peux retirer quand tu veux</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>EXEMPLE BANQUE:</strong></p>
      <p style="margin: 0.5rem 0;">Tu dÃ©poses 10,000 coins</p>
      <p style="margin: 0.5rem 0;">â†’ +0.1% par sec = +10 coins/sec</p>
      <p style="margin: 0.5rem 0;">â†’ En 1 jour = +864,000 coins!! (total: 874K)</p>
      <p style="margin: 0.5rem 0;">â†’ En 1 semaine = +6M coins!!</p>
      <p style="margin: 0.5rem 0;">â†’ C'est lent mais rÃ©gulier et sÃ»r!</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0;"><strong>ğŸ’¡ STRATÃ‰GIE BANQUE:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… Meilleure que TRADING minimum!</p>
      <p style="margin: 0.5rem 0;">âœ… 100% sÃ»r, aucun risque!</p>
      <p style="margin: 0.5rem 0;">âœ… RESTE MÃŠME AU PRESTIGE!</p>
      <p style="margin: 0.5rem 0;">âœ… Ã€ long terme = les gains s'accumulent!</p>
      <p style="margin: 0.5rem 0;">âœ… UTILISE LA BANQUE AU MAX!</p>
    </div>`,

  `<h2 style="color: #fa0; font-size: 1.8rem; margin-bottom: 1rem;">ğŸš€ Ã‰TAPE 8: L'ASCENSION - LE VRAI ENDGAME!</h2>
    <p style="margin: 0.5rem 0; color: #fa0;"><strong>La VRAIE progression!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>Qu'est-ce que l'Ascension?</strong></p>
      <p style="margin: 0.5rem 0;">âœ… CoÃ»te: 100 Galaxies (premiÃ¨re fois)</p>
      <p style="margin: 0.5rem 0;">âœ… Ensuite: 200 Galaxies (2Ã¨me fois)</p>
      <p style="margin: 0.5rem 0;">âœ… Ensuite: 400 Galaxies (3Ã¨me fois), etc...</p>
      <p style="margin: 0.5rem 0;">âœ… RÃ‰INITIALISE: PiÃ¨ces, gÃ©nÃ©rateurs, upgrades, Ã©toiles!</p>
      <p style="margin: 0.5rem 0;">âœ… GARDE: Les Galaxies + points permanents!</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>LES BONUS:</strong></p>
      <p style="margin: 0.5rem 0;">1Ã¨re Ascension â†’ +5% multiplicateur</p>
      <p style="margin: 0.5rem 0;">2Ã¨me Ascension â†’ +10% multiplicateur (total: 1.05 Ã— 1.05)</p>
      <p style="margin: 0.5rem 0;">3Ã¨me Ascension â†’ +15% multiplicateur (total: Ã— 1.157...)</p>
      <p style="margin: 0.5rem 0;">Avec 10 Ascensions? = Ã—1.629 multiplicateur!</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0;"><strong>ğŸ’¡ STRATÃ‰GIE ASCENSION:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… C'est lent mais EXPONENTIELLEMENT puissant!</p>
      <p style="margin: 0.5rem 0;">âœ… Chaque Ascension rend tout 5% plus facile!</p>
      <p style="margin: 0.5rem 0;">âœ… Fais plusieurs ASCENSIONS pour dominer!</p>
      <p style="margin: 0.5rem 0;">âœ… Ã€ long terme = tu deviens impossible Ã  arrÃªter!</p>
    </div>`,

  `<h2 style="color: #0f0; font-size: 1.8rem; margin-bottom: 1rem;">ğŸ† Ã‰TAPE 9: ACHIEVEMENTS - BADGES & RÃ‰COMPENSES</h2>
    <p style="margin: 0.5rem 0; color: #0f0;"><strong>DÃ©bloque et gagne des coins!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>LES ACHIEVEMENTS:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… 5 Clics â†’ rÃ©compense coins</p>
      <p style="margin: 0.5rem 0;">âœ… 1M coins totaux â†’ rÃ©compense coins</p>
      <p style="margin: 0.5rem 0;">âœ… 10 gÃ©nÃ©rateurs â†’ rÃ©compense coins</p>
      <p style="margin: 0.5rem 0;">âœ… 10 Ã©toiles â†’ rÃ©compense coins</p>
      <p style="margin: 0.5rem 0;">âœ… 100 Ã©toiles â†’ rÃ©compense coins</p>
      <p style="margin: 0.5rem 0;">âœ… 1Ã¨re Galaxie â†’ rÃ©compense coins</p>
      <p style="margin: 0.5rem 0;">âœ… Et 7 autres achievements...</p>
    </div>
    <div style="background: #0a0a2a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0;"><strong>EXEMPLE:</strong></p>
      <p style="margin: 0.5rem 0;">Tu achÃ¨tes 10 gÃ©nÃ©rateurs</p>
      <p style="margin: 0.5rem 0;">â†’ Achievement DÃ‰BLOQUÃ‰: ğŸ¤– AutomatisÃ©!</p>
      <p style="margin: 0.5rem 0;">â†’ Tu gagnes 10,000 coins en bonus!</p>
      <p style="margin: 0.5rem 0;">Tu accumules 100 Ã©toiles</p>
      <p style="margin: 0.5rem 0;">â†’ Achievement DÃ‰BLOQUÃ‰: â­ Supernova!</p>
      <p style="margin: 0.5rem 0;">â†’ Tu gagnes 50,000 coins en bonus!</p>
    </div>`,

  `<h2 style="color: #0af; font-size: 1.8rem; margin-bottom: 1rem;">ğŸŒ™ Ã‰TAPE 10: DARK MATTER & FEATURES AVANCÃ‰ES</h2>
    <p style="margin: 0.5rem 0; color: #0af;"><strong>Les multiplicateurs finaux!</strong></p>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0af; border-radius: 4px; text-align: left;">
      <p style="margin: 0.5rem 0;"><strong>ğŸŒ™ DARK MATTER:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… DÃ©bloquÃ© Ã  Prestige 20</p>
      <p style="margin: 0.5rem 0;">âœ… Chaque unitÃ© = +5% multiplicateur!</p>
      <p style="margin: 0.5rem 0;">âœ… Tu gagnes 1 Dark Matter tous les 10 Prestige aprÃ¨s P20</p>
      <p style="margin: 0.5rem 0;">âœ… Exemple: 5 Dark Matter = Ã—1.276 multiplicateur!</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0;"><strong>ğŸ”— SYNERGIES:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… Robot+Usine (5+3) â†’ +30% production</p>
      <p style="margin: 0.5rem 0;">âœ… Port+Satellite (3+2) â†’ +40% production</p>
      <p style="margin: 0.5rem 0;">âœ… Labo+Usine (2+5) â†’ +50% clics</p>
      <p style="margin: 0.5rem 0;">âœ… 30 gÃ©nÃ©rateurs + P10 â†’ Ã—2 multiplicateur!</p>
    </div>
    <div style="background: #0a0a1a; padding: 1rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0;"><strong>â° BOOSTS & ğŸ“Š GRAPHIQUE:</strong></p>
      <p style="margin: 0.5rem 0;">âœ… Production Ã—2 (50K coins) = 30 secondes de boost!</p>
      <p style="margin: 0.5rem 0;">âœ… Clic Ã—2 (30K coins) = 30 secondes de boost!</p>
      <p style="margin: 0.5rem 0;">âœ… Graphique = voir ta production en temps rÃ©el!</p>
    </div>`,

  `<h2 style="color: #fa0; font-size: 2rem; margin-bottom: 1.5rem;">ğŸ“‹ TA ROADMAP - COMMENT PROGRESSER!</h2>
    <div style="background: #0a0a1a; padding: 1.5rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0; font-size: 1.1rem;"><strong>PHASE 1: LES DÃ‰BUTS (1-2 heures)</strong></p>
      <p style="margin: 0.5rem 0;">1ï¸âƒ£ Clique jusqu'Ã  50 coins</p>
      <p style="margin: 0.5rem 0;">2ï¸âƒ£ AchÃ¨te des Robots au MAX</p>
      <p style="margin: 0.5rem 0;">3ï¸âƒ£ Laisse les Robots gÃ©nÃ©rer 50K coins</p>
      <p style="margin: 0.5rem 0;">4ï¸âƒ£ Fais ton PREMIER PRESTIGE (gagne 1 Ã©toile)</p>
      <p style="margin: 0.5rem 0;">5ï¸âƒ£ DÃ©verrouille l'Usine! Recommence au Prestige!</p>
    </div>
    <div style="background: #0a0a1a; padding: 1.5rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0; font-size: 1.1rem;"><strong>PHASE 2: L'ACCELERATION (2-8 heures)</strong></p>
      <p style="margin: 0.5rem 0;">6ï¸âƒ£ Fais 5-10 prestige pour accumuler des Ã©toiles</p>
      <p style="margin: 0.5rem 0;">7ï¸âƒ£ DÃ©verrouille le Port, le Labo, Satellite!</p>
      <p style="margin: 0.5rem 0;">8ï¸âƒ£ Utilise BANQUE dÃ¨s le dÃ©but (0.1% = +30% par jour!)</p>
      <p style="margin: 0.5rem 0;">9ï¸âƒ£ Fais 15 prestige pour dÃ©bloquer 500 Ã©toiles</p>
      <p style="margin: 0.5rem 0;">ğŸ”Ÿ AchÃ¨te ta 1Ã¨re GALAXIE! ğŸŒ€</p>
    </div>
    <div style="background: #0a0a1a; padding: 1.5rem; margin: 1rem 0; border-left: 3px solid #0af; border-radius: 4px; text-align: left;">
      <p style="color: #0af; font-size: 1.1rem;"><strong>PHASE 3: L'ENDGAME (8+ heures)</strong></p>
      <p style="margin: 0.5rem 0;">1ï¸âƒ£1ï¸âƒ£ Accumule Galaxies (elles te rendent FORT!)</p>
      <p style="margin: 0.5rem 0;">1ï¸âƒ£2ï¸âƒ£ DÃ©verrouille Dark Matter (P20)</p>
      <p style="margin: 0.5rem 0;">1ï¸âƒ£3ï¸âƒ£ Fais ta 1Ã¨re ASCENSION (100 Galaxies)</p>
      <p style="margin: 0.5rem 0;">1ï¸âƒ£4ï¸âƒ£ Chaque Ascension = +5% pour TOUJOURS!</p>
      <p style="margin: 0.5rem 0;">1ï¸âƒ£5ï¸âƒ£ RÃ©pÃ¨te: Accumule Galaxies â†’ Ascends â†’ Recommence!</p>
    </div>`,

  `<h2 style="color: #0f0; font-size: 2rem; margin-bottom: 1.5rem;">ğŸ’¡ LES MEGA-TIPS POUR DOMINER!</h2>
    <div style="background: #0a0a2a; padding: 1.5rem; margin: 1rem 0; border-left: 3px solid #0f0; border-radius: 4px; text-align: left;">
      <p style="color: #0f0; font-size: 1.1rem;"><strong>âœ… TIPS ESSENTIELS:</strong></p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ HOLD le bouton +1 pour acheter rapidement!</p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ Utilise MAX pour acheter au maximum!</p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ Les gÃ©nÃ©rateurs = ton ARGENT (achÃ¨te-les!)</p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ Les Galaxies = ta VRAIE progression!</p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ BANQUE > Trading! (Plus rentable!)</p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ RETIRE ton argent AVANT prestige!</p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ Les Ascensions s'empilent (multiplicatif!)</p>
      <p style="margin: 0.5rem 0;">ğŸ”¥ Combine tout pour la MEILLEURE stratÃ©gie!</p>
    </div>
    <div style="background: #0a0a2a; padding: 1.5rem; margin: 1rem 0; border-left: 3px solid #fa0; border-radius: 4px; text-align: left;">
      <p style="color: #fa0; font-size: 1.1rem;"><strong>âš¡ LES STRATÃ‰GIES PUISSANTES:</strong></p>
      <p style="margin: 0.5rem 0;">1ï¸âƒ£ Banque + Prestige = progression rapide!</p>
      <p style="margin: 0.5rem 0;">2ï¸âƒ£ Galaxies + Ascension = exponentiellement OP!</p>
      <p style="margin: 0.5rem 0;">3ï¸âƒ£ Dark Matter + Synergies = multiplicateurs MASSIFS!</p>
      <p style="margin: 0.5rem 0;">4ï¸âƒ£ Holdings long terme = tu deviens IMBATTABLE!</p>
    </div>
    <div style="background: #0a0a2a; padding: 1.5rem; margin: 1rem 0; border-left: 3px solid #f00; border-radius: 4px; text-align: left;">
      <p style="color: #f00; font-size: 1.1rem;"><strong>ğŸš« LES PIÃˆGES Ã€ Ã‰VITER:</strong></p>
      <p style="margin: 0.5rem 0;">âŒ NE focus pas sur les Upgrades (trop cher!)</p>
      <p style="margin: 0.5rem 0;">âŒ NE gaspille pas en Lotterie (tu perds!)</p>
      <p style="margin: 0.5rem 0;">âŒ NE oublie pas de sauvegarder (paramÃ¨tres!)</p>
      <p style="margin: 0.5rem 0;">âŒ NE laisse pas l'argent bloquÃ© (retire-le!)</p>
      <p style="margin: 0.5rem 0;">âŒ NE prestige trop tard (Ã§a prend du temps!)</p>
    </div>`,

  `<h2 style="color: #0af; font-size: 2rem; margin-bottom: 1.5rem;">ğŸš€ PRÃŠT Ã€ DOMINER? C'EST PARTI! ğŸš€</h2>
    <div style="background: #0a0a1a; padding: 1.5rem; margin: 1rem 0; border-left: 3px solid #0af; border-radius: 4px; text-align: center;">
      <p style="font-size: 1.2rem; color: #0af;"><strong>TU AS TOUT APPRIS!</strong></p>
      <p style="color: #aaa; margin: 1rem 0;">Tu sais maintenant:</p>
      <p style="color: #0f0;">âœ… Comment clicker et gÃ©nÃ©rer de l'argent</p>
      <p style="color: #0f0;">âœ… Comment acheter des gÃ©nÃ©rateurs</p>
      <p style="color: #0f0;">âœ… Comment faire Prestige et accumuler des Ã©toiles</p>
      <p style="color: #0f0;">âœ… Comment acheter des Galaxies</p>
      <p style="color: #0f0;">âœ… Comment utiliser Trading et Banque</p>
      <p style="color: #0f0;">âœ… Comment faire Ascension</p>
      <p style="color: #0f0;">âœ… Comment devenir OP!</p>
    </div>
    <div style="background:#0a1a30;padding:1.5rem;margin:1rem 0;border-radius:4px;border-left:3px solid #0af;">
      <p style="color: #0af; font-size: 1.3rem;"><strong>ğŸ® FERME CE TUTORIEL ET COMMENCE! ğŸ®</strong></p>
      <p style="color: #aaa; margin: 1rem 0;">Clique sur FERMER et:</p>
      <p style="color: #fff; font-size: 1.1rem;"><strong>1. Clique le bouton CLIQUER</strong></p>
      <p style="color: #fff; font-size: 1.1rem;"><strong>2. AchÃ¨te des Robots</strong></p>
      <p style="color: #fff; font-size: 1.1rem;"><strong>3. Laisse-les gÃ©nÃ©rer 50K</strong></p>
      <p style="color: #fff; font-size: 1.1rem;"><strong>4. Fais ton premier PRESTIGE! â­</strong></p>
      <p style="color: #aaa; margin-top: 1rem;">Et voilÃ ! Tu es en route vers l'infini! â™¾ï¸</p>
    </div>
    <p style="color: #0af; margin-top: 2rem; font-size: 1.4rem;">
      <strong>ğŸ’ BON JEU, JOUEUR! ğŸ’</strong>
    </p>
    <p style="color: #fa0; margin-top: 1rem;">N'hÃ©site pas Ã  relire ce tutoriel si tu as des doutes!</p>`
];

// =========== GAME STATE ===========
let game = {
  coins: 0,
  totalCoins: 0,
  totalClicks: 0,
  stars: 0,
  galaxies: 0,
  prestige: 0,
  darkMatter: 0,
  playTime: 0,
  logs: [],
  tradeLogs: [],

  generators: [
    { id: "r", n: "Robot", b: 1, c: 0, p: 50, m: 1.2, unlock: { type: "none" } },
    { id: "u", n: "Usine", b: 1.5, c: 0, p: 500, m: 1.2, unlock: { type: "prestige", val: 1 } },
    { id: "po", n: "Port", b: 4, c: 0, p: 5e3, m: 1.2, unlock: { type: "stars", val: 5 } },
    { id: "l", n: "Labo", b: 15, c: 0, p: 50e3, m: 1.2, unlock: { type: "prestige", val: 3 } },
    { id: "s", n: "Satellite", b: 100, c: 0, p: 500e3, m: 1.2, unlock: { type: "galaxies", val: 1 } }
  ],

  upgrades: [
    { id: "c1", n: "Clic +50%", p: 100, e: 1.02, b: 0, t: "c", unlock: { type: "none" } },
    { id: "r1", n: "Robot Ã—2", p: 2e3, e: 2, b: 0, t: "r", unlock: { type: "prestige", val: 1 } },
    { id: "r2", n: "Robot Ã—3", p: 50e3, e: 3, b: 0, t: "r", unlock: { type: "stars", val: 10 } },
    { id: "u1", n: "Usine Ã—2", p: 50e3, e: 2, b: 0, t: "u", unlock: { type: "prestige", val: 2 } },
    { id: "u2", n: "Usine Ã—3", p: 500e3, e: 3, b: 0, t: "u", unlock: { type: "prestige", val: 5 } },
    { id: "po1", n: "Port Ã—2", p: 500e3, e: 2, b: 0, t: "po", unlock: { type: "stars", val: 20 } },
    { id: "l1", n: "Labo Ã—2", p: 5e6, e: 2, b: 0, t: "l", unlock: { type: "prestige", val: 4 } },
    { id: "s1", n: "Satellite Ã—2", p: 50e6, e: 2, b: 0, t: "s", unlock: { type: "galaxies", val: 1 } }
  ],

  quests: [
    { id: "q1", n: "1M piÃ¨ces", c: () => game.totalCoins >= 1e6, r: 500, rt: "s", d: 0 },
    { id: "q2", n: "5 gÃ©nÃ©rateurs", c: () => game.generators.reduce((a, g) => a + g.c, 0) >= 5, r: 5000, rt: "c", d: 0 },
    { id: "q3", n: "Prestige 3x", c: () => game.prestige >= 3, r: 1, rt: "g", d: 0 }
  ],

  boosts: [],
  graphData: [],
  
  trades: {
    min: { amount: 0, totalGains: 0, totalLosses: 0 },
    mid: { amount: 0, totalGains: 0, totalLosses: 0 },
    high: { amount: 0, totalGains: 0, totalLosses: 0 }
  },

  ascension: 0,
  ascensionCount: 0,

  bankInvested: 0,
  bankGenerated: 0,

  lotteryTickets: 0,
  lotteryLog: [],

  achievements: [
    { id: "click5", name: "ğŸ–±ï¸ DÃ©butant", desc: "Faire 5 clics", check: () => game.totalClicks >= 5, reward: 0, unlocked: false },
    { id: "coins1m", name: "ğŸ’° Millionnaire", desc: "1M coins totaux", check: () => game.totalCoins >= 1e6, reward: 1000, unlocked: false },
    { id: "gen10", name: "ğŸ¤– AutomatisÃ©", desc: "10 gÃ©nÃ©rateurs", check: () => game.generators.reduce((a, g) => a + g.c, 0) >= 10, reward: 10000, unlocked: false },
    { id: "stars10", name: "â­ Star", desc: "10 Ã‰toiles", check: () => game.stars >= 10, reward: 5000, unlocked: false },
    { id: "stars100", name: "â­ Supernova", desc: "100 Ã‰toiles", check: () => game.stars >= 100, reward: 50000, unlocked: false },
    { id: "galaxy1", name: "ğŸŒ€ Cosmique", desc: "1Ã¨re Galaxie", check: () => game.galaxies >= 1, reward: 25000, unlocked: false },
    { id: "galaxy5", name: "ğŸŒ€ Univers", desc: "5 Galaxies", check: () => game.galaxies >= 5, reward: 100000, unlocked: false },
    { id: "prestige5", name: "âš¡ Prestigieux", desc: "5 Prestige", check: () => game.prestige >= 5, reward: 50000, unlocked: false },
    { id: "prestige20", name: "âš¡ LÃ©gende", desc: "20 Prestige", check: () => game.prestige >= 20, reward: 200000, unlocked: false },
    { id: "trading1m", name: "ğŸ’¸ Trader Pro", desc: "1M en Trading", check: () => (game.trades.min.totalGains + game.trades.mid.totalGains + game.trades.high.totalGains) >= 1e6, reward: 100000, unlocked: false },
    { id: "lottery10", name: "ğŸ° Chanceux", desc: "10 tirages lotterie", check: () => game.lotteryTickets >= 10, reward: 50000, unlocked: false },
    { id: "darkm5", name: "ğŸŒ™ Ombre", desc: "5 Dark Matter", check: () => game.darkMatter >= 5, reward: 75000, unlocked: false },
  ]
};

function isUnlocked(item) {
  if (!item.unlock || item.unlock.type === "none") return true;
  
  if (item.unlock.type === "prestige") return game.prestige >= item.unlock.val;
  if (item.unlock.type === "stars") return game.stars >= item.unlock.val;
  if (item.unlock.type === "galaxies") return game.galaxies >= item.unlock.val;
  
  return false;
}

function getUnlockText(item) {
  if (!item.unlock || item.unlock.type === "none") return "";
  
  if (item.unlock.type === "prestige") {
    return `ğŸ”’ DÃ©bloquÃ© Ã  Prestige ${item.unlock.val} (actuellement: ${game.prestige})`;
  }
  if (item.unlock.type === "stars") {
    return `ğŸ”’ DÃ©bloquÃ© Ã  ${item.unlock.val}â­ (actuellement: ${game.stars})`;
  }
  if (item.unlock.type === "galaxies") {
    return `ğŸ”’ DÃ©bloquÃ© Ã  ${item.unlock.val}ğŸŒ€ (actuellement: ${game.galaxies})`;
  }
  
  return "";
}

function $(id) {
  return document.getElementById(id);
}

function fmt(n) {
  if (!isFinite(n) || isNaN(n)) return "0";
  
  if (n >= 1e15) {
    let exp = Math.floor(Math.log10(n));
    let mantissa = (n / Math.pow(10, exp)).toFixed(2);
    return mantissa + "e" + exp;
  }
  if (n >= 1e12) return (n / 1e12).toFixed(1) + "T";
  if (n >= 1e9) return (n / 1e9).toFixed(1) + "B";
  if (n >= 1e6) return (n / 1e6).toFixed(1) + "M";
  if (n >= 1e3) return (n / 1e3).toFixed(1) + "K";
  return Math.round(n).toString();
}

function log(msg) {
  game.logs.unshift(msg);
  if (game.logs.length > 12) game.logs.pop();
  updateLog();
}

function tradeLog(msg, type = "info") {
  game.tradeLogs.unshift({ msg, type, time: Date.now() });
  if (game.tradeLogs.length > 20) game.tradeLogs.pop();
  updateTradeLog();
}

function save() {
  localStorage.setItem(SAVE_KEY, JSON.stringify(game));
  updateSaveInfo();
}

function load() {
  let data = localStorage.getItem(SAVE_KEY);
  if (data) game = JSON.parse(data);
}

function getTradeConfig(type) {
  const configs = {
    min: { gainRate: 0.03, lossChance: 0.005, lossRate: 0.02 },
    mid: { gainRate: 0.10, lossChance: 0.03, lossRate: 0.05 },
    high: { gainRate: 0.30, lossChance: 0.08, lossRate: 0.15, riskAll: 0.001 }
  };
  return configs[type];
}

function investTrade(type) {
  let input = $(`${type}Input`);
  let amount = parseFloat(input.value);
  
  if (!amount || amount <= 0 || game.coins < amount) {
    alert("âŒ Montant invalide!");
    return;
  }

  game.coins -= amount;
  game.trades[type].amount += amount;
  input.value = "";
  tradeLog(`ğŸ“¤ DÃ©pÃ´t ${type}: +${fmt(amount)}`, "info");
  log(`ğŸ“¤ Trade ${type}: +${fmt(amount)}`);
  save();
  updateUI();
}

function withdrawTrade(type) {
  let trade = game.trades[type];
  if (trade.amount <= 0) {
    alert("âŒ Rien Ã  retirer!");
    return;
  }

  game.coins += trade.amount;
  game.totalCoins += trade.amount;
  tradeLog(`ğŸ“¥ Retrait ${type}: +${fmt(trade.amount)} âœ…`, "gain");
  log(`ğŸ“¥ Retrait ${type}: +${fmt(trade.amount)}`);
  trade.amount = 0;
  trade.totalGains = 0;
  trade.totalLosses = 0;
  save();
  updateUI();
}

function processTradeGains() {
  for (let type of ["min", "mid", "high"]) {
    let trade = game.trades[type];
    if (trade.amount <= 0) continue;

    let config = getTradeConfig(type);
    
    let gain = trade.amount * config.gainRate / FPS;
    trade.amount += gain;
    trade.totalGains += gain;

    let rand = Math.random();
    
    if (type === "high" && rand < config.riskAll) {
      tradeLog(`ğŸ’¥ CATASTROPHE! Vous avez tout perdu en ${type}!`, "loss");
      log(`ğŸ’¥ Trade ${type}: TOUT PERDU!`);
      trade.amount = 0;
      trade.totalGains = 0;
      trade.totalLosses = 0;
    } else if (rand < config.lossChance) {
      let loss = trade.amount * config.lossRate;
      trade.amount = Math.max(0, trade.amount - loss);
      trade.totalLosses += loss;
      tradeLog(`ğŸ“‰ Perte ${type}: -${fmt(loss)}`, "loss");
      log(`ğŸ“‰ Trade ${type}: -${fmt(loss)}`);
    }
  }

  save();
  updateUI();
}

function updateTradeLog() {
  let html = "";
  for (let entry of game.tradeLogs) {
    html += `<div class="trade-log-event ${entry.type}">${entry.msg}</div>`;
  }
  $("tradeLog").innerHTML = html || "<div class='trade-log-event'>En attente...</div>";
}

function clickVal() {
  let v = 1;
  for (let u of game.upgrades) {
    if (u.t === "c" && u.b > 0) v *= Math.pow(u.e, u.b);
  }
  
  let starsMultiplier = Math.pow(1.03, game.stars);
  let galaxiesMultiplier = Math.pow(1.01, game.galaxies);
  let ascensionMultiplier = 1 + (game.ascension * 0.05);
  
  if (!isFinite(starsMultiplier)) starsMultiplier = 1e308;
  if (!isFinite(galaxiesMultiplier)) galaxiesMultiplier = 1e308;
  
  return v * starsMultiplier * galaxiesMultiplier * (1 + game.darkMatter * 0.05) * ascensionMultiplier;
}

function getProd() {
  let total = 0;
  for (let g of game.generators) {
    let e = 1;
    for (let u of game.upgrades) {
      if (u.t === g.id && u.b > 0) e *= Math.pow(u.e, u.b);
    }
    total += g.c * g.b * e;
  }

  let sy = 1;
  let r = game.generators[0], us = game.generators[1], p = game.generators[2], l = game.generators[3], s = game.generators[4];

  if (r.c >= 5 && us.c >= 3) sy *= 1.3;
  if (p.c >= 3 && s.c >= 2) sy *= 1.4;
  if (l.c >= 2 && us.c >= 5) sy *= 1.2;

  let starsMultiplier = Math.pow(1.03, game.stars);
  let galaxiesMultiplier = Math.pow(1.01, game.galaxies);
  let ascensionMultiplier = 1 + (game.ascension * 0.05);

  if (!isFinite(starsMultiplier)) starsMultiplier = 1e308;
  if (!isFinite(galaxiesMultiplier)) galaxiesMultiplier = 1e308;

  return (total * sy) * starsMultiplier * galaxiesMultiplier * (1 + game.darkMatter * 0.05) * ascensionMultiplier;
}

function clickBtn() {
  let v = clickVal();
  game.coins += v;
  game.totalCoins += v;
  game.totalClicks++;
  skipQuestCheck = true;
  updateUI();
  skipQuestCheck = false;
}

function buyGen(id) {
  let g = game.generators.find(x => x.id === id);
  if (!g || !isUnlocked(g)) return;

  let cost = g.p * Math.pow(g.m, g.c);
  if (game.coins < cost) return;

  game.coins -= cost;
  g.c++;
  log("âœ… +" + g.n);
  save();
  skipQuestCheck = true;
  updateUI();
  skipQuestCheck = false;
}

function buyGenMax(id) {
  let g = game.generators.find(x => x.id === id);
  if (!g || !isUnlocked(g)) return;

  let count = 0;
  while (true) {
    let cost = g.p * Math.pow(g.m, g.c);
    if (game.coins < cost) break;
    game.coins -= cost;
    g.c++;
    count++;
  }
  
  if (count > 0) {
    log("âœ… +" + count + "x " + g.n);
    save();
    skipQuestCheck = true;
    updateUI();
    skipQuestCheck = false;
  }
}

function buyUp(id) {
  let u = game.upgrades.find(x => x.id === id);
  if (!u || !isUnlocked(u)) return;

  let cost = u.p * Math.pow(1.15, u.b);
  if (game.coins < cost) return;

  game.coins -= cost;
  u.b++;
  log("âœ… " + u.n + " +" + (u.b) + "x");
  save();
  skipQuestCheck = true;
  updateUI();
  skipQuestCheck = false;
}

function buyUpMax(id) {
  let u = game.upgrades.find(x => x.id === id);
  if (!u || !isUnlocked(u)) return;

  let count = 0;
  while (true) {
    let cost = u.p * Math.pow(1.15, u.b);
    if (game.coins < cost) break;
    game.coins -= cost;
    u.b++;
    count++;
  }
  
  if (count > 0) {
    log("âœ… " + u.n + " +${count}");
    save();
    skipQuestCheck = true;
    updateUI();
    skipQuestCheck = false;
  }
}

function buyBoost(boostType) {
  let costMap = { p: 50e3, c: 30e3 };
  let multMap = { p: 2, c: 2 };
  let cost = costMap[boostType];
  let mult = multMap[boostType];

  if (game.coins < cost) return;

  game.coins -= cost;
  game.boosts.push({ type: boostType, m: mult, e: Date.now() + 30e3 });
  log("â° Boost " + boostType);
  save();
  updateUI();
}

function doPrestige() {
  let baseCost = 50000;
  let prestigeCost = baseCost * Math.pow(1.5, game.prestige);
  
  if (game.coins < prestigeCost) return;

  let coinsForThisPrestige = prestigeCost;
  let starsFromThisPrestige = Math.floor(coinsForThisPrestige / prestigeCost);
  let ms = Math.min(1.5, 1 + game.prestige * 0.02);
  let starsGained = Math.floor(starsFromThisPrestige * ms);

  game.coins -= coinsForThisPrestige;
  game.totalCoins += coinsForThisPrestige;
  game.stars += starsGained;
  game.prestige++;

  if (game.prestige >= 20 && game.prestige % 10 === 0) game.darkMatter++;

  for (let gen of game.generators) gen.c = 0;
  for (let u of game.upgrades) {
    u.b = 0;
  }

  let clickUpgrade = game.upgrades.find(u => u.id === "c1");
  let robotUpgrade = game.upgrades.find(u => u.id === "r1");
  
  if (clickUpgrade) clickUpgrade.b += 0.05;
  if (robotUpgrade) robotUpgrade.b += 0.05;
  
  log("ğŸ Bonus: +0.05 Clic, +0.05 Robot");

  game.trades.min = { amount: 0, totalGains: 0, totalLosses: 0 };
  game.trades.mid = { amount: 0, totalGains: 0, totalLosses: 0 };
  game.trades.high = { amount: 0, totalGains: 0, totalLosses: 0 };
  log("ğŸ’¨ Les trades ont Ã©tÃ© rÃ©initialisÃ©s!");

  log("â­ +" + starsGained + "! (Prestige " + game.prestige + ")");
  log("ğŸ‰ 1 Prestige effectuÃ©!");
  save();
  updateUI();
}

function doGalaxy() {
  let cost = 500 + (game.galaxies * 50);
  if (game.stars < cost) return;

  game.stars -= cost;
  game.galaxies++;
  log("ğŸŒ€ +1!");
  save();
  updateUI();
}

function getSynergies() {
  let s = [];
  let r = game.generators[0], u = game.generators[1], p = game.generators[2], l = game.generators[3], sat = game.generators[4];

  if (r.c >= 5 && u.c >= 3) s.push("âœ… Robot+Usine +30%");
  if (p.c >= 3 && sat.c >= 2) s.push("âœ… Port+Satellite +40%");
  if (l.c >= 2 && u.c >= 5) s.push("âœ… Labo+Usine +50% clics");

  let tg = [r, u, p, l, sat].reduce((a, g) => a + g.c, 0);
  if (tg >= 30 && game.prestige >= 10) s.push("âœ… MEGA SYNERGIE Ã—2!");

  return s.length ? s.join("<br>") : "Aucune synergy";
}

function checkQuests() {
  for (let q of game.quests) {
    if (!q.d && q.c()) {
      q.d = 1;
      if (q.rt === "s") game.stars += q.r;
      else if (q.rt === "c") {
        game.coins += q.r;
        game.totalCoins += q.r;
      }
      else if (q.rt === "g") game.galaxies += q.r;
      log("ğŸ¯ " + q.n);
      save();
    }
  }
}

function drawGraph() {
  let c = $("graph");
  if (!c || graphData.length < 2) return;

  let ct = c.getContext("2d");
  ct.fillStyle = "#0a0a0a";
  ct.fillRect(0, 0, c.width, c.height);

  let mx = Math.max(...graphData) || 1;

  ct.strokeStyle = "#0af";
  ct.lineWidth = 2;
  ct.beginPath();

  for (let i = 0; i < graphData.length; i++) {
    let x = i / graphData.length * c.width;
    let y = c.height - (graphData[i] / mx) * c.height * 0.9;
    if (i === 0) ct.moveTo(x, y);
    else ct.lineTo(x, y);
  }

  ct.stroke();
}

function updateUI() {
  let p = getProd();

  $("coins").textContent = fmt(game.coins);
  $("cps").textContent = fmt(p);
  $("stars").textContent = game.stars;
  $("galaxies").textContent = game.galaxies;
  $("dm").textContent = game.darkMatter;
  $("dmCount").textContent = game.darkMatter;
  
  let blockedTotal = game.trades.min.amount + game.trades.mid.amount + game.trades.high.amount;
  $("tradeBlocked").textContent = fmt(blockedTotal);
  
  let dmInfo = "";
  if (game.darkMatter === 0) {
    dmInfo = "DÃ©bloquÃ© Ã  Prestige 20! +1 tous les 10 Prestige aprÃ¨s P20.";
  } else {
    let nextDM = Math.ceil((game.prestige - 20) / 10) * 10 + 20;
    dmInfo = `âœ… DÃ©bloquÃ©! Prochain: ${nextDM} Prestige (actuellement: ${game.prestige})`;
  }
  $("dmInfo").textContent = dmInfo;
  $("clickVal").textContent = fmt(clickVal());
  $("prestProg").textContent = Math.floor(game.coins);
  let baseCost = 50000;
  let nextPrestigeCost = baseCost * Math.pow(1.5, game.prestige);
  let prestigePossible = game.coins >= nextPrestigeCost ? 1 : 0;
  $("prestigeCost").textContent = fmt(nextPrestigeCost);
  $("prestigeCount").textContent = prestigePossible > 0 ? "âœ… OUI" : "âŒ NON";
  $("galaxyCost").textContent = fmt(500 + (game.galaxies * 50));
  $("totalCoins").textContent = fmt(game.totalCoins);
  $("totalClicks").textContent = game.totalClicks;
  $("playTime").textContent = game.playTime + "s";
  $("presCount").textContent = game.prestige;

  $("ascension").textContent = game.ascension || 0;
  $("ascensionBonus").textContent = (game.ascension || 0) * 5;
  $("ascensionCost").textContent = fmt(100 * Math.pow(2, game.ascension || 0));
  $("ascensionRequired").textContent = 100 * Math.pow(2, game.ascension || 0);
  $("ascensionCurrent").textContent = game.galaxies;

  $("bankAmount").textContent = fmt(game.bankInvested || 0);
  $("bankInvested").textContent = fmt(game.bankInvested || 0);
  let bankGains = ((game.bankInvested || 0) * 0.001) / FPS;
  $("bankGains").textContent = fmt(bankGains);
  $("bankGenerated").textContent = fmt(game.bankGenerated || 0);

  $("lotteryTickets").textContent = game.lotteryTickets || 0;
  let lotteryHtml = "";
  if (game.lotteryLog) {
    for (let log of game.lotteryLog) {
      lotteryHtml += `<div style="padding:0.3rem;color:#aaa">${log}</div>`;
    }
  }
  if ($("lotteryLog")) $("lotteryLog").innerHTML = lotteryHtml || "<div style='color:#aaa'>En attente...</div>";

  let achCount = game.achievements ? game.achievements.filter(a => a.unlocked).length : 0;
  $("achievementCount").textContent = achCount;
  let achHtml = "";
  if (game.achievements) {
    for (let ach of game.achievements) {
      let achDiv = ach.unlocked ? 
        `<div style="background:#0a0a2a;padding:1rem;border-radius:4px;border-left:3px solid #0f0">
          <div style="color:#0f0;font-weight:bold">${ach.name}</div>
          <div style="color:#aaa;font-size:0.9rem">${ach.desc}</div>
          <div style="color:#fa0;font-size:0.9rem">+${ach.reward} ğŸ’°</div>
        </div>` :
        `<div style="background:#0a0a0a;padding:1rem;border-radius:4px;border-left:3px solid #666;opacity:0.5">
          <div style="color:#aaa;font-weight:bold">${ach.name}</div>
          <div style="color:#666;font-size:0.9rem">${ach.desc}</div>
        </div>`;
      achHtml += achDiv;
    }
  }
  if ($("achievementsList")) $("achievementsList").innerHTML = achHtml;

  checkAchievements();
  for (let type of ["min", "mid", "high"]) {
    let trade = game.trades[type];
    let config = getTradeConfig(type);
    let gain = trade.amount * config.gainRate;
    
    $(`${type}Amount`).textContent = fmt(trade.amount);
    $(`${type}Gain`).textContent = fmt(gain);
    $(`${type}Loss`).textContent = fmt(trade.amount * config.lossRate);
  }

  let genHtml = "";
  for (let g of game.generators) {
    let cost = g.p * Math.pow(g.m, g.c);
    let unlocked = isUnlocked(g);
    let unlockText = getUnlockText(g);
    
    let upgMultiplier = 1;
    for (let u of game.upgrades) {
      if (u.t === g.id && u.b) upgMultiplier *= u.e;
    }
    let gainPerSec = g.c * g.b * upgMultiplier * Math.pow(1.25, game.stars) * Math.pow(1.6, game.galaxies) * (1 + game.darkMatter * 0.05);
    
    if (!unlocked) {
      genHtml += `<div class="item" style="opacity:0.5;border-left:3px solid #f66"><strong>${g.n}</strong> ${unlockText}</div>`;
    } else {
      genHtml += `<div class="item"><strong>${g.n}</strong> Ã—${g.c} <span style="color:#0f0">(${fmt(gainPerSec)}/s)</span><button class="btn gen-buy" data-id="${g.id}" onmousedown="startAutoClick('${g.id}', 'gen')" onmouseup="stopAutoClick()" onmouseleave="stopAutoClick()" ${game.coins < cost ? "disabled" : ""}>+1 (${fmt(cost)})</button><button class="btn" style="background:#0f0; color:#000" onclick="buyGenMax('${g.id}')">MAX</button></div>`;
    }
  }
  $("gensList").innerHTML = genHtml;

  let upHtml = "";
  for (let u of game.upgrades) {
    let unlocked = isUnlocked(u);
    let unlockText = getUnlockText(u);
    let cost = u.p * Math.pow(1.15, u.b);
    
    if (!unlocked) {
      upHtml += `<div class="item" style="opacity:0.5;border-left:3px solid #f66"><strong>${u.n}</strong> ${unlockText}</div>`;
    } else {
      upHtml += `<div class="item"><strong>${u.n}</strong> Ã—${u.e} <span style="color:#0f0">(Lvl ${u.b})</span><button class="btn up-buy" data-id="${u.id}" onmousedown="startAutoClick('${u.id}', 'up')" onmouseup="stopAutoClick()" onmouseleave="stopAutoClick()" ${game.coins < cost ? "disabled" : ""}>+1 (${fmt(cost)})</button><button class="btn" style="background:#0f0; color:#000" onclick="buyUpMax('${u.id}')">MAX</button></div>`;
    }
  }
  $("upsList").innerHTML = upHtml || "Tous dÃ©bloquÃ©s!";

  let questHtml = "";
  for (let q of game.quests) {
    questHtml += `<div class="item">${q.n} <span style="color:${q.d ? "#0f0" : "#ffa"}">${q.d ? "âœ…" : "â³"}</span></div>`;
  }
  $("questsList").innerHTML = questHtml;

  let boostHtml = "";
  game.boosts.forEach(b => {
    if (Date.now() < b.e) {
      let sec = Math.ceil((b.e - Date.now()) / 1e3);
      boostHtml += `<div style="color:#ffa">${b.type} Ã—${b.m} (${sec}s)</div>`;
    }
  });
  $("activeBoosts").innerHTML = boostHtml || "Aucun";

  $("synergies").innerHTML = getSynergies();

  graphData.push(p);
  if (graphData.length > 60) graphData.shift();
  drawGraph();

  if (!skipQuestCheck) checkQuests();

  let logHtml = "";
  for (let l of game.logs) logHtml += `<div>${l}</div>`;
  $("log").innerHTML = logHtml;

  save();
}

function updateLog() {
  let logHtml = "";
  for (let l of game.logs) logHtml += `<div>${l}</div>`;
  $("log").innerHTML = logHtml;
}

function updateSaveInfo() {
  let d = new Date().toLocaleString();
  $("lastSave").textContent = d;
  let size = (JSON.stringify(game).length / 1024).toFixed(2);
  $("saveSize").textContent = size + " KB";
}

function downloadSave() {
  let data = JSON.stringify(game, null, 2);
  let blob = new Blob([data], { type: "application/json" });
  let url = URL.createObjectURL(blob);
  let a = document.createElement("a");
  a.href = url;
  a.download = "incremental_save_" + Date.now() + ".json";
  a.click();
  URL.revokeObjectURL(url);
}

function uploadSave() {
  $("fileInput").click();
}

$("fileInput").addEventListener("change", e => {
  let file = e.target.files[0];
  if (!file) return;

  let reader = new FileReader();
  reader.onload = f => {
    try {
      let data = JSON.parse(f.target.result);
      game = data;
      save();
      updateUI();
      log("ğŸ“‚ Sauvegarde importÃ©e!");
      alert("âœ… Sauvegarde importÃ©e avec succÃ¨s!");
    } catch (err) {
      alert("âŒ Erreur: fichier invalide");
    }
  };
  reader.readAsText(file);
});

function resetGame() {
  if (!confirm("âš ï¸ ATTENTION: Cela supprimera ta progression!\n\nEs-tu VRAIMENT sÃ»r?")) return;
  if (!confirm("ğŸ”„ Dernier avertissement! C'est irrÃ©versible!")) return;

  game = {
    coins: 0,
    totalCoins: 0,
    totalClicks: 0,
    stars: 0,
    galaxies: 0,
    prestige: 0,
    darkMatter: 0,
    playTime: 0,
    logs: [],
    tradeLogs: [],
    generators: [
      { id: "r", n: "Robot", b: 0.5, c: 0, p: 50, m: 1.2, unlock: { type: "none" } },
      { id: "u", n: "Usine", b: 0.8, c: 0, p: 500, m: 1.2, unlock: { type: "prestige", val: 1 } },
      { id: "po", n: "Port", b: 2, c: 0, p: 5e3, m: 1.2, unlock: { type: "stars", val: 5 } },
      { id: "l", n: "Labo", b: 8, c: 0, p: 50e3, m: 1.2, unlock: { type: "prestige", val: 3 } },
      { id: "s", n: "Satellite", b: 50, c: 0, p: 500e3, m: 1.2, unlock: { type: "galaxies", val: 1 } }
    ],
    upgrades: [
      { id: "c1", n: "Clic +50%", p: 100, e: 1.02, b: 0, t: "c", unlock: { type: "none" } },
      { id: "r1", n: "Robot Ã—2", p: 2e3, e: 2, b: 0, t: "r", unlock: { type: "prestige", val: 1 } },
      { id: "r2", n: "Robot Ã—3", p: 50e3, e: 3, b: 0, t: "r", unlock: { type: "stars", val: 10 } },
      { id: "u1", n: "Usine Ã—2", p: 50e3, e: 2, b: 0, t: "u", unlock: { type: "prestige", val: 2 } },
      { id: "u2", n: "Usine Ã—3", p: 500e3, e: 3, b: 0, t: "u", unlock: { type: "prestige", val: 5 } },
      { id: "po1", n: "Port Ã—2", p: 500e3, e: 2, b: 0, t: "po", unlock: { type: "stars", val: 20 } },
      { id: "l1", n: "Labo Ã—2", p: 5e6, e: 2, b: 0, t: "l", unlock: { type: "prestige", val: 4 } },
      { id: "s1", n: "Satellite Ã—2", p: 50e6, e: 2, b: 0, t: "s", unlock: { type: "galaxies", val: 1 } }
    ],
    quests: [
      { id: "q1", n: "1M piÃ¨ces", c: () => game.totalCoins >= 1e6, r: 500, rt: "s", d: 0 },
      { id: "q2", n: "5 gÃ©nÃ©rateurs", c: () => game.generators.reduce((a, g) => a + g.c, 0) >= 5, r: 5000, rt: "c", d: 0 },
      { id: "q3", n: "Prestige 3x", c: () => game.prestige >= 3, r: 1, rt: "g", d: 0 }
    ],
    boosts: [],
    graphData: [],
    trades: {
      min: { amount: 0, totalGains: 0, totalLosses: 0 },
      mid: { amount: 0, totalGains: 0, totalLosses: 0 },
      high: { amount: 0, totalGains: 0, totalLosses: 0 }
    }
  };

  localStorage.removeItem(SAVE_KEY);
  save();
  updateUI();
  log("ğŸ”„ Jeu rÃ©initialisÃ©!");
  alert("âœ… Jeu rÃ©initialisÃ©!");
}

function showTutorial() {
  $("tutorialModal").style.display = "block";
  tutPage = 0;
  updateTutorial();
}

function updateTutorial() {
  $("tutText").innerHTML = TUTORIAL[tutPage];
  $("tutPage").textContent = tutPage + 1;
}

$("nextBtn").addEventListener("click", () => {
  if (tutPage < 15) {
    tutPage++;
    updateTutorial();
  }
});

$("prevBtn").addEventListener("click", () => {
  if (tutPage > 0) {
    tutPage--;
    updateTutorial();
  }
});

document.querySelectorAll(".tab-btn").forEach(btn => {
  btn.addEventListener("click", function () {
    document.querySelectorAll(".tab-btn").forEach(x => x.classList.remove("active"));
    document.querySelectorAll(".content").forEach(x => x.classList.remove("active"));
    this.classList.add("active");
    $(this.dataset.tab).classList.add("active");
  });
});

$("clickBtn").addEventListener("click", clickBtn);
$("prestigeBtn").addEventListener("click", doPrestige);
$("galaxyBtn").addEventListener("click", doGalaxy);
$("boostProd").addEventListener("click", () => buyBoost("p"));
$("boostClick").addEventListener("click", () => buyBoost("c"));
$("downloadBtn").addEventListener("click", downloadSave);
$("uploadBtn").addEventListener("click", uploadSave);
$("resetBtn").addEventListener("click", resetGame);

document.addEventListener("click", e => {
  if (e.target.classList.contains("gen-buy")) buyGen(e.target.dataset.id);
  if (e.target.classList.contains("up-buy")) buyUp(e.target.dataset.id);
});

function doAscension() {
  let cost = 100 * Math.pow(2, game.ascension);
  if (game.galaxies < cost) {
    alert("âŒ Tu as besoin de " + cost + " Galaxies!");
    return;
  }

  if (!confirm("ğŸš€ Ascensionner? Tout se rÃ©initialise sauf les Galaxies!")) return;

  game.galaxies -= cost;
  game.ascension++;
  game.ascensionCount++;

  game.coins = 0;
  game.stars = 0;
  game.prestige = 0;
  game.darkMatter = 0;
  game.trades.min = { amount: 0, totalGains: 0, totalLosses: 0 };
  game.trades.mid = { amount: 0, totalGains: 0, totalLosses: 0 };
  game.trades.high = { amount: 0, totalGains: 0, totalLosses: 0 };

  for (let gen of game.generators) gen.c = 0;
  for (let u of game.upgrades) u.b = 0;

  log("ğŸš€ ASCENSION! Nouveaux bonus: +" + (game.ascension * 5) + "%");
  save();
  updateUI();
}

function depositBank() {
  let amount = parseFloat($("bankInput").value);
  if (!amount || amount <= 0 || game.coins < amount) {
    alert("âŒ Montant invalide!");
    return;
  }

  game.coins -= amount;
  game.bankInvested += amount;
  $("bankInput").value = "";
  log("ğŸ¦ DÃ©pÃ´t banque: +" + fmt(amount));
  save();
  updateUI();
}

function withdrawBank() {
  if (game.bankInvested <= 0) {
    alert("âŒ Rien Ã  retirer!");
    return;
  }

  game.coins += game.bankInvested;
  game.totalCoins += game.bankInvested;
  log("ğŸ¦ Retrait banque: +" + fmt(game.bankInvested));
  game.bankInvested = 0;
  game.bankGenerated = 0;
  save();
  updateUI();
}

function buyLotteryTicket(count) {
  let cost = 100 * count;
  if (game.coins < cost) {
    alert("âŒ Pas assez de piÃ¨ces!");
    return;
  }

  game.coins -= cost;
  game.lotteryTickets += count;
  log("ğŸ° +" + count + " tickets");
  save();
  updateUI();
}

function playLottery() {
  if (game.lotteryTickets <= 0) {
    alert("âŒ Tu n'as pas de tickets!");
    return;
  }

  game.lotteryTickets--;
  let rand = Math.random();
  let gain = 0;
  let result = "";

  if (rand < 0.50) {
    gain = 50 + Math.floor(Math.random() * 50);
    result = "ğŸŸ¢ Petit lot: +" + gain;
  } else if (rand < 0.75) {
    gain = 500 + Math.floor(Math.random() * 500);
    result = "ğŸŸ¡ Moyen lot: +" + gain;
  } else {
    gain = 5000 + Math.floor(Math.random() * 5000);
    result = "ğŸ”´ GROS LOT: +" + gain + "!!! ğŸ‰";
  }

  game.coins += gain;
  game.totalCoins += gain;
  game.lotteryLog.unshift(result);
  if (game.lotteryLog.length > 15) game.lotteryLog.pop();
  
  log(result);
  save();
  updateUI();
}

function checkAchievements() {
  if (!game.achievements) return;
  
  for (let ach of game.achievements) {
    if (!ach.unlocked && ach.check()) {
      ach.unlocked = true;
      game.coins += ach.reward;
      game.totalCoins += ach.reward;
      log("ğŸ† ACHIEVEMENT: " + ach.name + " (+" + ach.reward + ")");
    }
  }
}

let autoClickData = {
  active: false,
  targetId: null,
  targetType: null,
};

function startAutoClick(id, type) {
  autoClickData.active = true;
  autoClickData.targetId = id;
  autoClickData.targetType = type;
}

function stopAutoClick() {
  autoClickData.active = false;
  autoClickData.targetId = null;
  autoClickData.targetType = null;
}

setInterval(() => {
  if (!autoClickData.active) return;
  
  if (autoClickData.targetType === "gen") {
    buyGen(autoClickData.targetId);
  } else if (autoClickData.targetType === "up") {
    buyUp(autoClickData.targetId);
  }
}, 50);

setInterval(() => {
  let p = getProd();
  game.coins += p / FPS;
  game.totalCoins += p / FPS;
  
  if (game.bankInvested > 0) {
    let bankGains = (game.bankInvested * 0.001) / FPS;
    game.bankInvested += bankGains;
    game.bankGenerated += bankGains;
  }
  
  processTradeGains();
  updateUI();
}, 1000 / FPS);

setInterval(() => {
  game.playTime++;
  updateUI();
}, 1000);

try {
  let oldSave = localStorage.getItem(SAVE_KEY);
  if (oldSave) {
    let parsed = JSON.parse(oldSave);
    if (!parsed.achievements || !parsed.ascension || !parsed.bankInvested) {
      localStorage.removeItem(SAVE_KEY);
    }
  }
} catch(e) {
  localStorage.removeItem(SAVE_KEY);
}

load();
updateUI();
log("Bienvenue!");
updateTradeLog();
</script>

</body>
</html>
