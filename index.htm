<!DOCTYPE html>

<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1">
  <title>Incremental Trade ULTIMATE</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; -webkit-touch-callout: none; }

```
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1a 100%);
  color: #eee;
  padding: 1rem;
  min-height: 100vh;
}

.container { max-width: 1200px; margin: 0 auto; }

header {
  text-align: center;
  margin-bottom: 2rem;
  animation: glow 3s infinite;
}

h1 {
  font-size: 2.5rem;
  background: linear-gradient(135deg, #0af, #0cf);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 1rem;
  letter-spacing: 2px;
}

.stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;
}

.stat-box {
  background: linear-gradient(135deg, rgba(26,26,26,0.9) 0%, rgba(30,15,30,0.9) 100%);
  padding: 1rem;
  border-radius: 10px;
  border: 2px solid rgba(0,170,255,0.2);
  text-align: center;
  transition: all 0.3s;
}

.stat-box:hover {
  border-color: rgba(0,170,255,0.4);
  transform: translateY(-2px);
}

.stat-label { font-size: 0.9rem; color: #aaa; text-transform: uppercase; }
.stat-value { font-size: 1.5rem; color: #0f0; font-weight: bold; margin-top: 0.5rem; }

.tab-nav {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 2rem;
  flex-wrap: wrap;
  background: rgba(0,0,0,0.5);
  padding: 1rem;
  border-radius: 10px;
  border: 2px solid rgba(0,170,255,0.2);
}

.tab-btn {
  padding: 0.7rem 1.2rem;
  background: rgba(51,51,51,0.8);
  color: #aaa;
  border: 2px solid transparent;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s;
  font-weight: bold;
}

.tab-btn:hover { background: rgba(51,51,51,0.9); color: #0af; }
.tab-btn.active { background: linear-gradient(135deg, #0af 0%, #08d 100%); color: #fff; border-color: #0af; }

.tab-content { display: none; }
.tab-content.active { display: block; }

.card {
  background: linear-gradient(135deg, rgba(26,26,26,0.9) 0%, rgba(30,15,30,0.9) 100%);
  padding: 1.5rem;
  border-radius: 12px;
  border: 2px solid rgba(0,170,255,0.2);
  margin-bottom: 1.5rem;
  transition: all 0.3s;
}

.card:hover { border-color: rgba(0,170,255,0.4); }

.card h2 {
  color: #0cf;
  border-bottom: 3px solid rgba(0,170,255,0.3);
  padding-bottom: 0.8rem;
  margin-bottom: 1rem;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.click-btn {
  width: 100%;
  max-width: 300px;
  padding: 2rem;
  font-size: 1.5rem;
  background: linear-gradient(135deg, #0af 0%, #08d 100%);
  color: #fff;
  border: none;
  border-radius: 15px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s;
  box-shadow: 0 10px 40px rgba(0,170,255,0.3);
  margin: 1rem auto;
  display: block;
}

.click-btn:hover { transform: scale(1.05); box-shadow: 0 15px 50px rgba(0,170,255,0.5); }
.click-btn:active { transform: scale(0.95); }

.item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.8rem;
  margin: 0.5rem 0;
  background: rgba(34,34,34,0.7);
  border-radius: 8px;
  border-left: 4px solid #0af;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.item button {
  padding: 0.5rem 1rem;
  background: linear-gradient(135deg, #0af 0%, #08d 100%);
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s;
  font-weight: bold;
}

.item button:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0,170,255,0.3); }
.item button:disabled { opacity: 0.5; cursor: not-allowed; }

.price { color: #ffa; font-weight: bold; }
.count { color: #0f0; font-weight: bold; font-size: 1.1rem; }

.log {
  background: rgba(0,0,0,0.8);
  border-left: 5px solid #0af;
  padding: 1rem;
  border-radius: 8px;
  max-height: 150px;
  overflow-y: auto;
  margin: 1rem 0;
}

.log-message {
  padding: 0.4rem 0;
  font-size: 0.9rem;
  animation: slideIn 0.3s;
}

.log-success { color: #0f0; }
.log-event { color: #ffa; }
.log-unlock { color: #0af; }

@keyframes glow { 0%, 100% { text-shadow: 0 0 10px rgba(0,170,255,0.5); } 50% { text-shadow: 0 0 20px rgba(0,170,255,0.8); } }
@keyframes slideIn { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }

canvas {
  border: 2px solid #0af;
  border-radius: 8px;
  background: #111;
  max-width: 100%;
  margin: 1rem 0;
}

h3 {
  color: #0cf;
  margin-top: 1.5rem;
  margin-bottom: 0.5rem;
}

#tutorialModal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.95);
  z-index: 9999;
  overflow-y: auto;
  padding: 2rem;
}

.tutorial-box {
  max-width: 900px;
  margin: 0 auto;
  background: linear-gradient(135deg, rgba(26,26,26,0.95) 0%, rgba(30,15,30,0.95) 100%);
  border: 3px solid #0af;
  border-radius: 15px;
  padding: 2rem;
  color: #eee;
}

.tutorial-box h1 {
  color: #0cf;
  text-align: center;
  font-size: 2.5rem;
  margin-bottom: 1.5rem;
  background: none;
  -webkit-text-fill-color: unset;
}

#tutorialContent {
  font-size: 1.1rem;
  line-height: 1.8;
  color: #ddd;
  min-height: 400px;
}

#tutorialContent h2 {
  color: #0af;
  margin: 0.5rem 0;
  font-size: 1.5rem;
}

#tutorialContent p {
  margin: 1rem 0;
}

.tutorial-buttons {
  display: flex;
  gap: 1rem;
  justify-content: center;
  margin-top: 2rem;
}

.tutorial-buttons button {
  padding: 0.8rem 2rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  font-size: 1rem;
  transition: all 0.3s;
}

.tutorial-buttons button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(0,170,255,0.3);
}

.btn-prev, .btn-next {
  background: linear-gradient(135deg, #0af 0%, #08d 100%);
  color: #fff;
}

.btn-close {
  background: linear-gradient(135deg, #0f0 0%, #0a0 100%);
  color: #000;
}

.tutorial-page-counter {
  text-align: center;
  margin-top: 1rem;
  color: #aaa;
  font-size: 0.9rem;
}
```

  </style>
</head>
<body>

<div class="container">
  <header>
    <h1>ğŸ’ INCREMENTAL TRADE ULTIMATE ğŸ’</h1>
    <p>Le jeu d'argent le plus addictif!</p>
    <button onclick="showTutorial()" style="margin-top: 1rem; padding: 0.6rem 1.5rem; background: linear-gradient(135deg, #0af 0%, #08d 100%); color: #fff; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1rem;">ğŸ“– TUTORIEL</button>
  </header>

  <div class="stats">
    <div class="stat-box">
      <div class="stat-label">ğŸ’° PiÃ¨ces</div>
      <div class="stat-value" id="coins">0</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">âš¡ /sec</div>
      <div class="stat-value" id="cps">0</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">â­ Ã‰toiles</div>
      <div class="stat-value" id="stars">0</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">ğŸŒ€ Galaxies</div>
      <div class="stat-value" id="galaxies">0</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">âš¡ Prestige</div>
      <div class="stat-value" id="prestige">0</div>
    </div>
    <div class="stat-box">
      <div class="stat-label">ğŸŒ™ Dark Matter</div>
      <div class="stat-value" id="darkMatter">0</div>
    </div>
  </div>

  <div class="tab-nav">
    <button class="tab-btn active" onclick="switchTab(event, 'main')">ğŸ® JEU</button>
    <button class="tab-btn" onclick="switchTab(event, 'generators')">ğŸ¤– GÃ‰NÃ‰RATEURS</button>
    <button class="tab-btn" onclick="switchTab(event, 'upgrades')">âš¡ UPGRADES</button>
    <button class="tab-btn" onclick="switchTab(event, 'features')">âœ¨ FEATURES</button>
    <button class="tab-btn" onclick="switchTab(event, 'stats')">ğŸ“Š STATS</button>
  </div>

  <div id="main" class="tab-content active">
    <div class="card" style="text-align: center;">
      <button class="click-btn" onclick="clickBtn()">ğŸ–±ï¸ CLIQUER</button>
      <div style="color: #aaa; margin-top: 1rem;">Gain par clic: <span class="count" id="clickValue">0</span></div>
    </div>

```
<div class="card">
  <h2>â±ï¸ PRESTIGE</h2>
  <div style="text-align: center; padding: 1rem;">
    <div style="font-size: 1.2rem; color: #0af; margin-bottom: 1rem;">Progression: <span id="prestigeProgress">0</span> / 5000</div>
    <button class="click-btn" onclick="doPrestige()">âš¡ PRESTIGE (gain â­ +10% par prestige!)</button>
  </div>
</div>

<div class="card">
  <h2>ğŸŒ€ SUPER PRESTIGE (Galaxies)</h2>
  <div style="text-align: center; padding: 1rem;">
    <div style="font-size: 1.2rem; color: #a0f; margin-bottom: 1rem;">CoÃ»t: <span class="count" id="galaxyCost">100</span> â­</div>
    <button class="click-btn" onclick="doSuperPrestige()">ğŸŒ€ SUPER PRESTIGE (gain multiplicateur Ã—1.6)</button>
  </div>
</div>

<div class="log" id="log"></div>
```

  </div>

  <div id="generators" class="tab-content">
    <div class="card">
      <h2>ğŸ¤– GÃ‰NÃ‰RATEURS AUTOMATIQUES</h2>
      <div id="gensList"></div>
    </div>
  </div>

  <div id="upgrades" class="tab-content">
    <div class="card">
      <h2>âš¡ AMÃ‰LIORATIONS</h2>
      <div id="upgradesList"></div>
    </div>
  </div>

  <div id="features" class="tab-content">
    <div class="card">
      <h2>âœ¨ FONCTIONNALITÃ‰S SPÃ‰CIALES</h2>

```
  <h3>ğŸ¯ QUÃŠTES QUOTIDIENNES</h3>
  <div id="questsList"></div>

  <h3>â° BOOSTS TEMPORAIRES</h3>
  <button onclick="buyBoost('prod')" style="margin: 0.5rem; padding: 0.5rem 1rem; background: #0af; color: #fff; border: none; border-radius: 6px; cursor: pointer;">â° Prod Ã—2 (30s) - 50K</button>
  <button onclick="buyBoost('click')" style="margin: 0.5rem; padding: 0.5rem 1rem; background: #0af; color: #fff; border: none; border-radius: 6px; cursor: pointer;">â° Click Ã—2 (30s) - 30K</button>
  <div id="activeBoosts" style="margin-top: 1rem;"></div>

  <h3>ğŸ® MODE SPEEDRUN</h3>
  <button onclick="startSpeedrun()" style="padding: 0.7rem 1.2rem; background: linear-gradient(135deg, #0f0 0%, #0a0 100%); color: #fff; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">â±ï¸ Lancer Speedrun</button>
  <button onclick="completeSpeedrun()" style="padding: 0.7rem 1.2rem; background: linear-gradient(135deg, #f0a 0%, #c08 100%); color: #fff; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin-left: 0.5rem;">ğŸ Terminer Speedrun</button>
  <div style="margin-top: 0.5rem; color: #ffa;" id="speedrunStatus"></div>

  <h3>ğŸŒ™ DARK MATTER BONUSES</h3>
  <div id="darkMatterInfo" style="color: #a0f;"></div>

  <h3>ğŸª FUSIONS</h3>
  <div id="fusionsList"></div>

  <h3>ğŸ“Š GRAPHIQUE</h3>
  <canvas id="graph" width="800" height="300"></canvas>

  <h3>âš™ï¸ SYNERGIES</h3>
  <div id="synergiesList" style="color: #0f0;"></div>
</div>
```

  </div>

  <div id="stats" class="tab-content">
    <div class="card">
      <h2>ğŸ“ˆ STATISTIQUES</h2>
      <div class="item" style="border-left: 4px solid #ffa;">
        <span>Total PiÃ¨ces GagnÃ©es</span>
        <span class="count" id="totalCoins">0</span>
      </div>
      <div class="item" style="border-left: 4px solid #ffa;">
        <span>Total Clics</span>
        <span class="count" id="totalClicks">0</span>
      </div>
      <div class="item" style="border-left: 4px solid #ffa;">
        <span>Temps de Jeu</span>
        <span class="count" id="playTime">0s</span>
      </div>
      <div class="item" style="border-left: 4px solid #ffa;">
        <span>Ã‰vÃ©nements AlÃ©atoires</span>
        <span class="count" id="eventCount">0</span>
      </div>
    </div>
  </div>
</div>

<div id="tutorialModal" style="display: none;">
  <div class="tutorial-box">
    <h1>ğŸ“– TUTORIEL COMPLET</h1>
    <div id="tutorialContent"></div>
    <div class="tutorial-buttons">
      <button class="btn-prev" onclick="prevTutorial()">â† PRÃ‰CÃ‰DENT</button>
      <button class="btn-close" onclick="closeTutorial()">âœ“ FERMER</button>
      <button class="btn-next" onclick="nextTutorial()">SUIVANT â†’</button>
    </div>
    <div class="tutorial-page-counter">
      Page <span id="tutorialPage">1</span> / <span id="tutorialTotal">10</span>
    </div>
  </div>
</div>

<script>
const FPS = 10;
const SAVE_KEY = "incremental_trade_v2";

let currentTutorialPage = 0;

const TUTORIAL_PAGES = [
  { title: "Bienvenue dans Incremental Trade Ultimate!", content: "Ce jeu est un jeu inactif addictif oÃ¹ tu gagnes de l'argent en cliquant et grÃ¢ce Ã  des gÃ©nÃ©rateurs automatiques. Le but est de progresser indÃ©finiment avec un systÃ¨me de Prestige qui te rÃ©compense pour ton grind. PrÃªt Ã  devenir riche? Clique sur SUIVANT pour commencer!" },
  { title: "Le Clic - Ton Arme de Base", content: "Au dÃ©part, tu cliques sur le gros bouton CLIQUER. Chaque clic te donne 1 piÃ¨ce (au dÃ©part). Plus tu achÃ¨tes d'upgrades, plus chaque clic donne de piÃ¨ces! Le gain par clic augmente aussi avec tes Ã‰toiles et Galaxies." },
  { title: "Les GÃ©nÃ©rateurs - Ton Ã‰quipe", content: "Les gÃ©nÃ©rateurs gagnent de l'argent AUTOMATIQUEMENT mÃªme quand tu ne cliques pas!<br><br>ğŸ¤– Robot: CoÃ»te 15 â†’ Produit 0.5/sec<br>ğŸ­ Usine: CoÃ»te 100 â†’ Produit 0.8/sec<br>ğŸš¢ Port: CoÃ»te 1,100 â†’ Produit 2/sec<br>ğŸ”¬ Labo: CoÃ»te 12,000 â†’ Produit 8/sec<br>ğŸ›°ï¸ Satellite: CoÃ»te 130,000 â†’ Produit 50/sec<br><br>Chaque achat augmente le coÃ»t du prochain (Ã—1.15 Ã  chaque fois)" },
  { title: "Les Upgrades - Les AmÃ©liorations", content: "Les upgrades augmentent ta production! Tu les achÃ¨tes UNE SEULE FOIS par Prestige.<br><br>Exemples:<br>â€¢ Clic +50% - 100ğŸ’° - Chaque clic Ã—1.5<br>â€¢ Robot Ã—2 - 500ğŸ’° - Les Robots produisent Ã—2<br>â€¢ Robot Ã—3 - 5,000ğŸ’° - Les Robots produisent Ã—3<br>â€¢ Usine Ã—3 - 50,000ğŸ’°<br>+ 4 autres pour Port, Labo, Satellite<br><br>Les upgrades se rÃ©initialisent aprÃ¨s Prestige, donc tu les rachÃ¨teras Ã  chaque run!" },
  { title: "Prestige - Le Moteur du Jeu", content: "Quand tu as 5,000 de progression, tu peux faire un Prestige!<br><br>âš ï¸ ATTENTION: Le Prestige RÃ‰INITIALISE TOUT (0 piÃ¨ces, 0 gÃ©nÃ©rateurs, 0 upgrades)<br><br>Mais tu reÃ§ois des â­ Ã‰toiles permanentes! Les Ã©toiles NE se rÃ©initialisent PAS aprÃ¨s Prestige!<br><br>Chaque Ã‰toile = Ã—1.25 sur les clics ET la production<br>Exemple: 10 Ã‰toiles = Ã—1.25^10 = Ã—9.3 multiplicateur total!<br><br>Les Prestiges deviennent plus rentables (+10% par prestige jusqu'Ã  Ã—2)" },
  { title: "Super Prestige - Galaxies", content: "Les Galaxies sont encore PLUS puissants que les Ã©toiles!<br><br>CoÃ»ts des Galaxies:<br>â€¢ 1Ã¨re Galaxie: 100â­<br>â€¢ 2e Galaxie: 1,000â­ (Ã—10)<br>â€¢ 3e Galaxie: 10,000â­ (Ã—10)<br><br>Ã‡a coÃ»te BEAUCOUP de grind!<br><br>Bonus de chaque Galaxie: Ã—1.6 sur TOUT<br>Exemple: 2 Galaxies = 1.6 Ã— 1.6 = 2.56Ã— multiplicateur!<br><br>Les Galaxies restent permanentes! (jamais de reset)" },
  { title: "QuÃªtes & Boosts - Features AvancÃ©es", content: "ğŸ¯ QUÃŠTES (Prestige 5 + 30â­ + 1ğŸŒ€):<br>â€¢ Q1: Gagne 1M piÃ¨ces â†’ RÃ©compense: 500â­!<br>â€¢ Q2: 5 gÃ©nÃ©rateurs â†’ RÃ©compense: 50KğŸ’° piÃ¨ces<br>â€¢ Q3: Prestige 3x â†’ RÃ©compense: 1ğŸŒ€ Galaxie GRATUITE!<br><br>â° BOOSTS TEMPORAIRES (Prestige 3 + 15â­):<br>â€¢ Prod Ã—2 - 50KğŸ’° - Dure 30 sec<br>â€¢ Click Ã—2 - 30KğŸ’° - Dure 30 sec<br><br>StratÃ©gie: Active un boost Production quand tu as plein de piÃ¨ces pour farmer 30 sec!" },
  { title: "Synergies - Les Combinaisons SecrÃ¨tes", content: "Les synergies se dÃ©clenchent automatiquement! (Prestige 5 + 30â­ + 1ğŸŒ€)<br><br>1ï¸âƒ£ Robot + Usine (5+ Robots & 3+ Usines) â†’ Production +30% (Ã—1.3)<br><br>2ï¸âƒ£ Port + Satellite (3+ Ports & 2+ Satellites) â†’ Production +40% (Ã—1.4)<br><br>3ï¸âƒ£ Labo + Usine (2+ Labos & 5+ Usines) â†’ Clics +50% (Ã—1.5)<br><br>4ï¸âƒ£ MEGA SYNERGIE (30+ gÃ©nÃ©rateurs & Prestige 10+) â†’ TOUT Ã—2!! ğŸ”¥<br><br>Les multiplicateurs stackent! 1.3 Ã— 1.4 Ã— 1.5 = 2.73Ã— multiplicateur total!" },
  { title: "Dark Matter - L'Endgame", content: "Dark Matter est le summum! (Prestige 20 + 150â­ + 10ğŸŒ€)<br><br>Comment obtenir du Dark Matter?<br>â€¢ DÃ©bloquÃ© Ã  Prestige 20<br>â€¢ Tu reÃ§ois +1 Dark Matter tous les 10 Prestiges aprÃ¨s P20<br>â€¢ Prestige 30 = +1 DM (total: 1)<br>â€¢ Prestige 40 = +1 DM (total: 2)<br>â€¢ Prestige 50 = +1 DM (total: 3)<br><br>Bonus du Dark Matter: Chaque DM = +5% sur TOUT!<br>â€¢ 1 DM = Ã—1.05 (+5%)<br>â€¢ 10 DM = Ã—1.50 (+50%!)<br>â€¢ 20 DM = Ã—2.00 (+100%!! Double tout!)" },
  { title: "RÃ©sumÃ© & Conseils de Pro", content: "PROGRESSION:<br>Phase 1 (P0-2): Clic & Robot/Usine â†’ 1er Prestige = 1â­<br>Phase 2 (P2-5): DÃ©bloque Boosts & QuÃªtes â†’ 30â­ â†’ 1Ã¨re Galaxie<br>Phase 3 (P5-8): Exploit Synergies â†’ DÃ©bloque Fusions<br>Phase 4 (P8-20): Accumule gÃ©nÃ©rateurs â†’ Grind vers P20<br>Phase 5 (P20+): Optimize Dark Matter gains â†’ Infinite grind!<br><br>ğŸ’ CONSEILS PRO:<br>âœ… Fais toutes les QuÃªtes (surtout Q3!)<br>âœ… AchÃ¨te les Upgrades en prioritÃ©<br>âœ… Vise les Synergies (multiplicateurs gratuits!)<br>âœ… Farm avec Boosts la nuit<br>âœ… Prestige rÃ©guliÃ¨rement<br><br>ğŸš€ T'es prÃªt? Lance le jeu et deviens riche! Good luck chef!" }
];

let game = {
  coins: 0,
  totalCoins: 0,
  totalClicks: 0,
  stars: 0,
  galaxies: 0,
  prestigeCount: 0,
  prestigeProgress: 0,
  darkMatter: 0,
  playTime: 0,
  eventCount: 0,
  speedrunActive: false,
  speedrunStart: 0,
  speedrunTime: null,
  generators: [
    {id: "robot", name: "Robot", base: 0.5, count: 0, price: 15, mult: 1.15},
    {id: "usine", name: "Usine", base: 0.8, count: 0, price: 100, mult: 1.15},
    {id: "port", name: "Port", base: 2, count: 0, price: 1100, mult: 1.15},
    {id: "labo", name: "Laboratoire", base: 8, count: 0, price: 12000, mult: 1.15},
    {id: "satellite", name: "Satellite", base: 50, count: 0, price: 130000, mult: 1.15},
  ],
  upgrades: [
    {id: "click1", name: "Clic +50%", price: 100, effect: 1.5, bought: false, type: "click"},
    {id: "robot1", name: "Robot Ã—2", price: 500, effect: 2, bought: false, type: "robot"},
    {id: "usine1", name: "Usine Ã—2", price: 5000, effect: 2, bought: false, type: "usine"},
    {id: "robot2", name: "Robot Ã—3", price: 5000, effect: 3, bought: false, type: "robot"},
    {id: "usine2", name: "Usine Ã—3", price: 50000, effect: 3, bought: false, type: "usine"},
    {id: "port1", name: "Port Ã—2", price: 50000, effect: 2, bought: false, type: "port"},
    {id: "labo1", name: "Labo Ã—2", price: 500000, effect: 2, bought: false, type: "labo"},
    {id: "sat1", name: "Satellite Ã—2", price: 5000000, effect: 2, bought: false, type: "satellite"},
  ],
  quests: [
    {id: "q1", name: "Gagne 1M piÃ¨ces", check: () => game.totalCoins >= 1000000, reward: 500, rewardType: "stars", done: false},
    {id: "q2", name: "5 gÃ©nÃ©rateurs", check: () => game.generators.reduce((a,g) => a+g.count, 0) >= 5, reward: 50000, rewardType: "coins", done: false},
    {id: "q3", name: "Prestige 3x", check: () => game.prestigeCount >= 3, reward: 1, rewardType: "galaxy", done: false},
  ],
  boosts: [],
  fusions: [],
  graphData: {prod: [], time: []},
  logs: [],
  unlockedFeatures: {boosts: false, quests: false, speedrun: false, graph: false, synergies: false, fusions: false, darkMatter: false, events: false},
};

function $(id) { return document.getElementById(id); }
function formatNum(n) { if (n >= 1e9) return (n / 1e9).toFixed(1) + "B"; if (n >= 1e6) return (n / 1e6).toFixed(1) + "M"; if (n >= 1e3) return (n / 1e3).toFixed(1) + "K"; return Math.round(n).toString(); }
function log(msg, type = "event") { game.logs.unshift({msg, type}); if (game.logs.length > 20) game.logs.pop(); updateLog(); }
function save() { localStorage.setItem(SAVE_KEY, JSON.stringify(game)); }
function load() { let d = localStorage.getItem(SAVE_KEY); if (d) game = JSON.parse(d); }
function switchTab(e, name) { e.preventDefault(); document.querySelectorAll(".tab-content").forEach(t => t.classList.remove("active")); document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active")); $(name).classList.add("active"); e.target.classList.add("active"); }

function showTutorial() { $("tutorialModal").style.display = "block"; currentTutorialPage = 0; displayTutorialPage(); }
function closeTutorial() { $("tutorialModal").style.display = "none"; }
function nextTutorial() { if (currentTutorialPage < TUTORIAL_PAGES.length - 1) { currentTutorialPage++; displayTutorialPage(); } }
function prevTutorial() { if (currentTutorialPage > 0) { currentTutorialPage--; displayTutorialPage(); } }
function displayTutorialPage() { let page = TUTORIAL_PAGES[currentTutorialPage]; $("tutorialContent").innerHTML = "<h2>" + page.title + "</h2><p>" + page.content + "</p>"; $("tutorialPage").textContent = currentTutorialPage + 1; $("tutorialTotal").textContent = TUTORIAL_PAGES.length; }

function checkUnlocks() {
  if (game.prestigeCount >= 1 && game.stars >= 5 && !game.unlockedFeatures.events) { game.unlockedFeatures.events = true; log("ğŸ² Ã‰VÃ‰NEMENTS ALÃ‰ATOIRES dÃ©bloquÃ©s!", "unlock"); }
  if (game.prestigeCount >= 3 && game.stars >= 15 && !game.unlockedFeatures.boosts) { game.unlockedFeatures.boosts = true; log("â° BOOSTS TEMPORAIRES dÃ©bloquÃ©s!", "unlock"); }
  if (game.prestigeCount >= 3 && game.stars >= 15 && !game.unlockedFeatures.graph) { game.unlockedFeatures.graph = true; log("ğŸ“Š GRAPHIQUE DE PROGRESSION dÃ©bloquÃ©!", "unlock"); }
  if (game.prestigeCount >= 5 && game.stars >= 30 && game.galaxies >= 1 && !game.unlockedFeatures.quests) { game.unlockedFeatures.quests = true; log("ğŸ¯ QUÃŠTES QUOTIDIENNES dÃ©bloquÃ©es!", "unlock"); }
  if (game.prestigeCount >= 5 && game.stars >= 30 && game.galaxies >= 1 && !game.unlockedFeatures.speedrun) { game.unlockedFeatures.speedrun = true; log("ğŸ® MODE SPEEDRUN dÃ©bloquÃ©!", "unlock"); }
  if (game.prestigeCount >= 5 && game.stars >= 30 && game.galaxies >= 1 && !game.unlockedFeatures.synergies) { game.unlockedFeatures.synergies = true; log("âš™ï¸ SYNERGIES GÃ‰NÃ‰RATEURS dÃ©bloquÃ©es!", "unlock"); }
  if (game.prestigeCount >= 8 && game.stars >= 50 && game.galaxies >= 2 && !game.unlockedFeatures.fusions) { game.unlockedFeatures.fusions = true; log("ğŸª FUSIONS DE GÃ‰NÃ‰RATEURS dÃ©bloquÃ©es!", "unlock"); }
  if (game.prestigeCount >= 20 && game.stars >= 150 && game.galaxies >= 10 && !game.unlockedFeatures.darkMatter) { game.unlockedFeatures.darkMatter = true; log("ğŸŒ™ DARK MATTER dÃ©bloquÃ©! (TRÃˆS RARE!)", "unlock"); }
}

function clickVal() { let val = 1; for (let u of game.upgrades) { if (u.type === "click" && u.bought) val *= u.effect; } let labo = game.generators.find(g => g.id === "labo"); let usine = game.generators.find(g => g.id === "usine"); if (labo && usine && labo.count >= 2 && usine.count >= 5) val *= 1.5; val *= Math.pow(1.25, game.stars) * Math.pow(1.6, game.galaxies); val *= (1 + (game.darkMatter * 0.05)); return val * getBoostMult("click"); }
function clickBtn() { let val = clickVal(); game.coins += val; game.totalCoins += val; game.totalClicks++; game.prestigeProgress += val; updateUI(); }

function cps() { let total = 0; let syn = 1; let robot = game.generators.find(g => g.id === "robot"); let usine = game.generators.find(g => g.id === "usine"); let port = game.generators.find(g => g.id === "port"); let labo = game.generators.find(g => g.id === "labo"); let satellite = game.generators.find(g => g.id === "satellite"); if (robot && usine && robot.count >= 5 && usine.count >= 3) syn *= 1.3; if (port && satellite && port.count >= 3 && satellite.count >= 2) syn *= 1.4; if (labo && usine && labo.count >= 2 && usine.count >= 5) syn *= 1.2; let totalGens = [robot, usine, port, labo, satellite].reduce((a,g) => a + (g ? g.count : 0), 0); if (totalGens >= 30 && game.prestigeCount >= 10) syn *= 2; for (let g of game.generators) { let eff = 1; for (let u of game.upgrades) { if (u.type === g.id && u.bought) eff *= u.effect; } total += g.count * g.base * eff * syn; } total *= Math.pow(1.25, game.stars) * Math.pow(1.6, game.galaxies); total *= (1 + (game.darkMatter * 0.05)); return total * getBoostMult("prod"); }

function buyGen(id) { let g = game.generators.find(x => x.id === id); if (!g) return; let cost = g.price * Math.pow(g.mult, g.count); if (game.coins < cost) return; game.coins -= cost; g.count++; save(); updateUI(); }
function buyUp(id) { let u = game.upgrades.find(x => x.id === id); if (!u || u.bought || game.coins < u.price) return; game.coins -= u.price; u.bought = true; log("âœ… " + u.name, "success"); save(); updateUI(); }

function doPrestige() { if (game.prestigeProgress < 5000) return; let gain = Math.floor(game.prestigeProgress / 5000); let mastery = Math.min(2, 1 + (game.prestigeCount * 0.1)); gain = Math.floor(gain * mastery); game.coins = 0; game.prestigeProgress = 0; game.stars += gain; game.prestigeCount++; if (game.prestigeCount >= 20 && game.prestigeCount % 10 === 0) { game.darkMatter++; log("ğŸŒ™ +1 DARK MATTER!", "unlock"); } for (let g of game.generators) g.count = 0; for (let u of game.upgrades) u.bought = false; log("â­ +" + gain + " Ã©toiles! (Ã—" + mastery.toFixed(2) + ")", "success"); checkUnlocks(); save(); updateUI(); }
function doSuperPrestige() { let cost = game.galaxies === 0 ? 100 : 100 * Math.pow(10, game.galaxies); if (game.stars < cost) return; game.stars -= cost; game.galaxies++; log("ğŸŒ€ +1 GALAXIE!", "unlock"); checkUnlocks(); save(); updateUI(); }

function buyBoost(type) { if (!game.unlockedFeatures.boosts) { log("âŒ Boosts pas encore dÃ©bloquÃ©s!", "event"); return; } let costs = {prod: 50000, click: 30000}; let mults = {prod: 2, click: 2}; if (game.coins < costs[type]) return; game.coins -= costs[type]; game.boosts.push({type, mult: mults[type], end: Date.now() + 30000}); log("â° Boost " + type, "event"); save(); updateUI(); }
function getBoostMult(type) { game.boosts = game.boosts.filter(b => Date.now() < b.end); let m = 1; for (let b of game.boosts) if (b.type === type) m *= b.mult; return m; }

function checkQuests() { for (let q of game.quests) { if (!q.done && q.check()) { q.done = true; if (q.rewardType === "stars") { game.stars += q.reward; log("ğŸ¯ " + q.name + " - â­ +" + q.reward + " Ã©toiles!", "success"); } else if (q.rewardType === "coins") { game.coins += q.reward; log("ğŸ¯ " + q.name + " - ğŸ’° +" + formatNum(q.reward) + " piÃ¨ces!", "success"); } else if (q.rewardType === "galaxy") { game.galaxies += q.reward; log("ğŸ¯ " + q.name + " - ğŸŒ€ +" + q.reward + " galaxie!", "success"); checkUnlocks(); } save(); } } }

function startSpeedrun() { if (!game.unlockedFeatures.speedrun) { log("âŒ Speedrun pas encore dÃ©bloquÃ©!", "event"); return; } if (game.speedrunActive) { log("âš ï¸ Speedrun dÃ©jÃ  en cours!", "event"); return; } game.speedrunActive = true; game.speedrunStart = Date.now(); log("â±ï¸ SPEEDRUN LANCÃ‰!", "event"); updateUI(); }
function completeSpeedrun() { if (!game.speedrunActive) { log("âŒ Aucun speedrun en cours!", "event"); return; } game.speedrunTime = (Date.now() - game.speedrunStart) / 1000; game.speedrunActive = false; log("ğŸ† SPEEDRUN TERMINÃ‰: " + game.speedrunTime.toFixed(2) + "sec!", "success"); save(); updateUI(); }

function updateGraphData() { game.graphData.time.push(Date.now()); game.graphData.prod.push(cps()); if (game.graphData.time.length > 100) { game.graphData.time.shift(); game.graphData.prod.shift(); } }
function drawGraph() { let canvas = $("graph"); if (!canvas || game.graphData.prod.length < 2) return; let ctx = canvas.getContext("2d"); ctx.fillStyle = "#0a0a0a"; ctx.fillRect(0, 0, canvas.width, canvas.height); let max = Math.max(...game.graphData.prod); if (max === 0) max = 1; ctx.strokeStyle = "#0af"; ctx.lineWidth = 2; ctx.beginPath(); for (let i = 0; i < game.graphData.prod.length; i++) { let x = (i / game.graphData.prod.length) * canvas.width; let y = canvas.height - (game.graphData.prod[i] / max) * canvas.height * 0.9; if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y); } ctx.stroke(); }

function getFusions() { let fusions = []; let totalGen = game.generators.reduce((a,g) => a+g.count, 0); if (totalGen >= 20 && game.prestigeCount >= 8) { fusions.push("Fusion MAJEURE activÃ©e: Ã—1.5 production globale!"); } return fusions; }
function getSynergies() { let synergies = []; let robot = game.generators.find(g => g.id === "robot"); let usine = game.generators.find(g => g.id === "usine"); let port = game.generators.find(g => g.id === "port"); let labo = game.generators.find(g => g.id === "labo"); let satellite = game.generators.find(g => g.id === "satellite"); if (robot && usine && robot.count >= 5 && usine.count >= 3) { synergies.push("Robot+Usine: Production +30%"); } if (port && satellite && port.count >= 3 && satellite.count >= 2) { synergies.push("Port+Satellite: Production +40%"); } if (labo && usine && labo.count >= 2 && usine.count >= 5) { synergies.push("Labo+Usine: Clics +50%"); } let totalGens = [robot, usine, port, labo, satellite].reduce((a,g) => a + (g ? g.count : 0), 0); if (totalGens >= 30 && game.prestigeCount >= 10) { synergies.push("MEGA SYNERGIE: Tout Ã—2!"); } return synergies; }

function updateLog() { let html = game.logs.map(l => "<div class='log-message log-" + l.type + "'>" + l.msg + "</div>").join(""); $("log").innerHTML = html; }

function updateUI() {
  $("coins").textContent = formatNum(game.coins);
  $("cps").textContent = formatNum(cps());
  $("stars").textContent = game.stars;
  $("galaxies").textContent = game.galaxies;
  $("prestige").textContent = game.prestigeCount;
  $("darkMatter").textContent = game.darkMatter;
  $("clickValue").textContent = formatNum(clickVal());
  $("prestigeProgress").textContent = Math.floor(game.prestigeProgress);
  $("galaxyCost").textContent = game.galaxies === 0 ? 100 : 100 * Math.pow(10, game.galaxies);
  $("totalCoins").textContent = formatNum(game.totalCoins);
  $("totalClicks").textContent = game.totalClicks;
  $("playTime").textContent = game.playTime + "s";
  $("eventCount").textContent = game.eventCount;
  
  let genHTML = game.generators.map(g => { let cost = g.price * Math.pow(g.mult, g.count); return "<div class='item'><div><strong>" + g.name + "</strong> <span class='count'>Ã—" + g.count + "</span></div><button onclick=\"buyGen('" + g.id + "')\" " + (game.coins < cost ? "disabled" : "") + ">" + formatNum(cost) + "</button></div>"; }).join("");
  $("gensList").innerHTML = genHTML;
  
  let upHTML = game.upgrades.filter(u => !u.bought).map(u => "<div class='item'><div><strong>" + u.name + "</strong> Ã—" + u.effect + "</div><button onclick=\"buyUp('" + u.id + "')\" " + (game.coins < u.price ? "disabled" : "") + ">" + formatNum(u.price) + "</button></div>").join("");
  $("upgradesList").innerHTML = upHTML || "Tous les upgrades achetÃ©s!";
  
  if (game.unlockedFeatures.quests) { let questHTML = game.quests.map(q => { let rewardIcon = q.rewardType === "stars" ? "â­" : (q.rewardType === "coins" ? "ğŸ’°" : "ğŸŒ€"); let rewardText = q.rewardType === "coins" ? formatNum(q.reward) : q.reward; return "<div class='item'><span>" + q.name + "</span><span style='color: #ffa; font-size: 0.9rem;'>RÃ©compense: " + rewardIcon + " " + rewardText + "</span><span style='color:" + (q.done ? "#0f0" : "#ffa") + "'>" + (q.done ? "âœ…" : "â³") + "</span></div>"; }).join(""); $("questsList").innerHTML = questHTML; } else { $("questsList").innerHTML = "<div style='color: #aaa;'>DÃ©bloquÃ© Ã : Prestige 5 + 30â­ + 1ğŸŒ€</div>"; }
  
  if (game.unlockedFeatures.boosts) { let boostHTML = game.boosts.filter(b => Date.now() < b.end).map(b => { let sec = Math.ceil((b.end - Date.now()) / 1000); return "<div class='item'><span>" + b.type + " Ã—" + b.mult + "</span><span>" + sec + "s</span></div>"; }).join(""); $("activeBoosts").innerHTML = boostHTML || "Aucun boost actif"; } else { $("activeBoosts").innerHTML = "<div style='color: #aaa;'>DÃ©bloquÃ© Ã : Prestige 3 + 15â­</div>"; }
  
  if (game.unlockedFeatures.speedrun) { $("speedrunStatus").innerHTML = game.speedrunActive ? "â±ï¸ EN COURS..." : (game.speedrunTime ? "ğŸ† " + game.speedrunTime.toFixed(2) + "sec" : "Aucun record"); } else { $("speedrunStatus").innerHTML = "DÃ©bloquÃ© Ã : Prestige 5 + 30â­ + 1ğŸŒ€"; }
  
  if (game.unlockedFeatures.fusions) { $("fusionsList").innerHTML = getFusions().map(f => "<div>" + f + "</div>").join("") || "Aucune fusion active"; } else { $("fusionsList").innerHTML = "<div style='color: #aaa;'>DÃ©bloquÃ© Ã : Prestige 8 + 50â­ + 2ğŸŒ€</div>"; }
  
  if (!game.unlockedFeatures.graph) { $("graph").style.display = "none"; } else { $("graph").style.display = "block"; drawGraph(); }
  
  if (game.unlockedFeatures.synergies) { $("synergiesList").innerHTML = getSynergies().map(s => "<div>âœ… " + s + "</div>").join("") || "Aucune synergy active"; } else { $("synergiesList").innerHTML = "DÃ©bloquÃ© Ã : Prestige 5 + 30â­ + 1ğŸŒ€"; }
  
  if (game.darkMatter > 0) { let darkMatterBonus = game.darkMatter * 5; $("darkMatterInfo").innerHTML = "Tu as <strong>" + game.darkMatter + "</strong> Dark Matter! Bonus: <strong>+" + darkMatterBonus + "%</strong> sur TOUT"; } else if (game.unlockedFeatures.darkMatter) { $("darkMatterInfo").innerHTML = "Accumule du Dark Matter en faisant des Prestiges (tous les 10 prestiges aprÃ¨s prestige 20)"; } else { $("darkMatterInfo").innerHTML = "DÃ©bloquÃ© Ã : Prestige 20 + 150â­ + 10ğŸŒ€"; }
  
  checkQuests();
  checkUnlocks();
  updateLog();
  save();
}

setInterval(() => { let gain = cps() / FPS; game.coins += gain; game.totalCoins += gain; game.prestigeProgress += gain; updateGraphData(); updateUI(); }, 1000 / FPS);
setInterval(() => { game.playTime++; if (Math.random() > 0.95 && game.unlockedFeatures.events) { game.eventCount++; game.coins += game.coins * 0.3; log("âœ¨ Ã‰vÃ©nement alÃ©atoire: +30% piÃ¨ces!", "event"); } updateUI(); }, 1000);

load();
updateUI();
log("Bienvenue dans Incremental Trade!", "unlock");

let hasSeenTutorial = localStorage.getItem("hasSeenTutorial");
if (!hasSeenTutorial) { showTutorial(); localStorage.setItem("hasSeenTutorial", "true"); }

// EmpÃªcher le zoom au double-clic sur mobile
let lastTouchEnd = 0;
document.addEventListener('touchend', function(event) {
  let now = Date.now();
  if (now - lastTouchEnd <= 300) {
    event.preventDefault();
  }
  lastTouchEnd = now;
}, false);
</script>

</body>
</html>