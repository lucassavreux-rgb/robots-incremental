<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Clicker Ultimate - Idle Game</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Orbitron', sans-serif;
            background: #000;
            color: white;
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 20% 50%, rgba(138, 43, 226, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 119, 182, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 20, 147, 0.2) 0%, transparent 50%);
            animation: bgShift 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes bgShift {
            0%, 100% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(180deg); }
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .header {
            background: rgba(0,0,0,0.8);
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #8a2be2;
            box-shadow: 0 5px 30px rgba(138, 43, 226, 0.5);
        }

        .title {
            font-size: 3em;
            font-weight: 900;
            background: linear-gradient(90deg, #ff1493, #8a2be2, #00bfff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(255, 20, 147, 0.5);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 500px 1fr;
            gap: 20px;
            padding: 30px 20px;
            max-width: 1800px;
            margin: 0 auto;
        }

        .clicker-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .currency-display {
            font-size: 2.5em;
            font-weight: 900;
            text-align: center;
            padding: 30px;
            background: rgba(138, 43, 226, 0.2);
            border: 3px solid #8a2be2;
            border-radius: 20px;
            box-shadow: 0 0 50px rgba(138, 43, 226, 0.3);
            min-width: 400px;
        }

        .currency-label {
            font-size: 0.4em;
            color: rgba(255,255,255,0.6);
            margin-bottom: 10px;
        }

        .currency-amount {
            color: #00bfff;
            text-shadow: 0 0 20px rgba(0, 191, 255, 0.8);
        }

        .per-second {
            font-size: 0.5em;
            color: #4ade80;
            margin-top: 10px;
        }

        .click-button {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, #8a2be2, #4b0082);
            border: 5px solid #ff1493;
            cursor: pointer;
            font-size: 8em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s;
            box-shadow: 0 0 80px rgba(138, 43, 226, 0.8);
            position: relative;
            user-select: none;
        }

        .click-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 100px rgba(255, 20, 147, 1);
        }

        .click-button:active {
            transform: scale(0.95);
        }

        .click-effect {
            position: absolute;
            font-size: 0.3em;
            font-weight: 900;
            color: #00bfff;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
            text-shadow: 0 0 10px rgba(0, 191, 255, 1);
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .section {
            background: rgba(138, 43, 226, 0.1);
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .section-title {
            font-size: 1.5em;
            font-weight: 900;
            margin-bottom: 15px;
            color: #ff1493;
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .building-item {
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
            transition: all 0.3s;
        }

        .building-item:hover {
            border-color: #8a2be2;
            transform: translateX(5px);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.5);
        }

        .building-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .building-name {
            font-weight: 700;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .building-count {
            background: rgba(138, 43, 226, 0.5);
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: 700;
        }

        .building-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9em;
            color: rgba(255,255,255,0.7);
        }

        .building-production {
            color: #4ade80;
            font-weight: 600;
        }

        .cost {
            color: #fbbf24;
            font-weight: 600;
        }

        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 900;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
        }

        .btn-buy {
            background: linear-gradient(135deg, #8a2be2, #ff1493);
            color: white;
            box-shadow: 0 5px 20px rgba(138, 43, 226, 0.5);
        }

        .btn-buy:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(255, 20, 147, 0.8);
        }

        .btn-buy:disabled {
            background: rgba(255,255,255,0.1);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-prestige {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: #000;
            font-size: 1.2em;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 10px 40px rgba(251, 191, 36, 0.6);
        }

        .btn-prestige:hover {
            box-shadow: 0 15px 50px rgba(251, 191, 36, 1);
        }

        .upgrade-item {
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(0, 191, 255, 0.3);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upgrade-item:hover {
            border-color: #00bfff;
            transform: scale(1.02);
        }

        .upgrade-item.purchased {
            border-color: #4ade80;
            background: rgba(74, 222, 128, 0.1);
            opacity: 0.6;
        }

        .upgrade-name {
            font-weight: 700;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .upgrade-desc {
            font-size: 0.85em;
            color: rgba(255,255,255,0.6);
            margin-bottom: 8px;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }

        .achievement {
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .achievement.unlocked {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.1);
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
        }

        .achievement-icon {
            font-size: 3em;
            margin-bottom: 8px;
            filter: grayscale(100%);
        }

        .achievement.unlocked .achievement-icon {
            filter: grayscale(0%);
            animation: bounce 0.5s;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .achievement-name {
            font-weight: 700;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .achievement-desc {
            font-size: 0.75em;
            color: rgba(255,255,255,0.5);
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            flex: 1;
            padding: 12px;
            background: rgba(138, 43, 226, 0.2);
            border: 2px solid rgba(138, 43, 226, 0.3);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s;
            font-family: 'Orbitron', sans-serif;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #8a2be2, #ff1493);
            border-color: #ff1493;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
        }

        .prestige-info {
            background: rgba(251, 191, 36, 0.1);
            border: 3px solid #fbbf24;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .prestige-currency {
            font-size: 2em;
            font-weight: 900;
            color: #fbbf24;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
        }

        .prestige-multiplier {
            font-size: 1.5em;
            color: #4ade80;
            margin-top: 10px;
        }

        .event-banner {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff1493, #8a2be2);
            padding: 20px 40px;
            border-radius: 15px;
            border: 3px solid #fff;
            box-shadow: 0 10px 50px rgba(255, 20, 147, 0.8);
            z-index: 1000;
            animation: slideDown 0.5s ease;
            text-align: center;
            max-width: 80%;
        }

        @keyframes slideDown {
            from {
                transform: translateX(-50%) translateY(-150px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        .event-title {
            font-size: 1.5em;
            font-weight: 900;
            margin-bottom: 10px;
        }

        .event-timer {
            font-size: 1.2em;
            color: #fbbf24;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-card {
            background: rgba(0,0,0,0.5);
            border: 2px solid rgba(138, 43, 226, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            color: rgba(255,255,255,0.6);
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: 900;
            color: #00bfff;
        }

        @media (max-width: 1400px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .click-button {
                width: 250px;
                height: 250px;
                font-size: 6em;
            }
        }

        .golden-cookie {
            position: fixed;
            width: 80px;
            height: 80px;
            font-size: 4em;
            cursor: pointer;
            animation: float 3s ease-in-out infinite, rotate 2s linear infinite;
            z-index: 999;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>

    <div class="header">
        <div class="title">üåå COSMIC CLICKER ULTIMATE üåå</div>
    </div>

    <div class="main-container">
        <!-- LEFT SIDEBAR: Buildings -->
        <div class="sidebar">
            <div class="section">
                <div class="section-title">üèóÔ∏è G√©n√©rateurs</div>
                <div id="buildingsList"></div>
            </div>
        </div>

        <!-- CENTER: Clicker -->
        <div class="clicker-section">
            <div class="currency-display">
                <div class="currency-label">√ânergie Cosmique</div>
                <div class="currency-amount" id="currencyDisplay">0</div>
                <div class="per-second" id="perSecDisplay">+0/s</div>
            </div>

            <div class="click-button" id="clickButton" onclick="handleClick()">
                üåü
            </div>

            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('upgrades')">‚¨ÜÔ∏è Am√©liorations</button>
                <button class="tab-btn" onclick="switchTab('prestige')">‚≠ê Prestige</button>
                <button class="tab-btn" onclick="switchTab('achievements')">üèÜ Succ√®s</button>
                <button class="tab-btn" onclick="switchTab('stats')">üìä Stats</button>
            </div>

            <div class="section" id="tabContent"></div>
        </div>

        <!-- RIGHT SIDEBAR: Dynamic Content -->
        <div class="sidebar">
            <div class="section">
                <div class="section-title">üí´ Multiplicateurs Actifs</div>
                <div id="multipliersList"></div>
            </div>

            <div class="section">
                <div class="section-title">üì∞ √âv√©nements</div>
                <div id="eventsList">Aucun √©v√©nement actif</div>
            </div>
        </div>
    </div>

    <script>
        // ==================== GAME STATE ====================
        const gameState = {
            energy: 0,
            totalEarned: 0,
            clickPower: 1,
            energyPerSecond: 0,
            buildings: {},
            upgrades: {},
            achievements: {},
            prestigePoints: 0,
            prestigeLevel: 0,
            totalClicks: 0,
            goldenCookiesClicked: 0,
            stats: {
                totalClicks: 0,
                totalGoldenClicks: 0,
                totalPrestige: 0,
                playTime: 0,
                buildingsBought: 0
            },
            currentTab: 'upgrades',
            activeEvent: null,
            eventTimeLeft: 0
        };

        // ==================== BUILDINGS ====================
        const buildingDefinitions = {
            cursor: {
                name: 'Curseur Cosmique',
                icon: 'üëÜ',
                baseCost: 15,
                baseProduction: 0.1,
                costMultiplier: 1.15,
                description: 'Clique automatiquement'
            },
            generator: {
                name: 'G√©n√©rateur Stellaire',
                icon: '‚ö°',
                baseCost: 100,
                baseProduction: 1,
                costMultiplier: 1.15,
                description: 'G√©n√®re de l\'√©nergie passive'
            },
            solar_panel: {
                name: 'Panneau Solaire',
                icon: '‚òÄÔ∏è',
                baseCost: 1100,
                baseProduction: 8,
                costMultiplier: 1.15,
                description: 'Capte l\'√©nergie des √©toiles'
            },
            quantum_reactor: {
                name: 'R√©acteur Quantique',
                icon: '‚öõÔ∏è',
                baseCost: 12000,
                baseProduction: 47,
                costMultiplier: 1.15,
                description: 'Exploite la physique quantique'
            },
            black_hole: {
                name: 'Trou Noir',
                icon: 'üï≥Ô∏è',
                baseCost: 130000,
                baseProduction: 260,
                costMultiplier: 1.15,
                description: 'Aspire l\'√©nergie de l\'univers'
            },
            nebula: {
                name: 'N√©buleuse',
                icon: 'üåå',
                baseCost: 1400000,
                baseProduction: 1400,
                costMultiplier: 1.15,
                description: 'Berceau d\'√©toiles'
            },
            galaxy: {
                name: 'Galaxie',
                icon: 'üåÄ',
                baseCost: 20000000,
                baseProduction: 7800,
                costMultiplier: 1.15,
                description: 'Une galaxie enti√®re travaille pour vous'
            },
            universe: {
                name: 'Univers Parall√®le',
                icon: 'üåê',
                baseCost: 330000000,
                baseProduction: 44000,
                costMultiplier: 1.15,
                description: 'Exploitez des univers entiers'
            },
            multiverse: {
                name: 'Multivers',
                icon: '‚ôæÔ∏è',
                baseCost: 5100000000,
                baseProduction: 260000,
                costMultiplier: 1.15,
                description: 'Des infinit√©s d\'univers'
            },
            god: {
                name: '√ätre Divin',
                icon: 'üëÅÔ∏è',
                baseCost: 75000000000,
                baseProduction: 1600000,
                costMultiplier: 1.15,
                description: 'Cr√©ateur de r√©alit√©s'
            }
        };

        // ==================== UPGRADES ====================
        const upgradeDefinitions = {
            // Click Power Upgrades
            click_1: {
                name: 'Doigts Renforc√©s',
                icon: 'üí™',
                description: 'Double la puissance de clic',
                cost: 100,
                effect: () => gameState.clickPower *= 2,
                category: 'click'
            },
            click_2: {
                name: 'Gants √ânerg√©tiques',
                icon: 'üß§',
                description: 'x4 puissance de clic',
                cost: 500,
                effect: () => gameState.clickPower *= 4,
                requires: ['click_1'],
                category: 'click'
            },
            click_3: {
                name: 'Main Cosmique',
                icon: '‚úã',
                description: 'x10 puissance de clic',
                cost: 10000,
                effect: () => gameState.clickPower *= 10,
                requires: ['click_2'],
                category: 'click'
            },
            click_4: {
                name: 'Poing Quantique',
                icon: 'üëä',
                description: 'x100 puissance de clic',
                cost: 1000000,
                effect: () => gameState.clickPower *= 100,
                requires: ['click_3'],
                category: 'click'
            },

            // Production Upgrades
            prod_1: {
                name: 'Efficacit√© I',
                icon: 'üìà',
                description: 'Production +50%',
                cost: 1000,
                effect: () => {},
                multiplier: 1.5,
                category: 'production'
            },
            prod_2: {
                name: 'Efficacit√© II',
                icon: 'üìà',
                description: 'Production +100%',
                cost: 50000,
                effect: () => {},
                multiplier: 2,
                requires: ['prod_1'],
                category: 'production'
            },
            prod_3: {
                name: 'Efficacit√© III',
                icon: 'üìà',
                description: 'Production x3',
                cost: 5000000,
                effect: () => {},
                multiplier: 3,
                requires: ['prod_2'],
                category: 'production'
            },

            // Building-specific
            cursor_upgrade_1: {
                name: 'Curseurs Rapides',
                icon: '‚ö°',
                description: 'Curseurs x2 plus rapides',
                cost: 100,
                buildingType: 'cursor',
                multiplier: 2,
                category: 'building'
            },
            generator_upgrade_1: {
                name: 'G√©n√©rateurs Surpuissants',
                icon: '‚ö°',
                description: 'G√©n√©rateurs x2',
                cost: 1000,
                buildingType: 'generator',
                multiplier: 2,
                category: 'building'
            },
            solar_upgrade_1: {
                name: 'Panneaux Optimis√©s',
                icon: '‚òÄÔ∏è',
                description: 'Panneaux Solaires x2',
                cost: 11000,
                buildingType: 'solar_panel',
                multiplier: 2,
                category: 'building'
            },

            // Special
            golden_touch: {
                name: 'Touche Dor√©e',
                icon: '‚ú®',
                description: 'Golden cookies apparaissent 2x plus souvent',
                cost: 10000,
                effect: () => {},
                category: 'special'
            },
            lucky_star: {
                name: '√âtoile Chanceuse',
                icon: '‚≠ê',
                description: 'Golden cookies donnent 2x plus',
                cost: 50000,
                effect: () => {},
                category: 'special'
            }
        };

        // ==================== ACHIEVEMENTS ====================
        const achievementDefinitions = {
            first_click: {
                name: 'Premier Clic',
                description: 'Cliquer pour la premi√®re fois',
                icon: 'üëÜ',
                condition: () => gameState.stats.totalClicks >= 1
            },
            clicker_100: {
                name: 'Clicker D√©butant',
                description: 'Cliquer 100 fois',
                icon: 'üñ±Ô∏è',
                condition: () => gameState.stats.totalClicks >= 100
            },
            clicker_1000: {
                name: 'Clicker Expert',
                description: 'Cliquer 1000 fois',
                icon: 'üñ±Ô∏è',
                condition: () => gameState.stats.totalClicks >= 1000
            },
            clicker_10000: {
                name: 'Clicker Master',
                description: 'Cliquer 10000 fois',
                icon: 'üñ±Ô∏è',
                condition: () => gameState.stats.totalClicks >= 10000
            },
            first_building: {
                name: 'Premier G√©n√©rateur',
                description: 'Acheter votre premier g√©n√©rateur',
                icon: 'üèóÔ∏è',
                condition: () => Object.values(gameState.buildings).some(b => b > 0)
            },
            builder_10: {
                name: 'Constructeur',
                description: 'Poss√©der 10 g√©n√©rateurs',
                icon: 'üèóÔ∏è',
                condition: () => Object.values(gameState.buildings).reduce((a,b) => a+b, 0) >= 10
            },
            builder_100: {
                name: 'Industriel',
                description: 'Poss√©der 100 g√©n√©rateurs',
                icon: 'üè≠',
                condition: () => Object.values(gameState.buildings).reduce((a,b) => a+b, 0) >= 100
            },
            builder_500: {
                name: 'Magnat Cosmique',
                description: 'Poss√©der 500 g√©n√©rateurs',
                icon: 'üëë',
                condition: () => Object.values(gameState.buildings).reduce((a,b) => a+b, 0) >= 500
            },
            energy_1000: {
                name: 'Collectionneur',
                description: 'Obtenir 1000 √©nergie',
                icon: '‚ö°',
                condition: () => gameState.totalEarned >= 1000
            },
            energy_1m: {
                name: 'Millionnaire',
                description: 'Obtenir 1 million d\'√©nergie',
                icon: 'üí∞',
                condition: () => gameState.totalEarned >= 1000000
            },
            energy_1b: {
                name: 'Milliardaire',
                description: 'Obtenir 1 milliard d\'√©nergie',
                icon: 'üíé',
                condition: () => gameState.totalEarned >= 1000000000
            },
            energy_1t: {
                name: 'Trillionnaire',
                description: 'Obtenir 1 trillion d\'√©nergie',
                icon: 'üëë',
                condition: () => gameState.totalEarned >= 1000000000000
            },
            first_prestige: {
                name: 'Transcendance',
                description: 'Faire votre premier prestige',
                icon: '‚≠ê',
                condition: () => gameState.stats.totalPrestige >= 1
            },
            prestige_10: {
                name: 'Ma√Ætre du Prestige',
                description: 'Faire 10 prestiges',
                icon: '‚≠ê',
                condition: () => gameState.stats.totalPrestige >= 10
            },
            golden_hunter: {
                name: 'Chasseur Dor√©',
                description: 'Cliquer 10 golden cookies',
                icon: 'üç™',
                condition: () => gameState.stats.totalGoldenClicks >= 10
            },
            golden_master: {
                name: 'Ma√Ætre Dor√©',
                description: 'Cliquer 100 golden cookies',
                icon: 'üç™',
                condition: () => gameState.stats.totalGoldenClicks >= 100
            },
            all_upgrades: {
                name: 'Collectionneur Supr√™me',
                description: 'Acheter tous les upgrades',
                icon: 'üíé',
                condition: () => Object.keys(gameState.upgrades).length >= Object.keys(upgradeDefinitions).length
            },
            veteran: {
                name: 'V√©t√©ran Cosmique',
                description: 'Jouer pendant 1 heure',
                icon: '‚è±Ô∏è',
                condition: () => gameState.stats.playTime >= 3600
            },
            dedication: {
                name: 'D√©vouement Total',
                description: 'Jouer pendant 10 heures',
                icon: '‚è±Ô∏è',
                condition: () => gameState.stats.playTime >= 36000
            }
        };

        // ==================== EVENTS ====================
        const events = [
            {
                name: 'Pluie d\'√âtoiles',
                icon: 'üå†',
                description: 'Production x3 pendant 30 secondes !',
                duration: 30,
                effect: () => 3
            },
            {
                name: 'Supernova',
                icon: 'üí•',
                description: 'Puissance de clic x10 pendant 20 secondes !',
                duration: 20,
                effect: () => {}
            },
            {
                name: 'Alignement Plan√©taire',
                icon: 'ü™ê',
                description: 'Production x5 pendant 15 secondes !',
                duration: 15,
                effect: () => 5
            },
            {
                name: 'Vague Cosmique',
                icon: 'üåä',
                description: 'Gagnez instantan√©ment 60 secondes de production !',
                duration: 0,
                effect: () => {}
            }
        ];

        // ==================== GAME LOGIC ====================
        let lastUpdate = Date.now();

        function formatNumber(num) {
            if (num < 1000) return Math.floor(num);
            if (num < 1000000) return (num/1000).toFixed(2) + 'K';
            if (num < 1000000000) return (num/1000000).toFixed(2) + 'M';
            if (num < 1000000000000) return (num/1000000000).toFixed(2) + 'B';
            if (num < 1000000000000000) return (num/1000000000000).toFixed(2) + 'T';
            return (num/1000000000000000).toFixed(2) + 'Q';
        }

        function handleClick() {
            const clickValue = getClickPower();
            gameState.energy += clickValue;
            gameState.totalEarned += clickValue;
            gameState.stats.totalClicks++;

            // Visual feedback
            createClickEffect(event.clientX, event.clientY, clickValue);

            updateUI();
            checkAchievements();
        }

        function createClickEffect(x, y, value) {
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.textContent = '+' + formatNumber(value);
            effect.style.left = x + 'px';
            effect.style.top = y + 'px';
            document.body.appendChild(effect);

            setTimeout(() => effect.remove(), 1000);
        }

        function getClickPower() {
            let power = gameState.clickPower;

            // Prestige bonus
            power *= getPrestigeMultiplier();

            // Event bonus
            if (gameState.activeEvent && gameState.activeEvent.name === 'Supernova') {
                power *= 10;
            }

            return power;
        }

        function getProductionMultiplier() {
            let multiplier = 1;

            // Upgrades
            if (gameState.upgrades.prod_1) multiplier *= upgradeDefinitions.prod_1.multiplier;
            if (gameState.upgrades.prod_2) multiplier *= upgradeDefinitions.prod_2.multiplier;
            if (gameState.upgrades.prod_3) multiplier *= upgradeDefinitions.prod_3.multiplier;

            // Prestige
            multiplier *= getPrestigeMultiplier();

            // Event
            if (gameState.activeEvent && gameState.activeEvent.effect() > 1) {
                multiplier *= gameState.activeEvent.effect();
            }

            return multiplier;
        }

        function getBuildingCost(buildingType) {
            const def = buildingDefinitions[buildingType];
            const count = gameState.buildings[buildingType] || 0;
            return Math.floor(def.baseCost * Math.pow(def.costMultiplier, count));
        }

        function buyBuilding(buildingType) {
            const cost = getBuildingCost(buildingType);

            if (gameState.energy >= cost) {
                gameState.energy -= cost;
                gameState.buildings[buildingType] = (gameState.buildings[buildingType] || 0) + 1;
                gameState.stats.buildingsBought++;
                updateProduction();
                updateUI();
                checkAchievements();
                saveGame();
            }
        }

        function buyUpgrade(upgradeId) {
            const upgrade = upgradeDefinitions[upgradeId];

            // Check requirements
            if (upgrade.requires && !upgrade.requires.every(req => gameState.upgrades[req])) {
                return;
            }

            if (gameState.upgrades[upgradeId]) return; // Already purchased

            if (gameState.energy >= upgrade.cost) {
                gameState.energy -= upgrade.cost;
                gameState.upgrades[upgradeId] = true;
                if (upgrade.effect) upgrade.effect();
                updateProduction();
                updateUI();
                checkAchievements();
                saveGame();
            }
        }

        function updateProduction() {
            let total = 0;
            const baseMultiplier = getProductionMultiplier();

            Object.entries(gameState.buildings).forEach(([type, count]) => {
                const def = buildingDefinitions[type];
                let production = def.baseProduction * count;

                // Building-specific upgrades
                Object.entries(gameState.upgrades).forEach(([upId, purchased]) => {
                    if (!purchased) return;
                    const upgrade = upgradeDefinitions[upId];
                    if (upgrade.buildingType === type && upgrade.multiplier) {
                        production *= upgrade.multiplier;
                    }
                });

                total += production;
            });

            gameState.energyPerSecond = total * baseMultiplier;
        }

        function getPrestigeMultiplier() {
            return 1 + (gameState.prestigePoints * 0.1); // +10% per prestige point
        }

        function getPrestigeGain() {
            // Gain prestige points based on total energy earned
            const points = Math.floor(Math.pow(gameState.totalEarned / 1000000, 0.5));
            return Math.max(0, points - gameState.prestigePoints);
        }

        function doPrestige() {
            const gain = getPrestigeGain();

            if (gain <= 0) {
                return;
            }

            if (!confirm(`Prestige et recommencer ?\nVous gagnerez ${gain} points de prestige.\nMultiplicateur: x${(getPrestigeMultiplier() + gain * 0.1).toFixed(2)}`)) {
                return;
            }

            gameState.prestigePoints += gain;
            gameState.prestigeLevel++;
            gameState.stats.totalPrestige++;

            // Reset
            gameState.energy = 0;
            gameState.totalEarned = 0;
            gameState.clickPower = 1;
            gameState.buildings = {};
            gameState.upgrades = {};

            updateProduction();
            updateUI();
            checkAchievements();
            saveGame();
        }

        // ==================== GOLDEN COOKIES ====================
        function spawnGoldenCookie() {
            const cookie = document.createElement('div');
            cookie.className = 'golden-cookie';
            cookie.textContent = 'üç™';
            cookie.style.left = Math.random() * (window.innerWidth - 100) + 'px';
            cookie.style.top = Math.random() * (window.innerHeight - 100) + 100 + 'px';

            cookie.onclick = () => {
                const bonus = gameState.energyPerSecond * 60 * 7; // 7 minutes of production
                const multiplier = gameState.upgrades.lucky_star ? 2 : 1;
                gameState.energy += bonus * multiplier;
                gameState.totalEarned += bonus * multiplier;
                gameState.stats.totalGoldenClicks++;
                gameState.goldenCookiesClicked++;

                createClickEffect(
                    parseInt(cookie.style.left),
                    parseInt(cookie.style.top),
                    bonus * multiplier
                );

                cookie.remove();
                checkAchievements();
                updateUI();
            };

            document.body.appendChild(cookie);

            // Remove after 13 seconds
            setTimeout(() => cookie.remove(), 13000);
        }

        // ==================== EVENTS ====================
        function triggerRandomEvent() {
            const event = events[Math.floor(Math.random() * events.length)];
            gameState.activeEvent = event;
            gameState.eventTimeLeft = event.duration;

            // Special instant effect for Vague Cosmique
            if (event.name === 'Vague Cosmique') {
                const bonus = gameState.energyPerSecond * 60;
                gameState.energy += bonus;
                gameState.totalEarned += bonus;
            }

            showEventBanner(event);
            updateUI();
        }

        function showEventBanner(event) {
            const banner = document.createElement('div');
            banner.className = 'event-banner';
            banner.innerHTML = `
                <div class="event-title">${event.icon} ${event.name} !</div>
                <div>${event.description}</div>
            `;
            document.body.appendChild(banner);

            setTimeout(() => banner.remove(), 5000);
        }

        // ==================== UI ====================
        function updateUI() {
            // Currency
            document.getElementById('currencyDisplay').textContent = formatNumber(gameState.energy);
            document.getElementById('perSecDisplay').textContent = '+' + formatNumber(gameState.energyPerSecond) + '/s';

            // Buildings
            updateBuildingsList();

            // Tab content
            updateTabContent();

            // Multipliers
            updateMultipliersList();

            // Events
            updateEventsList();
        }

        function updateBuildingsList() {
            const list = document.getElementById('buildingsList');
            let html = '';

            Object.entries(buildingDefinitions).forEach(([type, def]) => {
                const count = gameState.buildings[type] || 0;
                const cost = getBuildingCost(type);
                const canAfford = gameState.energy >= cost;

                const production = def.baseProduction * count * getProductionMultiplier();

                html += `
                    <div class="building-item">
                        <div class="building-header">
                            <div class="building-name">${def.icon} ${def.name}</div>
                            <div class="building-count">${count}</div>
                        </div>
                        <div class="building-info">
                            <div>${def.description}</div>
                            <div class="building-production">+${formatNumber(production)}/s</div>
                        </div>
                        <div class="building-info">
                            <div class="cost">Co√ªt: ${formatNumber(cost)}</div>
                            <div>Par unit√©: ${def.baseProduction}/s</div>
                        </div>
                        <button class="btn btn-buy" onclick="buyBuilding('${type}')" ${!canAfford ? 'disabled' : ''}>
                            Acheter
                        </button>
                    </div>
                `;
            });

            list.innerHTML = html;
        }

        function switchTab(tab) {
            gameState.currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updateTabContent();
        }

        function updateTabContent() {
            const content = document.getElementById('tabContent');

            switch(gameState.currentTab) {
                case 'upgrades':
                    content.innerHTML = renderUpgradesTab();
                    break;
                case 'prestige':
                    content.innerHTML = renderPrestigeTab();
                    break;
                case 'achievements':
                    content.innerHTML = renderAchievementsTab();
                    break;
                case 'stats':
                    content.innerHTML = renderStatsTab();
                    break;
            }
        }

        function renderUpgradesTab() {
            let html = '<div class="section-title">‚¨ÜÔ∏è Am√©liorations</div>';

            Object.entries(upgradeDefinitions).forEach(([id, upgrade]) => {
                const purchased = gameState.upgrades[id];
                const canAfford = gameState.energy >= upgrade.cost;
                const canBuy = !purchased && (!upgrade.requires || upgrade.requires.every(req => gameState.upgrades[req]));

                if (!canBuy && !purchased) return; // Hide if requirements not met

                html += `
                    <div class="upgrade-item ${purchased ? 'purchased' : ''}" onclick="${!purchased ? `buyUpgrade('${id}')` : ''}">
                        <div class="upgrade-name">${upgrade.icon} ${upgrade.name}</div>
                        <div class="upgrade-desc">${upgrade.description}</div>
                        ${!purchased ? `<div class="cost">Co√ªt: ${formatNumber(upgrade.cost)}</div>` : '<div style="color: #4ade80; font-weight: 700;">‚úÖ ACHET√â</div>'}
                    </div>
                `;
            });

            return html;
        }

        function renderPrestigeTab() {
            const gain = getPrestigeGain();
            const nextMultiplier = 1 + ((gameState.prestigePoints + gain) * 0.1);

            let html = `
                <div class="section-title">‚≠ê Syst√®me de Prestige</div>
                <div class="prestige-info">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">Points de Prestige</div>
                    <div class="prestige-currency">${gameState.prestigePoints} ‚≠ê</div>
                    <div class="prestige-multiplier">Multiplicateur actuel: x${getPrestigeMultiplier().toFixed(2)}</div>
                </div>

                <div style="margin: 20px 0; padding: 20px; background: rgba(0,0,0,0.5); border-radius: 10px;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">Prochain Prestige</div>
                    <div style="font-size: 1.5em; color: #fbbf24; margin-bottom: 10px;">+${gain} ‚≠ê</div>
                    <div style="color: rgba(255,255,255,0.7);">
                        Nouveau multiplicateur: x${nextMultiplier.toFixed(2)}<br>
                        ${gain > 0 ? 'Le prestige r√©initialisera vos b√¢timents et upgrades' : 'Obtenez plus d\'√©nergie pour d√©bloquer le prestige !'}
                    </div>
                </div>

                <button class="btn btn-prestige" onclick="doPrestige()" ${gain <= 0 ? 'disabled' : ''}>
                    ‚≠ê PRESTIGE ‚≠ê
                </button>

                <div style="margin-top: 20px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                    <div style="font-weight: 700; margin-bottom: 10px;">üí° Conseil</div>
                    <div style="color: rgba(255,255,255,0.7); line-height: 1.6;">
                        Le prestige vous donne des points qui multiplient TOUTE votre production et puissance de clic.
                        Plus vous attendez avant de prestige, plus vous gagnez de points !
                        <br><br>
                        Formule: ‚àö(√ânergie Totale / 1M) = Points de Prestige
                    </div>
                </div>
            `;

            return html;
        }

        function renderAchievementsTab() {
            let html = '<div class="section-title">üèÜ Succ√®s</div>';
            html += '<div class="achievement-grid">';

            Object.entries(achievementDefinitions).forEach(([id, achievement]) => {
                const unlocked = gameState.achievements[id];

                html += `
                    <div class="achievement ${unlocked ? 'unlocked' : ''}">
                        <div class="achievement-icon">${achievement.icon}</div>
                        <div class="achievement-name">${achievement.name}</div>
                        <div class="achievement-desc">${achievement.description}</div>
                    </div>
                `;
            });

            html += '</div>';

            const unlockedCount = Object.values(gameState.achievements).filter(a => a).length;
            const totalCount = Object.keys(achievementDefinitions).length;
            html += `<div style="margin-top: 20px; text-align: center; font-size: 1.3em; font-weight: 700;">
                ${unlockedCount}/${totalCount} d√©bloqu√©s (${Math.floor(unlockedCount/totalCount*100)}%)
            </div>`;

            return html;
        }

        function renderStatsTab() {
            let html = '<div class="section-title">üìä Statistiques</div>';
            html += '<div class="stats-grid">';

            html += `
                <div class="stat-card">
                    <div class="stat-label">Temps de Jeu</div>
                    <div class="stat-value">${Math.floor(gameState.stats.playTime / 3600)}h ${Math.floor((gameState.stats.playTime % 3600) / 60)}m</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Clics Totaux</div>
                    <div class="stat-value">${formatNumber(gameState.stats.totalClicks)}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">√ânergie Totale</div>
                    <div class="stat-value">${formatNumber(gameState.totalEarned)}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">√ânergie/sec</div>
                    <div class="stat-value">${formatNumber(gameState.energyPerSecond)}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Puissance Clic</div>
                    <div class="stat-value">${formatNumber(getClickPower())}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">B√¢timents Totaux</div>
                    <div class="stat-value">${Object.values(gameState.buildings).reduce((a,b) => a+b, 0)}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Prestiges</div>
                    <div class="stat-value">${gameState.stats.totalPrestige}</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Golden Cookies</div>
                    <div class="stat-value">${gameState.stats.totalGoldenClicks}</div>
                </div>
            `;

            html += '</div>';

            return html;
        }

        function updateMultipliersList() {
            const list = document.getElementById('multipliersList');
            let html = '';

            const prestigeMult = getPrestigeMultiplier();
            if (prestigeMult > 1) {
                html += `<div style="margin-bottom: 10px; padding: 10px; background: rgba(251,191,36,0.2); border-radius: 8px;">
                    ‚≠ê Prestige: x${prestigeMult.toFixed(2)}
                </div>`;
            }

            const prodMult = getProductionMultiplier() / prestigeMult;
            if (prodMult > 1) {
                html += `<div style="margin-bottom: 10px; padding: 10px; background: rgba(74,222,128,0.2); border-radius: 8px;">
                    üìà Upgrades: x${prodMult.toFixed(2)}
                </div>`;
            }

            if (gameState.activeEvent) {
                const eventMult = gameState.activeEvent.effect();
                if (eventMult > 1) {
                    html += `<div style="margin-bottom: 10px; padding: 10px; background: rgba(138,43,226,0.3); border-radius: 8px; border: 2px solid #8a2be2;">
                        ${gameState.activeEvent.icon} ${gameState.activeEvent.name}: x${eventMult}
                    </div>`;
                }
            }

            if (!html) {
                html = '<div style="color: rgba(255,255,255,0.5);">Aucun multiplicateur actif</div>';
            }

            list.innerHTML = html;
        }

        function updateEventsList() {
            const list = document.getElementById('eventsList');

            if (gameState.activeEvent && gameState.eventTimeLeft > 0) {
                list.innerHTML = `
                    <div style="padding: 15px; background: rgba(138,43,226,0.2); border-radius: 10px; border: 2px solid #8a2be2;">
                        <div style="font-size: 2em; margin-bottom: 10px;">${gameState.activeEvent.icon}</div>
                        <div style="font-weight: 700; margin-bottom: 5px;">${gameState.activeEvent.name}</div>
                        <div style="font-size: 0.9em; color: rgba(255,255,255,0.7); margin-bottom: 10px;">
                            ${gameState.activeEvent.description}
                        </div>
                        <div style="font-size: 1.2em; color: #fbbf24;">
                            ‚è±Ô∏è ${gameState.eventTimeLeft}s restantes
                        </div>
                    </div>
                `;
            } else {
                list.innerHTML = '<div style="color: rgba(255,255,255,0.5); text-align: center; padding: 20px;">Aucun √©v√©nement actif</div>';
            }
        }

        // ==================== ACHIEVEMENTS ====================
        function checkAchievements() {
            Object.entries(achievementDefinitions).forEach(([id, achievement]) => {
                if (!gameState.achievements[id] && achievement.condition()) {
                    gameState.achievements[id] = true;
                    showAchievementNotification(achievement);
                }
            });
        }

        function showAchievementNotification(achievement) {
            const notif = document.createElement('div');
            notif.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: linear-gradient(135deg, #fbbf24, #f59e0b);
                padding: 20px;
                border-radius: 15px;
                border: 3px solid #fff;
                box-shadow: 0 10px 50px rgba(251,191,36,0.8);
                z-index: 1000;
                animation: slideIn 0.5s ease;
                max-width: 300px;
            `;
            notif.innerHTML = `
                <div style="font-size: 3em; margin-bottom: 10px;">${achievement.icon}</div>
                <div style="font-weight: 900; font-size: 1.2em; margin-bottom: 5px; color: #000;">SUCC√àS D√âBLOQU√â !</div>
                <div style="font-weight: 700; margin-bottom: 5px; color: #000;">${achievement.name}</div>
                <div style="font-size: 0.9em; color: rgba(0,0,0,0.7);">${achievement.description}</div>
            `;
            document.body.appendChild(notif);

            setTimeout(() => notif.remove(), 5000);
        }

        // ==================== GAME LOOP ====================
        function gameLoop() {
            const now = Date.now();
            const dt = (now - lastUpdate) / 1000;
            lastUpdate = now;

            // Production
            gameState.energy += gameState.energyPerSecond * dt;
            gameState.totalEarned += gameState.energyPerSecond * dt;

            // Stats
            gameState.stats.playTime += dt;

            // Event countdown
            if (gameState.activeEvent && gameState.eventTimeLeft > 0) {
                gameState.eventTimeLeft -= dt;
                if (gameState.eventTimeLeft <= 0) {
                    gameState.activeEvent = null;
                    gameState.eventTimeLeft = 0;
                }
            }

            updateUI();
            checkAchievements();
        }

        // ==================== SAVE/LOAD ====================
        function saveGame() {
            localStorage.setItem('cosmicClicker', JSON.stringify(gameState));
        }

        function loadGame() {
            const save = localStorage.getItem('cosmicClicker');
            if (save) {
                try {
                    Object.assign(gameState, JSON.parse(save));
                    updateProduction();
                } catch (e) {
                    console.error('Failed to load:', e);
                }
            }
        }

        function resetGame() {
            if (confirm('R√©initialiser toute progression ?')) {
                localStorage.removeItem('cosmicClicker');
                location.reload();
            }
        }

        // ==================== INIT ====================
        // Create stars
        const starsContainer = document.getElementById('stars');
        for (let i = 0; i < 100; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 100 + '%';
            star.style.animationDelay = Math.random() * 3 + 's';
            starsContainer.appendChild(star);
        }

        loadGame();
        updateProduction();
        updateUI();
        lastUpdate = Date.now();

        // Game loop
        setInterval(gameLoop, 100); // 10 times per second

        // Auto-save
        setInterval(saveGame, 5000);

        // Golden cookies
        setInterval(() => {
            const chance = gameState.upgrades.golden_touch ? 0.15 : 0.08;
            if (Math.random() < chance) {
                spawnGoldenCookie();
            }
        }, 10000); // Check every 10 seconds

        // Random events
        setInterval(() => {
            if (!gameState.activeEvent && Math.random() < 0.2) {
                triggerRandomEvent();
            }
        }, 30000); // Check every 30 seconds

        console.log('%cüåå COSMIC CLICKER ULTIMATE loaded!', 'color: #8a2be2; font-size: 20px; font-weight: bold;');
        console.log('%cType resetGame() to reset', 'color: #ff1493;');
    </script>
</body>
</html>
