<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üç™ Cookie Clicker Pro</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            padding: 30px 20px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .title {
            font-size: 3em;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        .score-display {
            font-size: 2.5em;
            font-weight: 700;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .per-second {
            font-size: 1.2em;
            color: #4ade80;
            margin-top: 10px;
        }

        .per-click-display {
            font-size: 1em;
            color: #fbbf24;
            margin-top: 5px;
        }

        .main-container {
            display: grid;
            grid-template-columns: 350px 1fr 350px;
            gap: 20px;
            padding: 30px 20px;
            max-width: 1600px;
            margin: 0 auto;
        }

        .sidebar {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            max-height: calc(100vh - 250px);
            overflow-y: auto;
        }

        .section-title {
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .clicker-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .click-button {
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, #ffd700, #ff8c00);
            border: 8px solid #fff;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            cursor: pointer;
            font-size: 8em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s;
            user-select: none;
            position: relative;
        }

        .click-button:hover {
            transform: scale(1.05);
            box-shadow: 0 25px 70px rgba(255, 215, 0, 0.6);
        }

        .click-button:active {
            transform: scale(0.95);
        }

        .click-effect {
            position: fixed;
            font-size: 2.5em;
            font-weight: 900;
            color: #ffd700;
            text-shadow:
                0 0 10px rgba(255, 215, 0, 1),
                0 0 20px rgba(255, 215, 0, 0.8),
                2px 2px 4px rgba(0, 0, 0, 0.5);
            pointer-events: none;
            animation: floatUp 1.5s ease-out forwards;
            z-index: 9999;
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            50% {
                opacity: 1;
                transform: translateY(-50px) scale(1.3);
            }
            100% {
                opacity: 0;
                transform: translateY(-120px) scale(1.5);
            }
        }

        .upgrade-item, .generator-item {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upgrade-item:hover, .generator-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
            border-color: #ffd700;
        }

        .upgrade-item.locked, .generator-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .item-name {
            font-size: 1.1em;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .item-count {
            background: rgba(255, 215, 0, 0.3);
            padding: 4px 12px;
            border-radius: 15px;
            font-weight: 700;
        }

        .item-description {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 8px;
        }

        .item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .item-cost {
            font-size: 1.1em;
            font-weight: 700;
            color: #ffd700;
        }

        .item-production {
            font-size: 0.9em;
            color: #4ade80;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 20px;
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: 700;
            color: #ffd700;
        }

        .btn-reset {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #f87171, #ef4444);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: 700;
            font-size: 1em;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s;
        }

        .btn-reset:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(248, 113, 113, 0.4);
        }

        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .click-button {
                width: 250px;
                height: 250px;
                font-size: 6em;
            }
        }

        /* Scrollbar custom */
        .sidebar::-webkit-scrollbar {
            width: 8px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 215, 0, 0.5);
            border-radius: 10px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 215, 0, 0.8);
        }
    </style>
</head>
<body>
    <!-- Modal Shop Prestige -->
    <div id="prestigeShopModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; overflow-y: auto; padding: 20px;">
        <div style="max-width: 800px; margin: 50px auto; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; padding: 30px; border: 3px solid #ffd700;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <h2 style="color: #ffd700; font-size: 2em; margin: 0;">‚ú® Shop Prestige ‚ú®</h2>
                <button id="closePrestigeShop" style="background: #ef4444; color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: 700; font-size: 1.1em;">‚úï</button>
            </div>

            <div style="text-align: center; margin-bottom: 20px; padding: 15px; background: rgba(255, 215, 0, 0.2); border-radius: 10px;">
                <span style="color: #fbbf24; font-weight: 700; font-size: 1.2em;">Points de Prestige: </span>
                <span id="prestigePointsModal" style="color: #ffd700; font-weight: 900; font-size: 1.5em;">0</span>
            </div>

            <div id="prestigeUpgradesList"></div>
        </div>
    </div>

    <!-- Modal Shop Ascension -->
    <div id="ascensionShopModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10000; overflow-y: auto; padding: 20px;">
        <div style="max-width: 800px; margin: 50px auto; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); border-radius: 20px; padding: 30px; border: 3px solid #a78bfa;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <h2 style="color: #c4b5fd; font-size: 2em; margin: 0;">üåü Shop Ascension üåü</h2>
                <button id="closeAscensionShop" style="background: #ef4444; color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: 700; font-size: 1.1em;">‚úï</button>
            </div>

            <div style="text-align: center; margin-bottom: 20px; padding: 15px; background: rgba(167, 139, 250, 0.2); border-radius: 10px;">
                <span style="color: #c4b5fd; font-weight: 700; font-size: 1.2em;">Jetons d'Ascension: </span>
                <span id="ascensionTokensModal" style="color: #a78bfa; font-weight: 900; font-size: 1.5em;">0</span>
            </div>

            <div id="ascensionUpgradesList"></div>
        </div>
    </div>

    <div class="header">
        <div class="title">üç™ Cookie Clicker Pro</div>
        <div class="score-display" id="scoreDisplay">0</div>
        <div class="per-second" id="perSecond">+0/sec</div>
        <div class="per-click-display" id="perClickDisplay">Par clic: +1</div>

        <!-- Dragon section -->
        <div id="dragonSection" style="display: none; margin-top: 15px; padding: 10px; background: rgba(255, 100, 0, 0.2); border-radius: 10px; border: 2px solid rgba(255, 100, 0, 0.5);">
            <div style="display: flex; align-items: center; justify-content: center; gap: 15px; font-size: 0.9em;">
                <span id="dragonIcon" style="font-size: 2em;">ü•ö</span>
                <div style="text-align: left;">
                    <div id="dragonName" style="font-weight: 700; color: #fbbf24;">≈íuf Myst√©rieux</div>
                    <div id="dragonBonus" style="font-size: 0.85em; color: #4ade80;">Bonus: x1.0</div>
                </div>
                <button id="feedDragonBtn" style="padding: 8px 15px; background: linear-gradient(135deg, #ff6b35, #f7931e); border: none; border-radius: 8px; color: white; font-weight: 700; cursor: pointer;">
                    üç™ Nourrir (1%)
                </button>
            </div>
        </div>

        <!-- Minion section -->
        <div id="minionSection" style="display: none; margin-top: 10px; padding: 8px; background: rgba(100, 100, 255, 0.2); border-radius: 10px;">
            <button id="buyAutoClickerBtn" style="padding: 8px 15px; background: linear-gradient(135deg, #6366f1, #4f46e5); border: none; border-radius: 8px; color: white; font-weight: 700; cursor: pointer; font-size: 0.85em;">
                üë∑ Auto-Clicker (Level: <span id="autoClickerLevel">0</span>) - Cost: <span id="autoClickerCost">1M</span>
            </button>
        </div>
    </div>

    <div class="main-container">
        <!-- Left Sidebar: Upgrades -->
        <div class="sidebar">
            <div class="section-title">‚¨ÜÔ∏è Am√©liorations</div>
            <div id="upgradesList"></div>
        </div>

        <!-- Center: Clicker -->
        <div class="clicker-section">
            <div class="click-button" id="clickButton">
                üç™
            </div>

            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">Clics Totaux</div>
                    <div class="stat-value" id="totalClicks">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Par Clic</div>
                    <div class="stat-value" id="perClick">1</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Par Seconde</div>
                    <div class="stat-value" id="perSecStats">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">G√©n√©rateurs</div>
                    <div class="stat-value" id="totalGenerators">0</div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar: Auto-Clickers -->
        <div class="sidebar">
            <div class="section-title">ü§ñ G√©n√©rateurs Auto</div>
            <div id="generatorsList"></div>

            <!-- Prestige Section -->
            <div style="margin-top: 30px; padding: 20px; background: rgba(255, 215, 0, 0.1); border-radius: 15px; border: 2px solid rgba(255, 215, 0, 0.3);">
                <div style="font-size: 1.3em; font-weight: 700; margin-bottom: 15px; text-align: center; color: #ffd700;">
                    ‚ú® PRESTIGE ‚ú®
                </div>

                <div id="prestigeInfo" style="text-align: center; margin-bottom: 15px; font-size: 0.9em;">
                    <div style="margin-bottom: 8px;">
                        <span style="color: #fbbf24; font-weight: 700;">Points:</span>
                        <span id="prestigePointsDisplay" style="color: #ffd700; font-weight: 900; font-size: 1.2em;">0</span>
                    </div>
                    <div style="margin-bottom: 8px;">
                        <span style="color: #4ade80; font-weight: 700;">Multiplicateur:</span>
                        <span id="prestigeMultiDisplay" style="color: #4ade80; font-weight: 900; font-size: 1.2em;">x1.0</span>
                    </div>
                    <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.85em;">
                        Lifetime: <span id="lifetimeCookies">0</span>
                    </div>
                    <div id="nextPrestigeInfo" style="color: rgba(255, 215, 0, 0.8); font-size: 0.85em; margin-top: 5px;">
                        Prochain: 20.00M
                    </div>
                </div>

                <button id="prestigeButton" style="width: 100%; padding: 12px; background: linear-gradient(135deg, #fbbf24, #f59e0b); border: none; border-radius: 10px; color: white; font-weight: 700; font-size: 1em; cursor: pointer; transition: all 0.3s; margin-bottom: 10px;">
                    üåü PRESTIGE üåü
                </button>

                <button id="prestigeShopButton" style="width: 100%; padding: 10px; background: linear-gradient(135deg, #8b5cf6, #7c3aed); border: none; border-radius: 10px; color: white; font-weight: 700; font-size: 0.9em; cursor: pointer; transition: all 0.3s;">
                    üõí Shop Prestige
                </button>
            </div>

            <!-- Ascension Section -->
            <div id="ascensionSection" style="display: none; margin-top: 20px; padding: 20px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(124, 58, 237, 0.2)); border-radius: 15px; border: 2px solid rgba(139, 92, 246, 0.5);">
                <div style="font-size: 1.3em; font-weight: 700; margin-bottom: 15px; text-align: center; color: #a78bfa;">
                    üåü ASCENSION üåü
                </div>

                <div style="text-align: center; margin-bottom: 15px; font-size: 0.9em;">
                    <div style="margin-bottom: 8px;">
                        <span style="color: #c4b5fd; font-weight: 700;">Jetons:</span>
                        <span id="ascensionTokensDisplay" style="color: #a78bfa; font-weight: 900; font-size: 1.2em;">0</span>
                    </div>
                    <div style="margin-bottom: 8px;">
                        <span style="color: #4ade80; font-weight: 700;">Multiplicateur:</span>
                        <span id="ascensionMultiDisplay" style="color: #4ade80; font-weight: 900; font-size: 1.2em;">x1</span>
                    </div>
                    <div id="ascensionRequirement" style="color: rgba(255, 255, 255, 0.7); font-size: 0.85em; margin-top: 5px;">
                        Requis: 20 points prestige + 100B lifetime
                    </div>
                </div>

                <button id="ascensionButton" style="width: 100%; padding: 12px; background: linear-gradient(135deg, #8b5cf6, #7c3aed); border: none; border-radius: 10px; color: white; font-weight: 700; font-size: 1em; cursor: pointer; transition: all 0.3s; margin-bottom: 10px;">
                    üåü ASCENSION üåü
                </button>

                <button id="ascensionShopButton" style="width: 100%; padding: 10px; background: linear-gradient(135deg, #6366f1, #4f46e5); border: none; border-radius: 10px; color: white; font-weight: 700; font-size: 0.9em; cursor: pointer; transition: all 0.3s;">
                    üõí Shop Ascension
                </button>
            </div>

            <button class="btn-reset" id="resetButton">üîÑ Reset Progression</button>
        </div>
    </div>

    <script>
        // ==================== GAME STATE ====================
        const gameState = {
            cookies: 0,
            totalClicks: 0,
            clickPower: 1,
            cookiesPerSecond: 0,

            upgrades: {},
            generators: {},

            // Prestige system
            prestigePoints: 0,
            prestigeUpgrades: {},
            totalPrestiges: 0,
            totalPrestigePointsEarned: 0, // Total points gagn√©s (jamais diminue)

            // Ascension system
            ascensionTokens: 0,
            ascensionUpgrades: {},
            totalAscensions: 0,

            // Dragon system
            dragonLevel: 0, // 0=locked, 1=egg, 2-7=evolutions
            dragonFed: 0,

            // Minions system
            autoClickerLevel: 0,

            stats: {
                totalCookies: 0,
                totalClicks: 0
            }
        };

        // ==================== UPGRADES ====================
        const upgradeDefinitions = {
            click_2x: {
                name: 'Double Clic',
                icon: 'üëÜ',
                description: 'Double la puissance de clic',
                baseCost: 100,
                effect: () => gameState.clickPower *= 2,
                level: 0,
                maxLevel: 1
            },
            click_5x: {
                name: 'Super Clic',
                icon: '‚úã',
                description: 'x5 la puissance de clic',
                baseCost: 1000,
                effect: () => gameState.clickPower *= 5,
                level: 0,
                maxLevel: 1,
                requires: ['click_2x']
            },
            click_10x: {
                name: 'M√©ga Clic',
                icon: 'üëä',
                description: 'x10 la puissance de clic',
                baseCost: 10000,
                effect: () => gameState.clickPower *= 10,
                level: 0,
                maxLevel: 1,
                requires: ['click_5x']
            },
            click_100x: {
                name: 'Ultra Clic',
                icon: 'üí•',
                description: 'x50 la puissance de clic !',
                baseCost: 100000,
                effect: () => gameState.clickPower *= 50,
                level: 0,
                maxLevel: 1,
                requires: ['click_10x']
            },
            auto_boost: {
                name: 'Boost Auto',
                icon: '‚ö°',
                description: 'G√©n√©rateurs +50%',
                baseCost: 5000,
                effect: () => {},
                multiplier: 1.5,
                level: 0,
                maxLevel: 1
            },
            auto_boost_2: {
                name: 'Mega Boost',
                icon: '‚ö°',
                description: 'G√©n√©rateurs x2',
                baseCost: 50000,
                effect: () => {},
                multiplier: 2,
                level: 0,
                maxLevel: 1,
                requires: ['auto_boost']
            },
            multi_click: {
                name: 'Multi-Clic',
                icon: 'üñ±Ô∏è',
                description: 'Chaque clic compte double',
                baseCost: 2500,
                effect: () => {},
                clickMultiplier: 2,
                level: 0,
                maxLevel: 1
            },
            multi_click_2: {
                name: 'Super Multi-Clic',
                icon: 'üñ±Ô∏è',
                description: 'Chaque clic compte x3',
                baseCost: 25000,
                effect: () => {},
                clickMultiplier: 3,
                level: 0,
                maxLevel: 1,
                requires: ['multi_click']
            }
        };

        // ==================== ASCENSION UPGRADES ====================
        const ascensionUpgradeDefinitions = {
            prod_divine: {
                name: 'Production Divine',
                icon: '‚ö°',
                description: 'x3 production g√©n√©rateurs',
                cost: 1,
                multiplier: 3
            },
            prod_cosmic: {
                name: 'Production Cosmique',
                icon: '‚ö°',
                description: 'x5 production g√©n√©rateurs',
                cost: 3,
                multiplier: 5,
                requires: ['prod_divine']
            },
            click_divine: {
                name: 'Clic Divin',
                icon: 'üëÜ',
                description: 'x5 puissance de clic',
                cost: 2,
                clickMultiplier: 5
            },
            click_cosmic: {
                name: 'Clic Cosmique',
                icon: 'üëÜ',
                description: 'x10 puissance de clic',
                cost: 5,
                clickMultiplier: 10,
                requires: ['click_divine']
            },
            cheaper_divine: {
                name: 'G√©n√©rateurs Gratuits',
                icon: 'üí∞',
                description: '-25% co√ªt g√©n√©rateurs',
                cost: 4,
                costReduction: 0.75
            },
            prestige_boost: {
                name: 'Prestige Boost√©',
                icon: 'üåü',
                description: 'Points prestige x2 plus rapides (1pt/10M)',
                cost: 3,
                prestigeBoost: true
            },
            legendary_start: {
                name: 'D√©part L√©gendaire',
                icon: 'üöÄ',
                description: 'Commence avec 1M cookies apr√®s prestige',
                cost: 6,
                startingCookies: 1000000
            }
        };

        // ==================== PRESTIGE UPGRADES ====================
        const prestigeUpgradeDefinitions = {
            prod_boost_1: {
                name: 'Boost Production I',
                icon: '‚≠ê',
                description: '+50% production g√©n√©rateurs',
                cost: 1,
                multiplier: 1.5
            },
            prod_boost_2: {
                name: 'Boost Production II',
                icon: '‚≠ê',
                description: '+100% production g√©n√©rateurs',
                cost: 3,
                multiplier: 2,
                requires: ['prod_boost_1']
            },
            prod_boost_3: {
                name: 'Boost Production III',
                icon: '‚≠ê',
                description: '+200% production g√©n√©rateurs',
                cost: 7,
                multiplier: 3,
                requires: ['prod_boost_2']
            },
            click_boost_1: {
                name: 'Boost Clic I',
                icon: 'üëÜ',
                description: '+100% puissance de clic',
                cost: 2,
                clickMultiplier: 2
            },
            click_boost_2: {
                name: 'Boost Clic II',
                icon: 'üëÜ',
                description: '+300% puissance de clic',
                cost: 5,
                clickMultiplier: 4,
                requires: ['click_boost_1']
            },
            cheaper_gens: {
                name: 'G√©n√©rateurs moins chers',
                icon: 'üí∞',
                description: '-10% co√ªt g√©n√©rateurs',
                cost: 4,
                costReduction: 0.9
            },
            starting_boost: {
                name: 'D√©part boost√©',
                icon: 'üöÄ',
                description: 'Commence avec 1000 cookies',
                cost: 2,
                startingCookies: 1000
            },
            // Prestige++ upgrades (unlocked after 10 prestiges)
            cookie_titan: {
                name: 'Cookie Titan',
                icon: 'üíé',
                description: 'x5 production globale',
                cost: 15,
                multiplier: 5,
                unlockCondition: () => gameState.totalPrestiges >= 10
            },
            eternal_clicker: {
                name: 'Eternal Clicker',
                icon: 'üíé',
                description: 'x10 puissance de clic',
                cost: 20,
                clickMultiplier: 10,
                unlockCondition: () => gameState.totalPrestiges >= 10
            },
            cookie_god: {
                name: 'Cookie God',
                icon: 'üíé',
                description: 'x10 TOUT (production ET clics)',
                cost: 50,
                godMultiplier: 10,
                unlockCondition: () => gameState.totalPrestiges >= 10
            }
        };

        // ==================== GENERATORS ====================
        const generatorDefinitions = {
            cursor: {
                name: 'Curseur',
                icon: '‚òùÔ∏è',
                description: 'Clique automatiquement',
                baseCost: 15,
                baseProduction: 1,
                costMultiplier: 1.15,
                count: 0
            },
            grandma: {
                name: 'Grand-m√®re',
                icon: 'üëµ',
                description: 'Une gentille grand-m√®re qui fait des cookies',
                baseCost: 100,
                baseProduction: 3,
                costMultiplier: 1.15,
                count: 0
            },
            farm: {
                name: 'Ferme',
                icon: 'üåæ',
                description: 'Cultive des ingr√©dients',
                baseCost: 1100,
                baseProduction: 12,
                costMultiplier: 1.15,
                count: 0
            },
            factory: {
                name: 'Usine',
                icon: 'üè≠',
                description: 'Production de masse',
                baseCost: 12000,
                baseProduction: 47,
                costMultiplier: 1.15,
                count: 0
            },
            mine: {
                name: 'Mine',
                icon: '‚õèÔ∏è',
                description: 'Extrait du chocolat pur',
                baseCost: 130000,
                baseProduction: 260,
                costMultiplier: 1.15,
                count: 0
            },
            spaceship: {
                name: 'Vaisseau Spatial',
                icon: 'üöÄ',
                description: 'Cookies depuis l\'espace',
                baseCost: 1400000,
                baseProduction: 1400,
                costMultiplier: 1.15,
                count: 0
            },
            portal: {
                name: 'Portail Dimensionnel',
                icon: 'üåÄ',
                description: 'Importe des cookies d\'autres dimensions',
                baseCost: 20000000,
                baseProduction: 7800,
                costMultiplier: 1.15,
                count: 0
            },
            alchemist: {
                name: 'Alchimiste',
                icon: 'üíº',
                description: 'Transforme le plomb en cookies d\'or',
                baseCost: 100000000,
                baseProduction: 40000,
                costMultiplier: 1.15,
                count: 0,
                unlockCondition: () => gameState.stats.totalCookies >= 100000000
            },
            bank: {
                name: 'Banque',
                icon: 'üè¶',
                description: 'Les int√©r√™ts font des cookies',
                baseCost: 500000000,
                baseProduction: 200000,
                costMultiplier: 1.15,
                count: 0,
                unlockCondition: () => gameState.totalPrestiges >= 3
            },
            laboratory: {
                name: 'Laboratoire',
                icon: 'üî¨',
                description: 'Science des cookies quantiques',
                baseCost: 3000000000,
                baseProduction: 1000000,
                costMultiplier: 1.15,
                count: 0,
                unlockCondition: () => gameState.stats.totalCookies >= 500000000
            },
            timeMachine: {
                name: 'Machine Temporelle',
                icon: '‚è∞',
                description: 'Importe des cookies du futur',
                baseCost: 20000000000,
                baseProduction: 6000000,
                costMultiplier: 1.15,
                count: 0,
                unlockCondition: () => gameState.totalPrestiges >= 5
            },
            multiverse: {
                name: 'Portail Multiversel',
                icon: 'üåå',
                description: 'Cookies de dimensions parall√®les',
                baseCost: 150000000000,
                baseProduction: 35000000,
                costMultiplier: 1.15,
                count: 0,
                unlockCondition: () => gameState.stats.totalCookies >= 10000000000
            },
            alienShip: {
                name: 'Vaisseau Alien',
                icon: 'üëΩ',
                description: 'Technologie extraterrestre',
                baseCost: 1000000000000,
                baseProduction: 200000000,
                costMultiplier: 1.15,
                count: 0,
                unlockCondition: () => gameState.totalPrestiges >= 10
            },
            blackHole: {
                name: 'Trou Noir',
                icon: 'üåü',
                description: 'Absorbe l\'univers en cookies',
                baseCost: 10000000000000,
                baseProduction: 1200000000,
                costMultiplier: 1.15,
                count: 0,
                unlockCondition: () => gameState.totalPrestiges >= 10
            }
        };

        // ==================== ASCENSION FUNCTIONS ====================
        function getAscensionMultiplier() {
            // Chaque ascension donne x2 (100%)
            return Math.pow(2, gameState.totalAscensions);
        }

        function canAscend() {
            return gameState.prestigePoints >= 20 && gameState.stats.totalCookies >= 100000000000;
        }

        function calculateAscensionTokens() {
            return Math.floor(gameState.prestigePoints / 20);
        }

        function doAscension() {
            if (!canAscend()) {
                alert('Conditions pour Ascension:\n- Au moins 20 points de prestige\n- Au moins 100B cookies lifetime');
                return;
            }

            const tokensToGain = calculateAscensionTokens();

            if (confirm(`üåü ASCENSION üåü\n\nTu vas gagner ${tokensToGain} jeton${tokensToGain > 1 ? 's' : ''} d'Ascension!\nMultiplicateur: x${getAscensionMultiplier()} ‚Üí x${getAscensionMultiplier() * 2}\n\n‚ö†Ô∏è RESET TOTAL:\n- Cookies\n- G√©n√©rateurs\n- Upgrades\n- Points de Prestige\n- Prestiges effectu√©s\n\n‚úÖ TU GARDES:\n- Upgrades Ascension\n- Stats lifetime\n\nContinuer?`)) {
                gameState.ascensionTokens += tokensToGain;
                gameState.totalAscensions++;

                // RESET TOTAL
                gameState.cookies = 0;
                gameState.totalClicks = 0;
                gameState.clickPower = 1;
                gameState.cookiesPerSecond = 0;
                gameState.upgrades = {};
                gameState.generators = {};
                gameState.prestigePoints = 0;
                gameState.prestigeUpgrades = {};
                gameState.totalPrestiges = 0;
                gameState.totalPrestigePointsEarned = 0;

                // Stats lifetime reste

                updateProduction();
                updateUI();
                saveGame();

                alert(`‚ú® ASCENSION R√âUSSIE! ‚ú®\n\n+${tokensToGain} Jeton${tokensToGain > 1 ? 's' : ''}\nMultiplicateur: x${getAscensionMultiplier()}\n\nTu es maintenant transcendant!`);
            }
        }

        function buyAscensionUpgrade(id) {
            const upgrade = ascensionUpgradeDefinitions[id];

            if (gameState.ascensionUpgrades[id]) return;

            if (upgrade.requires) {
                const hasRequirements = upgrade.requires.every(req => gameState.ascensionUpgrades[req]);
                if (!hasRequirements) {
                    alert('Tu dois acheter les upgrades pr√©c√©dents!');
                    return;
                }
            }

            if (gameState.ascensionTokens >= upgrade.cost) {
                gameState.ascensionTokens -= upgrade.cost;
                gameState.ascensionUpgrades[id] = true;

                updateProduction();
                updateUI();
                saveGame();
            } else {
                alert('Pas assez de jetons d\'ascension!');
            }
        }

        // ==================== PRESTIGE FUNCTIONS ====================
        function calculatePrestigePoints() {
            // 1 point par 20M ou 10M si prestige boost
            const divider = gameState.ascensionUpgrades.prestige_boost ? 10000000 : 20000000;
            return Math.floor(gameState.stats.totalCookies / divider);
        }

        function getPrestigeMultiplier() {
            // Chaque prestige donne +50% (x0.5)
            return 1 + (gameState.totalPrestiges * 0.5);
        }

        function canPrestige() {
            // On peut prestige si on peut gagner de nouveaux points
            const pointsToGain = calculatePrestigePoints() - gameState.totalPrestigePointsEarned;
            return pointsToGain > 0;
        }

        function doPrestige() {
            const pointsToGain = calculatePrestigePoints() - gameState.totalPrestigePointsEarned;

            if (pointsToGain <= 0) {
                alert('Tu ne gagnerais pas de nouveaux points de prestige!\n\nIl te faut 20M cookies lifetime de plus pour gagner 1 point.');
                return;
            }

            if (confirm(`Faire un Prestige?\n\n+${pointsToGain} Point${pointsToGain > 1 ? 's' : ''} de Prestige\nMultiplicateur: x${getPrestigeMultiplier().toFixed(1)} ‚Üí x${(getPrestigeMultiplier() + 0.5).toFixed(1)}\n\nTu vas perdre tous tes cookies, g√©n√©rateurs et upgrades!`)) {
                // Ajouter les nouveaux points
                gameState.prestigePoints += pointsToGain;
                gameState.totalPrestigePointsEarned += pointsToGain;
                gameState.totalPrestiges++;

                // Reset tout sauf prestige
                gameState.cookies = 0;
                gameState.totalClicks = 0;
                gameState.clickPower = 1;
                gameState.cookiesPerSecond = 0;
                gameState.upgrades = {};
                gameState.generators = {};

                // Garde les stats
                // gameState.stats reste

                // Appliquer starting boost si achet√©
                if (gameState.prestigeUpgrades.starting_boost) {
                    gameState.cookies = prestigeUpgradeDefinitions.starting_boost.startingCookies;
                }

                // Appliquer legendary start si achet√©
                if (gameState.ascensionUpgrades.legendary_start) {
                    gameState.cookies = ascensionUpgradeDefinitions.legendary_start.startingCookies;
                }

                // Unlock dragon au 1er prestige
                if (gameState.totalPrestiges === 1 && gameState.dragonLevel === 0) {
                    gameState.dragonLevel = 1; // Egg
                    setTimeout(() => {
                        alert(`üêâ UN ≈íUF MYST√âRIEUX EST APPARU!\n\nNourris-le avec des cookies pour le faire √©clore!`);
                    }, 500);
                }

                updateProduction();
                updateUI();
                saveGame();

                alert(`Prestige effectu√©!\n\n+${pointsToGain} Point${pointsToGain > 1 ? 's' : ''} de Prestige\nTotal dispo: ${gameState.prestigePoints} points\nMultiplicateur: x${getPrestigeMultiplier().toFixed(1)}`);
            }
        }

        function buyPrestigeUpgrade(id) {
            const upgrade = prestigeUpgradeDefinitions[id];

            // Check if already bought
            if (gameState.prestigeUpgrades[id]) return;

            // Check requirements
            if (upgrade.requires) {
                const hasRequirements = upgrade.requires.every(req => gameState.prestigeUpgrades[req]);
                if (!hasRequirements) {
                    alert('Tu dois acheter les upgrades pr√©c√©dents!');
                    return;
                }
            }

            if (gameState.prestigePoints >= upgrade.cost) {
                gameState.prestigePoints -= upgrade.cost;
                gameState.prestigeUpgrades[id] = true;

                updateProduction();
                updateUI();
                saveGame();
            } else {
                alert('Pas assez de points de prestige!');
            }
        }

        // ==================== FUNCTIONS ====================
        function formatNumber(num) {
            if (num < 1000) return Math.floor(num);
            if (num < 1000000) return (num / 1000).toFixed(2) + 'K';
            if (num < 1000000000) return (num / 1000000).toFixed(2) + 'M';
            if (num < 1000000000000) return (num / 1000000000).toFixed(2) + 'B';
            return (num / 1000000000000).toFixed(2) + 'T';
        }

        function handleClick(event) {
            console.log('Click d√©tect√©!', event);

            let clicks = 1;
            let effectiveClickPower = gameState.clickPower;

            // Multi-click upgrades
            if (gameState.upgrades.multi_click) clicks *= upgradeDefinitions.multi_click.clickMultiplier;
            if (gameState.upgrades.multi_click_2) clicks *= upgradeDefinitions.multi_click_2.clickMultiplier;

            // Apply prestige click multipliers
            if (gameState.prestigeUpgrades.click_boost_1) {
                effectiveClickPower *= prestigeUpgradeDefinitions.click_boost_1.clickMultiplier;
            }
            if (gameState.prestigeUpgrades.click_boost_2) {
                effectiveClickPower *= prestigeUpgradeDefinitions.click_boost_2.clickMultiplier;
            }

            // Apply global prestige multiplier
            effectiveClickPower *= getPrestigeMultiplier();

            // Apply ascension click multipliers
            if (gameState.ascensionUpgrades.click_divine) {
                effectiveClickPower *= ascensionUpgradeDefinitions.click_divine.clickMultiplier;
            }
            if (gameState.ascensionUpgrades.click_cosmic) {
                effectiveClickPower *= ascensionUpgradeDefinitions.click_cosmic.clickMultiplier;
            }

            // Apply global ascension multiplier
            effectiveClickPower *= getAscensionMultiplier();

            // Apply prestige++ click upgrades
            if (gameState.prestigeUpgrades.eternal_clicker) {
                effectiveClickPower *= prestigeUpgradeDefinitions.eternal_clicker.clickMultiplier;
            }
            if (gameState.prestigeUpgrades.cookie_god) {
                effectiveClickPower *= prestigeUpgradeDefinitions.cookie_god.godMultiplier;
            }

            const cookiesGained = effectiveClickPower * clicks;
            gameState.cookies += cookiesGained;
            gameState.totalClicks += clicks;
            gameState.stats.totalClicks += clicks;
            gameState.stats.totalCookies += cookiesGained;

            console.log('Cookies gagn√©s:', cookiesGained, 'Total:', gameState.cookies);

            // Visual effect - seulement si event a les coordonn√©es
            if (event && event.clientX !== undefined && event.clientY !== undefined) {
                createClickEffect(event.clientX, event.clientY, cookiesGained);
            }

            updateUI();
        }

        function createClickEffect(x, y, value) {
            const effect = document.createElement('div');
            effect.className = 'click-effect';
            effect.textContent = '+' + formatNumber(value) + ' üç™';

            // Position avec un peu de variation al√©atoire
            const offsetX = (Math.random() - 0.5) * 40;
            const offsetY = (Math.random() - 0.5) * 40;

            effect.style.left = (x + offsetX) + 'px';
            effect.style.top = (y + offsetY) + 'px';

            document.body.appendChild(effect);

            setTimeout(() => effect.remove(), 1500);
        }

        function getGeneratorCost(type) {
            const def = generatorDefinitions[type];
            const count = gameState.generators[type] || 0;
            let cost = def.baseCost * Math.pow(def.costMultiplier, count);

            // Apply prestige cost reduction
            if (gameState.prestigeUpgrades.cheaper_gens) {
                cost *= prestigeUpgradeDefinitions.cheaper_gens.costReduction;
            }

            // Apply ascension cost reduction
            if (gameState.ascensionUpgrades.cheaper_divine) {
                cost *= ascensionUpgradeDefinitions.cheaper_divine.costReduction;
            }

            return Math.floor(cost);
        }

        function buyGenerator(type) {
            const cost = getGeneratorCost(type);

            if (gameState.cookies >= cost) {
                gameState.cookies -= cost;
                gameState.generators[type] = (gameState.generators[type] || 0) + 1;

                console.log('G√©n√©rateur achet√©:', type, 'Count:', gameState.generators[type]);

                updateProduction();
                console.log('Production par seconde:', gameState.cookiesPerSecond);

                updateUI();
                saveGame();
            }
        }

        function buyUpgrade(id) {
            const upgrade = upgradeDefinitions[id];

            // Check if already bought
            if (gameState.upgrades[id]) return;

            // Check requirements
            if (upgrade.requires) {
                const hasRequirements = upgrade.requires.every(req => gameState.upgrades[req]);
                if (!hasRequirements) return;
            }

            if (gameState.cookies >= upgrade.baseCost) {
                gameState.cookies -= upgrade.baseCost;
                gameState.upgrades[id] = true;

                if (upgrade.effect) upgrade.effect();

                updateProduction();
                updateUI();
                saveGame();
            }
        }

        function updateProduction() {
            let total = 0;

            console.log('=== CALCUL PRODUCTION ===');

            // Calculate base production from generators
            Object.entries(gameState.generators).forEach(([type, count]) => {
                const def = generatorDefinitions[type];
                const production = def.baseProduction * count;
                console.log(`${type}: ${count} x ${def.baseProduction} = ${production}`);
                total += production;
            });

            console.log('Total AVANT boosts:', total);

            // Apply upgrade multipliers
            if (gameState.upgrades.auto_boost) {
                total *= upgradeDefinitions.auto_boost.multiplier;
                console.log('Boost x1.5 appliqu√©');
            }
            if (gameState.upgrades.auto_boost_2) {
                total *= upgradeDefinitions.auto_boost_2.multiplier;
                console.log('Boost x2 appliqu√©');
            }

            // Apply prestige multiplier (global)
            const prestigeMulti = getPrestigeMultiplier();
            if (prestigeMulti > 1) {
                total *= prestigeMulti;
                console.log(`Prestige multiplier x${prestigeMulti.toFixed(1)} appliqu√©`);
            }

            // Apply prestige production upgrades
            if (gameState.prestigeUpgrades.prod_boost_1) {
                total *= prestigeUpgradeDefinitions.prod_boost_1.multiplier;
                console.log('Prestige Boost Prod I x1.5 appliqu√©');
            }
            if (gameState.prestigeUpgrades.prod_boost_2) {
                total *= prestigeUpgradeDefinitions.prod_boost_2.multiplier;
                console.log('Prestige Boost Prod II x2 appliqu√©');
            }
            if (gameState.prestigeUpgrades.prod_boost_3) {
                total *= prestigeUpgradeDefinitions.prod_boost_3.multiplier;
                console.log('Prestige Boost Prod III x3 appliqu√©');
            }

            // Apply ascension multiplier (global)
            const ascensionMulti = getAscensionMultiplier();
            if (ascensionMulti > 1) {
                total *= ascensionMulti;
                console.log(`Ascension multiplier x${ascensionMulti} appliqu√©`);
            }

            // Apply ascension production upgrades
            if (gameState.ascensionUpgrades.prod_divine) {
                total *= ascensionUpgradeDefinitions.prod_divine.multiplier;
                console.log('Ascension Prod Divine x3 appliqu√©');
            }
            if (gameState.ascensionUpgrades.prod_cosmic) {
                total *= ascensionUpgradeDefinitions.prod_cosmic.multiplier;
                console.log('Ascension Prod Cosmic x5 appliqu√©');
            }

            // Apply prestige++ upgrades
            if (gameState.prestigeUpgrades.cookie_titan) {
                total *= prestigeUpgradeDefinitions.cookie_titan.multiplier;
                console.log('Cookie Titan x5 appliqu√©');
            }
            if (gameState.prestigeUpgrades.cookie_god) {
                total *= prestigeUpgradeDefinitions.cookie_god.godMultiplier;
                console.log('Cookie God x10 appliqu√©');
            }

            // Apply dragon bonus
            const dragonBonus = getDragonBonus();
            if (dragonBonus > 1) {
                total *= dragonBonus;
                console.log(`Dragon bonus x${dragonBonus.toFixed(2)} appliqu√©`);
            }

            gameState.cookiesPerSecond = total;
            console.log('Production FINALE par seconde:', total);
            console.log('=========================');
        }

        function updateUI() {
            // Update header
            const scoreEl = document.getElementById('scoreDisplay');
            if (scoreEl) {
                scoreEl.textContent = formatNumber(gameState.cookies);
            }

            const perSecondEl = document.getElementById('perSecond');
            if (perSecondEl) {
                perSecondEl.textContent = '+' + formatNumber(gameState.cookiesPerSecond) + '/sec';
            }

            // Calculate effective click power (same calculation as in handleClick)
            let clicks = 1;
            let effectiveClickPower = gameState.clickPower;

            // Multi-click upgrades
            if (gameState.upgrades.multi_click) clicks *= upgradeDefinitions.multi_click.clickMultiplier;
            if (gameState.upgrades.multi_click_2) clicks *= upgradeDefinitions.multi_click_2.clickMultiplier;

            // Apply prestige click multipliers
            if (gameState.prestigeUpgrades.click_boost_1) {
                effectiveClickPower *= prestigeUpgradeDefinitions.click_boost_1.clickMultiplier;
            }
            if (gameState.prestigeUpgrades.click_boost_2) {
                effectiveClickPower *= prestigeUpgradeDefinitions.click_boost_2.clickMultiplier;
            }

            // Apply global prestige multiplier
            effectiveClickPower *= getPrestigeMultiplier();

            const totalClickPower = effectiveClickPower * clicks;

            const perClickDisplayEl = document.getElementById('perClickDisplay');
            if (perClickDisplayEl) {
                perClickDisplayEl.textContent = 'Par clic: +' + formatNumber(totalClickPower) + ' üç™';
            }

            // Update stats
            const totalClicksEl = document.getElementById('totalClicks');
            if (totalClicksEl) {
                totalClicksEl.textContent = formatNumber(gameState.stats.totalClicks);
            }

            const perClickEl = document.getElementById('perClick');
            if (perClickEl) {
                perClickEl.textContent = formatNumber(gameState.clickPower);
            }

            const perSecStatsEl = document.getElementById('perSecStats');
            if (perSecStatsEl) {
                perSecStatsEl.textContent = formatNumber(gameState.cookiesPerSecond);
            }

            const totalGens = Object.values(gameState.generators).reduce((a, b) => a + b, 0);
            const totalGensEl = document.getElementById('totalGenerators');
            if (totalGensEl) {
                totalGensEl.textContent = totalGens;
            }

            // Update upgrades list
            renderUpgrades();

            // Update generators list
            renderGenerators();

            // Update prestige info
            const prestigePointsEl = document.getElementById('prestigePointsDisplay');
            if (prestigePointsEl) {
                prestigePointsEl.textContent = gameState.prestigePoints;
            }

            const prestigeMultiEl = document.getElementById('prestigeMultiDisplay');
            if (prestigeMultiEl) {
                prestigeMultiEl.textContent = 'x' + getPrestigeMultiplier().toFixed(1);
            }

            const lifetimeCookiesEl = document.getElementById('lifetimeCookies');
            if (lifetimeCookiesEl) {
                lifetimeCookiesEl.textContent = formatNumber(gameState.stats.totalCookies);
            }

            const nextPrestigeEl = document.getElementById('nextPrestigeInfo');
            if (nextPrestigeEl) {
                if (canPrestige()) {
                    const newPoints = calculatePrestigePoints() - gameState.totalPrestigePointsEarned;
                    nextPrestigeEl.textContent = `‚ú® +${newPoints} point${newPoints > 1 ? 's' : ''} disponible${newPoints > 1 ? 's' : ''}!`;
                    nextPrestigeEl.style.color = '#4ade80';
                } else {
                    const nextMilestone = (gameState.totalPrestigePointsEarned + 1) * 20000000;
                    const remaining = nextMilestone - gameState.stats.totalCookies;
                    nextPrestigeEl.textContent = `Prochain: ${formatNumber(remaining)} restants`;
                    nextPrestigeEl.style.color = 'rgba(255, 215, 0, 0.8)';
                }
            }

            const prestigeButtonEl = document.getElementById('prestigeButton');
            if (prestigeButtonEl) {
                if (canPrestige()) {
                    prestigeButtonEl.style.opacity = '1';
                    prestigeButtonEl.style.cursor = 'pointer';
                } else {
                    prestigeButtonEl.style.opacity = '0.5';
                    prestigeButtonEl.style.cursor = 'not-allowed';
                }
            }

            // Update ascension info
            const ascensionSection = document.getElementById('ascensionSection');
            if (ascensionSection) {
                // Show/hide ascension section
                if (canAscend() || gameState.totalAscensions > 0) {
                    ascensionSection.style.display = 'block';
                } else {
                    ascensionSection.style.display = 'none';
                }

                const ascensionTokensEl = document.getElementById('ascensionTokensDisplay');
                if (ascensionTokensEl) {
                    ascensionTokensEl.textContent = gameState.ascensionTokens;
                }

                const ascensionMultiEl = document.getElementById('ascensionMultiDisplay');
                if (ascensionMultiEl) {
                    ascensionMultiEl.textContent = 'x' + getAscensionMultiplier();
                }

                const ascensionButtonEl = document.getElementById('ascensionButton');
                if (ascensionButtonEl) {
                    if (canAscend()) {
                        ascensionButtonEl.style.opacity = '1';
                        ascensionButtonEl.style.cursor = 'pointer';
                    } else {
                        ascensionButtonEl.style.opacity = '0.5';
                        ascensionButtonEl.style.cursor = 'not-allowed';
                    }
                }
            }

            // Update dragon & minions UI
            updateDragonUI();
            updateMinionUI();
        }

        function renderUpgrades() {
            const container = document.getElementById('upgradesList');
            let html = '';

            Object.entries(upgradeDefinitions).forEach(([id, upgrade]) => {
                // Check unlock condition for prestige++ upgrades
                if (upgrade.unlockCondition && !upgrade.unlockCondition()) {
                    return; // Skip locked upgrades
                }

                const owned = gameState.upgrades[id];
                const canAfford = gameState.cookies >= upgrade.baseCost;
                const hasRequirements = !upgrade.requires || upgrade.requires.every(req => gameState.upgrades[req]);

                if (owned || hasRequirements) {
                    html += `
                        <div class="upgrade-item ${owned ? 'locked' : (!canAfford ? 'locked' : '')}"
                             data-upgrade-id="${id}" ${!owned ? 'data-can-buy="true"' : ''}>
                            <div class="item-header">
                                <div class="item-name">${upgrade.icon} ${upgrade.name}</div>
                            </div>
                            <div class="item-description">${upgrade.description}</div>
                            <div class="item-footer">
                                ${owned ?
                                    '<span style="color: #4ade80; font-weight: 700;">‚úÖ ACHET√â</span>' :
                                    `<span class="item-cost">üç™ ${formatNumber(upgrade.baseCost)}</span>`
                                }
                            </div>
                        </div>
                    `;
                }
            });

            container.innerHTML = html || '<div style="text-align: center; opacity: 0.5;">Aucune am√©lioration disponible</div>';

            // Add click listeners to upgrades
            container.querySelectorAll('.upgrade-item[data-can-buy="true"]').forEach(item => {
                item.addEventListener('click', () => {
                    buyUpgrade(item.dataset.upgradeId);
                });
            });
        }

        function renderGenerators() {
            const container = document.getElementById('generatorsList');
            let html = '';

            Object.entries(generatorDefinitions).forEach(([type, def]) => {
                // Check unlock condition
                if (def.unlockCondition && !def.unlockCondition()) {
                    return; // Skip locked generators
                }

                const count = gameState.generators[type] || 0;
                const cost = getGeneratorCost(type);
                const canAfford = gameState.cookies >= cost;

                // Production par unit√© et production totale
                let productionPerUnit = def.baseProduction;

                // Appliquer les boosts aux g√©n√©rateurs
                if (gameState.upgrades.auto_boost) {
                    productionPerUnit *= upgradeDefinitions.auto_boost.multiplier;
                }
                if (gameState.upgrades.auto_boost_2) {
                    productionPerUnit *= upgradeDefinitions.auto_boost_2.multiplier;
                }

                const totalProduction = productionPerUnit * count;

                html += `
                    <div class="generator-item ${!canAfford ? 'locked' : ''}" data-generator-type="${type}">
                        <div class="item-header">
                            <div class="item-name">${def.icon} ${def.name}</div>
                            <div class="item-count">${count}</div>
                        </div>
                        <div class="item-description">${def.description}</div>
                        <div class="item-footer">
                            <span class="item-cost">üç™ ${formatNumber(cost)}</span>
                            <span class="item-production" style="display: flex; flex-direction: column; align-items: flex-end; gap: 2px;">
                                <span style="color: #4ade80;">Chaque: +${formatNumber(productionPerUnit)}/s</span>
                                ${count > 0 ? `<span style="color: #fbbf24; font-size: 0.85em;">Total: +${formatNumber(totalProduction)}/s</span>` : ''}
                            </span>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;

            // Add click listeners to generators
            container.querySelectorAll('.generator-item').forEach(item => {
                item.addEventListener('click', () => {
                    buyGenerator(item.dataset.generatorType);
                });
            });
        }

        // ==================== DRAGON & MINIONS ====================
        function getDragonBonus() {
            const bonuses = [1, 1, 1.1, 1.25, 1.5, 2, 2.5, 3];
            return bonuses[gameState.dragonLevel] || 1;
        }

        function feedDragon() {
            const cost = Math.floor(gameState.cookies * 0.01); // 1% of current cookies
            if (cost > 0 && gameState.cookies >= cost) {
                gameState.cookies -= cost;
                gameState.dragonFed += cost;

                // Check for level up
                const thresholds = [0, 0, 10000000, 50000000, 200000000, 1000000000, 5000000000, 20000000000];
                for (let i = thresholds.length - 1; i >= 0; i--) {
                    if (gameState.dragonFed >= thresholds[i]) {
                        if (gameState.dragonLevel < i) {
                            gameState.dragonLevel = i;
                            const names = ['', '≈íuf', 'B√©b√© Dragon', 'Jeune Dragon', 'Dragon Ado', 'Dragon Adulte', 'Dragon Ancien', 'Dragon L√©gendaire'];
                            alert(`üêâ Ton dragon a √©volu√©!\n\n${names[i]}\nBonus: x${getDragonBonus().toFixed(2)}`);
                        }
                        break;
                    }
                }

                updateProduction();
                updateUI();
                saveGame();
            }
        }

        function getAutoClickerCost() {
            return Math.floor(1000000 * Math.pow(2, gameState.autoClickerLevel));
        }

        function buyAutoClicker() {
            const cost = getAutoClickerCost();
            if (gameState.cookies >= cost) {
                gameState.cookies -= cost;
                gameState.autoClickerLevel++;
                updateUI();
                saveGame();
            }
        }

        function updateDragonUI() {
            const dragonSection = document.getElementById('dragonSection');
            if (!dragonSection) return;

            if (gameState.dragonLevel > 0) {
                dragonSection.style.display = 'block';

                const icons = ['', 'ü•ö', 'üê£', 'üêâ', 'üê≤', 'üî•', '‚ö°', 'üåü'];
                const names = ['', '≈íuf Myst√©rieux', 'B√©b√© Dragon', 'Jeune Dragon', 'Dragon Ado', 'Dragon Adulte', 'Dragon Ancien', 'Dragon L√©gendaire'];

                const iconEl = document.getElementById('dragonIcon');
                const nameEl = document.getElementById('dragonName');
                const bonusEl = document.getElementById('dragonBonus');

                if (iconEl) iconEl.textContent = icons[gameState.dragonLevel] || 'ü•ö';
                if (nameEl) nameEl.textContent = names[gameState.dragonLevel] || 'Dragon';
                if (bonusEl) bonusEl.textContent = `Bonus: x${getDragonBonus().toFixed(2)}`;
            } else {
                dragonSection.style.display = 'none';
            }
        }

        function updateMinionUI() {
            const minionSection = document.getElementById('minionSection');
            if (!minionSection) return;

            // Unlock minions after 3 prestiges
            if (gameState.totalPrestiges >= 3) {
                minionSection.style.display = 'block';

                const levelEl = document.getElementById('autoClickerLevel');
                const costEl = document.getElementById('autoClickerCost');

                if (levelEl) levelEl.textContent = gameState.autoClickerLevel;
                if (costEl) costEl.textContent = formatNumber(getAutoClickerCost());
            } else {
                minionSection.style.display = 'none';
            }
        }

        let gameLoopCounter = 0;
        function gameLoop() {
            // Auto-clicker
            if (gameState.autoClickerLevel > 0) {
                const clicks = gameState.autoClickerLevel * 0.1; // 0.1 click per second per level
                if (Math.random() < clicks / 10) { // Probabilistic clicking
                    handleClick({clientX: 0, clientY: 0}); // Silent click
                }
            }

            if (gameState.cookiesPerSecond > 0) {
                const oldCookies = gameState.cookies;
                gameState.cookies += gameState.cookiesPerSecond / 10; // Update 10 times per second
                gameState.stats.totalCookies += gameState.cookiesPerSecond / 10;

                // Log tous les 10 ticks (1 seconde)
                gameLoopCounter++;
                if (gameLoopCounter % 10 === 0) {
                    console.log(`[GameLoop] Cookies: ${oldCookies.toFixed(2)} -> ${gameState.cookies.toFixed(2)} (+${(gameState.cookies - oldCookies).toFixed(2)}) | Production: ${gameState.cookiesPerSecond}/sec | Lifetime: ${gameState.stats.totalCookies.toFixed(2)}`);
                }

                // Update display
                const scoreEl = document.getElementById('scoreDisplay');
                if (scoreEl) {
                    scoreEl.textContent = formatNumber(gameState.cookies);
                }

                const perSecondEl = document.getElementById('perSecond');
                if (perSecondEl) {
                    perSecondEl.textContent = '+' + formatNumber(gameState.cookiesPerSecond) + '/sec';
                }

                // Update lifetime cookies display
                const lifetimeCookiesEl = document.getElementById('lifetimeCookies');
                if (lifetimeCookiesEl) {
                    lifetimeCookiesEl.textContent = formatNumber(gameState.stats.totalCookies);
                }

                // Update prestige info
                const nextPrestigeEl = document.getElementById('nextPrestigeInfo');
                if (nextPrestigeEl) {
                    if (canPrestige()) {
                        const newPoints = calculatePrestigePoints() - gameState.totalPrestigePointsEarned;
                        nextPrestigeEl.textContent = `‚ú® +${newPoints} point${newPoints > 1 ? 's' : ''} disponible${newPoints > 1 ? 's' : ''}!`;
                        nextPrestigeEl.style.color = '#4ade80';
                    } else {
                        const nextMilestone = (gameState.totalPrestigePointsEarned + 1) * 20000000;
                        const remaining = nextMilestone - gameState.stats.totalCookies;
                        nextPrestigeEl.textContent = `Prochain: ${formatNumber(remaining)} restants`;
                        nextPrestigeEl.style.color = 'rgba(255, 215, 0, 0.8)';
                    }
                }

                // Update prestige button state
                const prestigeButtonEl = document.getElementById('prestigeButton');
                if (prestigeButtonEl) {
                    if (canPrestige()) {
                        prestigeButtonEl.style.opacity = '1';
                        prestigeButtonEl.style.cursor = 'pointer';
                    } else {
                        prestigeButtonEl.style.opacity = '0.5';
                        prestigeButtonEl.style.cursor = 'not-allowed';
                    }
                }
            }
        }

        function saveGame() {
            localStorage.setItem('cookieClickerSave', JSON.stringify(gameState));
        }

        function loadGame() {
            const save = localStorage.getItem('cookieClickerSave');
            if (save) {
                try {
                    Object.assign(gameState, JSON.parse(save));
                    updateProduction();
                } catch (e) {
                    console.error('Failed to load save:', e);
                }
            }
        }

        function resetGame() {
            if (confirm('√ätes-vous s√ªr de vouloir reset ? Toute progression sera perdue !')) {
                localStorage.removeItem('cookieClickerSave');
                location.reload();
            }
        }

        // ==================== PRESTIGE UI ====================
        function openPrestigeShop() {
            document.getElementById('prestigeShopModal').style.display = 'block';
            renderPrestigeUpgrades();
        }

        function closePrestigeShop() {
            document.getElementById('prestigeShopModal').style.display = 'none';
        }

        function renderPrestigeUpgrades() {
            const container = document.getElementById('prestigeUpgradesList');
            const modalPoints = document.getElementById('prestigePointsModal');

            if (modalPoints) {
                modalPoints.textContent = gameState.prestigePoints;
            }

            let html = '';

            Object.entries(prestigeUpgradeDefinitions).forEach(([id, upgrade]) => {
                // Check unlock for prestige++
                if (upgrade.unlockCondition && !upgrade.unlockCondition()) {
                    return;
                }

                const owned = gameState.prestigeUpgrades[id];
                const canAfford = gameState.prestigePoints >= upgrade.cost;
                const hasRequirements = !upgrade.requires || upgrade.requires.every(req => gameState.prestigeUpgrades[req]);

                if (owned || hasRequirements) {
                    html += `
                        <div class="upgrade-item ${owned ? 'locked' : (!canAfford ? 'locked' : '')}"
                             data-prestige-upgrade-id="${id}" ${!owned ? 'data-can-buy-prestige="true"' : ''} style="margin-bottom: 15px;">
                            <div class="item-header">
                                <div class="item-name">${upgrade.icon} ${upgrade.name}</div>
                            </div>
                            <div class="item-description">${upgrade.description}</div>
                            <div class="item-footer">
                                ${owned ?
                                    '<span style="color: #4ade80; font-weight: 700;">‚úÖ ACHET√â</span>' :
                                    `<span class="item-cost" style="color: #ffd700;">‚≠ê ${upgrade.cost} Points</span>`
                                }
                            </div>
                        </div>
                    `;
                }
            });

            container.innerHTML = html || '<div style="text-align: center; opacity: 0.5; padding: 20px;">Aucune am√©lioration disponible</div>';

            // Add click listeners
            container.querySelectorAll('.upgrade-item[data-can-buy-prestige="true"]').forEach(item => {
                item.addEventListener('click', () => {
                    buyPrestigeUpgrade(item.dataset.prestigeUpgradeId);
                    renderPrestigeUpgrades();
                });
            });
        }

        // ==================== ASCENSION UI ====================
        function openAscensionShop() {
            document.getElementById('ascensionShopModal').style.display = 'block';
            renderAscensionUpgrades();
        }

        function closeAscensionShop() {
            document.getElementById('ascensionShopModal').style.display = 'none';
        }

        function renderAscensionUpgrades() {
            const container = document.getElementById('ascensionUpgradesList');
            const modalTokens = document.getElementById('ascensionTokensModal');

            if (modalTokens) {
                modalTokens.textContent = gameState.ascensionTokens;
            }

            let html = '';

            Object.entries(ascensionUpgradeDefinitions).forEach(([id, upgrade]) => {
                const owned = gameState.ascensionUpgrades[id];
                const canAfford = gameState.ascensionTokens >= upgrade.cost;
                const hasRequirements = !upgrade.requires || upgrade.requires.every(req => gameState.ascensionUpgrades[req]);

                if (owned || hasRequirements) {
                    html += `
                        <div class="upgrade-item ${owned ? 'locked' : (!canAfford ? 'locked' : '')}"
                             data-ascension-upgrade-id="${id}" ${!owned ? 'data-can-buy-ascension="true"' : ''} style="margin-bottom: 15px;">
                            <div class="item-header">
                                <div class="item-name">${upgrade.icon} ${upgrade.name}</div>
                            </div>
                            <div class="item-description">${upgrade.description}</div>
                            <div class="item-footer">
                                ${owned ?
                                    '<span style="color: #4ade80; font-weight: 700;">‚úÖ ACHET√â</span>' :
                                    `<span class="item-cost" style="color: #a78bfa;">üåü ${upgrade.cost} Jetons</span>`
                                }
                            </div>
                        </div>
                    `;
                }
            });

            container.innerHTML = html || '<div style="text-align: center; opacity: 0.5; padding: 20px;">Aucune am√©lioration disponible</div>';

            // Add click listeners
            container.querySelectorAll('.upgrade-item[data-can-buy-ascension="true"]').forEach(item => {
                item.addEventListener('click', () => {
                    buyAscensionUpgrade(item.dataset.ascensionUpgradeId);
                    renderAscensionUpgrades();
                });
            });
        }

        // ==================== INIT ====================
        // Add event listeners
        document.getElementById('clickButton').addEventListener('click', handleClick);
        document.getElementById('resetButton').addEventListener('click', resetGame);
        document.getElementById('prestigeButton').addEventListener('click', doPrestige);
        document.getElementById('prestigeShopButton').addEventListener('click', openPrestigeShop);
        document.getElementById('closePrestigeShop').addEventListener('click', closePrestigeShop);
        document.getElementById('ascensionButton').addEventListener('click', doAscension);
        document.getElementById('ascensionShopButton').addEventListener('click', openAscensionShop);
        document.getElementById('closeAscensionShop').addEventListener('click', closeAscensionShop);
        document.getElementById('feedDragonBtn').addEventListener('click', feedDragon);
        document.getElementById('buyAutoClickerBtn').addEventListener('click', buyAutoClicker);

        loadGame();
        updateProduction();
        updateUI();

        console.log('%cüç™ Cookie Clicker Pro loaded!', 'color: #ffd700; font-size: 20px; font-weight: bold;');
        console.log('%c VERSION 1.1 - Grand-m√®re=3/sec, Ferme=12/sec', 'color: #4ade80; font-weight: bold;');
        console.log('D√©finitions g√©n√©rateurs:');
        console.log('- Curseur:', generatorDefinitions.cursor.baseProduction, '/sec');
        console.log('- Grand-m√®re:', generatorDefinitions.grandma.baseProduction, '/sec');
        console.log('- Ferme:', generatorDefinitions.farm.baseProduction, '/sec');
        console.log('√âtat initial:');
        console.log('- Cookies:', gameState.cookies);
        console.log('- G√©n√©rateurs:', gameState.generators);
        console.log('- Production/sec:', gameState.cookiesPerSecond);

        // Game loop - 10 times per second for smooth production
        setInterval(gameLoop, 100);

        // Auto-save every 5 seconds
        setInterval(saveGame, 5000);
    </script>
</body>
</html>
